<Window Name="Window"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:c="clr-namespace:FetchalonConverters;assembly=FetchalonConverterAssembly"
        xmlns:componentmodel="clr-namespace:System.ComponentModel;assembly=WindowsBase"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        MinHeight="955"
        MinWidth="1442"
        Title="{Binding ElementName=FrameTool, Path=Content.Title, BindsDirectlyToSource=True, IsAsync=True, NotifyOnSourceUpdated=True}">
    <WindowChrome.WindowChrome>
        <WindowChrome GlassFrameThickness="-1"
                      ResizeBorderThickness="4"
                      CaptionHeight="40" />
    </WindowChrome.WindowChrome>
    <Window.Template>
        <ControlTemplate>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="35" />
                    <RowDefinition Height="1*" />
                </Grid.RowDefinitions>
                <Border Background="Wheat"
                        Opacity="0.7">
                    <!-- Opacity of < 1.0 helps show the minimize, maximize and close buttons -->
                    <Grid>
                        <!-- Window Title - Center Aligned -->
                        <TextBlock FontSize="18"
                                   FontWeight="Bold"
                                   Margin="0,5,0,0"
                                   Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Title, BindsDirectlyToSource=True, IsAsync=True, NotifyOnSourceUpdated=True}"
                                   TextAlignment="Center"
                                   VerticalAlignment="Center" />
                    </Grid>
                </Border>
                <Border Grid.Row="1"
                        Opacity="1.0"
                        Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
                        BorderBrush="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=BorderBrush}"
                        BorderThickness="4,0,4,4">
                    <ContentPresenter Content="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Content}" />
                </Border>
            </Grid>
        </ControlTemplate>
    </Window.Template>
    <Window.Resources>
        <!--#region Colors -->
        <Brush x:Key="DefaultFontColor">#FF444444</Brush>
        <LinearGradientBrush x:Key="ListBoxBackgroundBrush">
            <LinearGradientBrush.EndPoint>1,0.001</LinearGradientBrush.EndPoint>
            <LinearGradientBrush.StartPoint>0,0</LinearGradientBrush.StartPoint>
            <GradientBrush.GradientStops>
                <GradientStopCollection>
                    <GradientStop Color="White"
                                  Offset="0.0" />
                    <GradientStop Color="White"
                                  Offset="0.6" />
                    <GradientStop Color="#DDDDDD"
                                  Offset="1.2" />
                </GradientStopCollection>
            </GradientBrush.GradientStops>
        </LinearGradientBrush>
        <LinearGradientBrush x:Key="PressedBrush">
            <LinearGradientBrush.EndPoint>0,1</LinearGradientBrush.EndPoint>
            <LinearGradientBrush.StartPoint>0,0</LinearGradientBrush.StartPoint>
            <GradientBrush.GradientStops>
                <GradientStopCollection>
                    <GradientStop Color="#BBB"
                                  Offset="0.0" />
                    <GradientStop Color="#EEE"
                                  Offset="0.1" />
                    <GradientStop Color="#EEE"
                                  Offset="0.9" />
                    <GradientStop Color="#FFF"
                                  Offset="1.0" />
                </GradientStopCollection>
            </GradientBrush.GradientStops>
        </LinearGradientBrush>
        <LinearGradientBrush x:Key="StandardBrush">
            <LinearGradientBrush.EndPoint>0,0</LinearGradientBrush.EndPoint>
            <LinearGradientBrush.StartPoint>0,0</LinearGradientBrush.StartPoint>
            <GradientBrush.GradientStops>
                <GradientStopCollection>
                    <GradientStop Color="#FFF"
                                  Offset="0.0" />
                    <GradientStop Color="#CCC"
                                  Offset="1.0" />
                </GradientStopCollection>
            </GradientBrush.GradientStops>
        </LinearGradientBrush>
        <SolidColorBrush x:Key="DisabledForegroundBrush"
                         Color="#888" />
        <SolidColorBrush x:Key="GlyphBrush"
                         Color="White" />
        <SolidColorBrush x:Key="HorizontalNormalBorderBrush"
                         Color="#888" />
        <SolidColorBrush x:Key="HorizontalNormalBrush"
                         Color="#888" />
        <SolidColorBrush x:Key="HoverBorderBrush"
                         Color="#DDD" />
        <SolidColorBrush x:Key="NormalBorderBrush"
                         Color="#888" />
        <SolidColorBrush x:Key="NormalBrush"
                         Color="#888" />
        <SolidColorBrush x:Key="ScbPropMouseOver"
                         Color="#FF11BEFF" />
        <SolidColorBrush x:Key="ScbPropListItemMouseOver"
                         Color="#FFDCF1F7" />
        <SolidColorBrush x:Key="SelectedBackgroundBrush"
                         Color="Gray" />
        <SolidColorBrush x:Key="SelectedForegroundBrush"
                         Color="White" />
        <SolidColorBrush x:Key="StandardBackgroundBrush"
                         Color="#FFF" />
        <SolidColorBrush x:Key="StandardBorderBrush"
                         Color="#888" />
        <!--#endregion-->

        <!--#region Converters -->
        <c:ADUserConverter x:Key="UserConverter" />
        <c:ADGrpDistNameConverter x:Key="GroupConverter" />
        <c:ADUserOtherTelephoneFormater x:Key="PhonenumberFormater" />
        <c:StringDateToDate x:Key="StringDateToDateTimeConverter" />
        <c:WidthLessThan x:Key="WidthLessThan" />
        <!--#endregion-->

        <!--#region Icons -->
        <Geometry x:Key="AboutIcon">M13,9H11V7H13M13,17H11V11H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z</Geometry>
        <Geometry x:Key="ArrowRightIcon">M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z</Geometry>
        <Geometry x:Key="ComputerIcon">M6,2C4.89,2 4,2.89 4,4V12C4,13.11 4.89,14 6,14H18C19.11,14 20,13.11 20,12V4C20,2.89 19.11,2 18,2H6M6,4H18V12H6V4M4,15C2.89,15 2,15.89 2,17V20C2,21.11 2.89,22 4,22H20C21.11,22 22,21.11 22,20V17C22,15.89 21.11,15 20,15H4M8,17H20V20H8V17M9,17.75V19.25H13V17.75H9M15,17.75V19.25H19V17.75H15Z</Geometry>
        <Geometry x:Key="ComputerOnlineFalse">M9,7L11,12L9,17H11L12,14.5L13,17H15L13,12L15,7H13L12,9.5L11,7H9Z</Geometry>
        <Geometry x:Key="ComputerOnlineTrue">M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z</Geometry>
        <Geometry x:Key="ComputerOnlineUnknown">M10,19H13V22H10V19M12,2C17.35,2.22 19.68,7.62 16.5,11.67C15.67,12.67 14.33,13.33 13.67,14.17C13,15 13,16 13,17H10C10,15.33 10,13.92 10.67,12.92C11.33,11.92 12.67,11.33 13.5,10.67C15.92,8.43 15.32,5.26 12,5A3,3 0 0,0 9,8H6A6,6 0 0,1 12,2Z</Geometry>
        <Geometry x:Key="FailedSearchIcon">M9,2A7,7 0 0,1 16,9C16,10.57 15.5,12 14.61,13.19L15.41,14H16L22,20L20,22L14,16V15.41L13.19,14.61C12,15.5 10.57,16 9,16A7,7 0 0,1 2,9A7,7 0 0,1 9,2M5,8V10H13V8H5Z</Geometry>
        <Geometry x:Key="FileIcon">M6,2A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6M6,4H13V9H18V20H6V4M8,12V14H16V12H8M8,16V18H13V16H8Z</Geometry>
        <Geometry x:Key="FolderIcon">M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z</Geometry>
        <Geometry x:Key="GetSysManInfo">M14,2L20,8V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V4A2,2 0 0,1 6,2H14M18,20V9H13V4H6V20H18M12,19L8,15H10.5V12H13.5V15H16L12,19Z</Geometry>
        <Geometry x:Key="GroupIcon">M16 17V19H2V17S2 13 9 13 16 17 16 17M12.5 7.5A3.5 3.5 0 1 0 9 11A3.5 3.5 0 0 0 12.5 7.5M15.94 13A5.32 5.32 0 0 1 18 17V19H22V17S22 13.37 15.94 13M15 4A3.39 3.39 0 0 0 13.07 4.59A5 5 0 0 1 13.07 10.41A3.39 3.39 0 0 0 15 11A3.5 3.5 0 0 0 15 4Z</Geometry>
        <Geometry x:Key="HistoryIcon">M21 11.11V5C21 3.9 20.11 3 19 3H14.82C14.4 1.84 13.3 1 12 1S9.6 1.84 9.18 3H5C3.9 3 3 3.9 3 5V19C3 20.11 3.9 21 5 21H11.11C12.37 22.24 14.09 23 16 23C19.87 23 23 19.87 23 16C23 14.09 22.24 12.37 21 11.11M12 3C12.55 3 13 3.45 13 4S12.55 5 12 5 11 4.55 11 4 11.45 3 12 3M5 19V5H7V7H17V5H19V9.68C18.09 9.25 17.08 9 16 9H7V11H11.1C10.5 11.57 10.04 12.25 9.68 13H7V15H9.08C9.03 15.33 9 15.66 9 16C9 17.08 9.25 18.09 9.68 19H5M16 21C13.24 21 11 18.76 11 16S13.24 11 16 11 21 13.24 21 16 18.76 21 16 21M16.5 16.25L19.36 17.94L18.61 19.16L15 17V12H16.5V16.25Z</Geometry>
        <Geometry x:Key="ObjCloseIcon">M19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M19,19H5V5H19V19M17,8.4L13.4,12L17,15.6L15.6,17L12,13.4L8.4,17L7,15.6L10.6,12L7,8.4L8.4,7L12,10.6L15.6,7L17,8.4Z</Geometry>
        <Geometry x:Key="ObjCopyInfoIcon">M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z</Geometry>
        <Geometry x:Key="ObjDetailedInfoIcon">M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22H20A2,2 0 0,0 22,20V12A10,10 0 0,0 12,2M13,7H11V11H7V13H11V17H13V13H17V11H13V7Z</Geometry>
        <Geometry x:Key="O365Icon">M19.94 5.59V18.39Q19.94 19.06 19.55 19.59 19.16 20.11 18.5 20.29L12.77 21.94Q12.65 21.97 12.5 22H12.28Q11.95 22 11.68 21.91 11.41 21.82 11.13 21.67L7.38 19.55Q7.17 19.43 7.05 19.24 6.93 19.05 6.93 18.81 6.93 18.45 7.19 18.2 7.44 17.95 7.8 17.95H12.66V6.14L9 7.44Q8.57 7.6 8.3 8 8.03 8.38 8.03 8.85V15.58Q8.03 16 7.82 16.34 7.62 16.68 7.25 16.88L5.53 17.82Q5.29 17.95 5.05 17.95 4.64 17.95 4.35 17.66 4.06 17.37 4.06 16.95V7.47Q4.06 6.95 4.33 6.5 4.61 6 5.06 5.74L11.22 2.24Q11.43 2.12 11.67 2.06 11.91 2 12.15 2 12.32 2 12.46 2.03 12.6 2.05 12.77 2.1L18.5 3.69Q18.83 3.78 19.09 3.96 19.35 4.14 19.54 4.39 19.74 4.65 19.84 4.95 19.94 5.26 19.94 5.59M18.62 18.39V5.59Q18.62 5.36 18.5 5.19 18.35 5 18.13 4.96L15.31 4.18Q15 4.09 14.65 4 14.32 3.89 14 3.81V20.21L18.13 19Q18.35 18.96 18.5 18.79 18.62 18.62 18.62 18.39Z</Geometry>
        <Geometry x:Key="O365SharedMailboxIcon">M12,5.5A3.5,3.5 0 0,1 15.5,9A3.5,3.5 0 0,1 12,12.5A3.5,3.5 0 0,1 8.5,9A3.5,3.5 0 0,1 12,5.5M5,8C5.56,8 6.08,8.15 6.53,8.42C6.38,9.85 6.8,11.27 7.66,12.38C7.16,13.34 6.16,14 5,14A3,3 0 0,1 2,11A3,3 0 0,1 5,8M19,8A3,3 0 0,1 22,11A3,3 0 0,1 19,14C17.84,14 16.84,13.34 16.34,12.38C17.2,11.27 17.62,9.85 17.47,8.42C17.92,8.15 18.44,8 19,8M5.5,18.25C5.5,16.18 8.41,14.5 12,14.5C15.59,14.5 18.5,16.18 18.5,18.25V20H5.5V18.25M0,20V18.5C0,17.11 1.89,15.94 4.45,15.6C3.86,16.28 3.5,17.22 3.5,18.25V20H0M24,20H20.5V18.25C20.5,17.22 20.14,16.28 19.55,15.6C22.11,15.94 24,17.11 24,18.5V20Z</Geometry>
        <Geometry x:Key="O365DistributionlistIcon">M10,2C8.89,2 8,2.89 8,4V7C8,8.11 8.89,9 10,9H11V11H2V13H6V15H5C3.89,15 3,15.89 3,17V20C3,21.11 3.89,22 5,22H9C10.11,22 11,21.11 11,20V17C11,15.89 10.11,15 9,15H8V13H16V15H15C13.89,15 13,15.89 13,17V20C13,21.11 13.89,22 15,22H19C20.11,22 21,21.11 21,20V17C21,15.89 20.11,15 19,15H18V13H22V11H13V9H14C15.11,9 16,8.11 16,7V4C16,2.89 15.11,2 14,2H10M10,4H14V7H10V4M5,17H9V20H5V17M15,17H19V20H15V17Z</Geometry>
        <Geometry x:Key="O365ResourceIcon">M12.9 4.22C18.73 6.84 20 2 20 2S18.89 8.07 13.79 10.55C12.75 11.06 12.1 11.33 12.1 11.33L3.73 7.25L12.1 3.82C12.1 3.82 11.9 3.76 12.9 4.22M11.12 22L3.33 17.78V9.07L11.12 13.04V22M12.88 22L20.68 17.78V9.07L12.88 13.04V22Z</Geometry>
        <Geometry x:Key="O365RoomIcon">M8,3C6.89,3 6,3.89 6,5V21H18V5C18,3.89 17.11,3 16,3H8M8,5H16V19H8V5M13,11V13H15V11H13Z</Geometry>
        <Geometry x:Key="O365UserIcon">M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z</Geometry>
        <Geometry x:Key="OtherIcon">M11 15H6L13 1V9H18L11 23V15Z</Geometry>
        <Geometry x:Key="OutputIcon">M23,12L19,8V11H10V13H19V16M1,18V6C1,4.89 1.9,4 3,4H15A2,2 0 0,1 17,6V9H15V6H3V18H15V15H17V18A2,2 0 0,1 15,20H3A2,2 0 0,1 1,18Z</Geometry>
        <Geometry x:Key="PrinterIcon">M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z</Geometry>
        <Geometry x:Key="SeparateToolsIcon">M16,20H20V16H16M16,14H20V10H16M10,8H14V4H10M16,8H20V4H16M10,14H14V10H10M4,14H8V10H4M4,20H8V16H4M10,20H14V16H10M4,8H8V4H4V8Z</Geometry>
        <Geometry x:Key="ToolsIcon">M21.71 20.29L20.29 21.71A1 1 0 0 1 18.88 21.71L7 9.85A3.81 3.81 0 0 1 6 10A4 4 0 0 1 2.22 4.7L4.76 7.24L5.29 6.71L6.71 5.29L7.24 4.76L4.7 2.22A4 4 0 0 1 10 6A3.81 3.81 0 0 1 9.85 7L21.71 18.88A1 1 0 0 1 21.71 20.29M2.29 18.88A1 1 0 0 0 2.29 20.29L3.71 21.71A1 1 0 0 0 5.12 21.71L10.59 16.25L7.76 13.42M20 2L16 4V6L13.83 8.17L15.83 10.17L18 8H20L22 4Z</Geometry>
        <Geometry x:Key="UserIcon">M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z</Geometry>
        <!--#endregion-->

        <!--#region Sys variables -->
        <sys:DateTime x:Key="DateTime" />
        <sys:Double x:Key="BrdMaxHeight">400</sys:Double>
        <sys:Double x:Key="PropValMaxHeight">315</sys:Double>
        <sys:String x:Key="StrCompressedDateTimeFormat">x</sys:String>
        <sys:String x:Key="StrDateFormat">x</sys:String>
        <sys:String x:Key="StrFullDateTimeFormat">x</sys:String>
        <sys:String x:Key="StrOpensSeparateWindow">x</sys:String>
        <sys:String x:Key="StrRealPropName">x</sys:String>
        <sys:String x:Key="StrTimeFormat">x</sys:String>
        <x:Array x:Key="ContentNoMembersOfList"
                 Type="sys:String" />
        <!--#endregion-->

        <!--#region Spacing -->
        <GridLength x:Key="GridDetailedColWidth">260</GridLength>
        <GridLength x:Key="MiIconWidth">40</GridLength>
        <Thickness x:Key="StdMargin">5</Thickness>
        <Thickness x:Key="StdPadding">3</Thickness>
        <!--#endregion-->

        <!--#region Visuals -->
        <TransformGroup x:Key="TgMirrored">
            <ScaleTransform ScaleX="-1"
                            ScaleY="-1" />
            <TranslateTransform X="{Binding RelativeSource={RelativeSource AncestorType=Path}, Path=ActualWidth}"
                                Y="{Binding RelativeSource={RelativeSource AncestorType=Path}, Path=ActualHeight}" />
        </TransformGroup>
        <TransformGroup x:Key="TgOriginal">
            <ScaleTransform ScaleX="1"
                            ScaleY="1" />
            <TranslateTransform X="0"
                                Y="0" />
        </TransformGroup>
        <Visibility x:Key="ExchangeAdministrator">Collapsed</Visibility>
        <Visibility x:Key="MenuTextVisibility">Visible</Visibility>
        <Visibility x:Key="MiO365TopVisible">Collapsed</Visibility>
        <!--#endregion-->

        <!--#region Viewsources -->
        <componentmodel:SortDescriptionCollection x:Key="SdcTopMenuItems">
            <!-- Used as reference for sortdescriptions in menus -->
            <componentmodel:SortDescription Direction="Descending"
                                            PropertyName="IsSubMenuHeader" />
            <componentmodel:SortDescription Direction="Ascending"
                                            PropertyName="MenuItem" />
        </componentmodel:SortDescriptionCollection>

        <CollectionViewSource x:Key="CvsDetailedProps"
                              IsLiveFilteringRequested="True">
            <CollectionViewSource.SortDescriptions>
                <componentmodel:SortDescription Direction="Ascending"
                                                PropertyName="Name" />

            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>
        <CollectionViewSource x:Key="CvsMiOutputHistory">
            <CollectionViewSource.SortDescriptions>
                <componentmodel:SortDescription Direction="Descending"
                                                PropertyName="Started" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>
        <CollectionViewSource x:Key="CvsPropsList">
            <CollectionViewSource.SortDescriptions>
                <componentmodel:SortDescription Direction="Ascending"
                                                PropertyName="Name" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>
        <CollectionViewSource x:Key="CvsPropSourceFilters">
            <CollectionViewSource.SortDescriptions>
                <componentmodel:SortDescription Direction="Ascending"
                                                PropertyName="Name" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>

        <CollectionViewSource x:Key="CvsMiAbout" />
        <CollectionViewSource x:Key="CvsMiComputerFunctions" />
        <CollectionViewSource x:Key="CvsMiFileInfoFunctions" />
        <CollectionViewSource x:Key="CvsMiDirectoryInfoFunctions" />
        <CollectionViewSource x:Key="CvsMiGroupFunctions" />
        <CollectionViewSource x:Key="CvsMiOtherFunctions" />
        <CollectionViewSource x:Key="CvsMiPrintQueueFunctions" />
        <CollectionViewSource x:Key="CvsMiSeparateToolsFunctions" />
        <CollectionViewSource x:Key="CvsMiTools" />
        <CollectionViewSource x:Key="CvsMiUserFunctions" />
        <CollectionViewSource x:Key="CvsMiO365UserFunctions" />
        <CollectionViewSource x:Key="CvsMiO365SharedMailboxFunctions" />
        <CollectionViewSource x:Key="CvsMiO365DistributionlistFunctions" />
        <CollectionViewSource x:Key="CvsMiO365ResourceFunctions" />
        <CollectionViewSource x:Key="CvsMiO365RoomFunctions" />
        <!--#endregion-->

        <!--#region Dependant styles -->
        <Style TargetType="Path"
               x:Key="PathMenuIconStyle">
            <Setter Property="Fill"
                    Value="Black" />
            <Setter Property="Margin"
                    Value="{StaticResource StdMargin}" />
            <Setter Property="Stroke"
                    Value="Black" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=MenuItem}, Path=IsEnabled}"
                             Value="False">
                    <Setter Property="Fill"
                            Value="LightGray" />
                    <Setter Property="Stroke"
                            Value="LightGray" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style TargetType="Path"
               x:Key="PathObjectMenuIconStyle"
               BasedOn="{StaticResource PathMenuIconStyle}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Menu}, Path=IsEnabled}"
                             Value="False">
                    <Setter Property="Fill"
                            Value="LightGray" />
                    <Setter Property="Stroke"
                            Value="LightGray" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <!--#endregion-->

        <Style TargetType="Border"
               x:Key="MenuTitleStyle">
            <Setter Property="BorderBrush">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0"
                                         EndPoint="1,0">
                        <GradientStop Color="#0000"
                                      Offset="0.0" />
                        <GradientStop Color="Black"
                                      Offset="0.3" />
                        <GradientStop Color="Black"
                                      Offset="0.6" />
                        <GradientStop Color="#0000"
                                      Offset="1" />
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Setter Property="BorderThickness"
                    Value="0,1,0,2" />
        </Style>
        <Style TargetType="Border"
               x:Key="PropBorder">
            <Setter Property="HorizontalAlignment"
                    Value="Stretch" />
            <Setter Property="Margin"
                    Value="{StaticResource StdMargin}" />
            <Setter Property="MaxHeight"
                    Value="{StaticResource BrdMaxHeight}" />
            <Setter Property="Visibility"
                    Value="Visible" />
            <Setter Property="RenderTransform">
                <Setter.Value>
                    <TranslateTransform X="30" />
                </Setter.Value>
            </Setter>
            <Setter Property="Opacity"
                    Value="0" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=DataContext}"
                             Value="{x:Null}">
                    <Setter Property="Visibility"
                            Value="Collapsed" />
                </DataTrigger>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=DataContext.Count}"
                             Value="0">
                    <Setter Property="Visibility"
                            Value="Collapsed" />
                </DataTrigger>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsMouseOver}"
                             Value="True">
                    <Setter Property="Background"
                            Value="{StaticResource ScbPropMouseOver}" />
                </DataTrigger>
                <EventTrigger RoutedEvent="Loaded">
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                             To="1"
                                             Duration="00:00:01" />
                            <DoubleAnimation Storyboard.TargetProperty="(RenderTransform).X"
                                             To="0"
                                             Duration="00:00:00.4" />
                        </Storyboard>
                    </BeginStoryboard>
                </EventTrigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="Button"
               x:Key="BtnBaseStyle">
            <Setter Property="Foreground"
                    Value="{StaticResource DefaultFontColor}" />
            <Setter Property="OverridesDefaultStyle"
                    Value="True" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Name="BtnBrd"
                                Background="#FFDDDDDD"
                                BorderBrush="#FF555555"
                                BorderThickness="1"
                                Margin="4,0"
                                Padding="5">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=IsEnabled}"
                                         Value="False">
                                <Setter Property="Foreground"
                                        Value="LightGray" />
                                <Setter Property="BorderBrush"
                                        TargetName="BtnBrd"
                                        Value="LightGray" />
                            </DataTrigger>
                            <Trigger Property="IsMouseOver"
                                     Value="True">
                                <Trigger.EnterActions>
                                    <BeginStoryboard Name="StoryBtnEnterHover">
                                        <Storyboard>
                                            <ColorAnimation AutoReverse="True"
                                                            Duration="0:0:0.5"
                                                            Storyboard.TargetName="BtnBrd"
                                                            Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)"
                                                            To="White" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.EnterActions>
                            </Trigger>
                            <!--#region Button got focus -->
                            <EventTrigger RoutedEvent="Keyboard.PreviewGotKeyboardFocus">
                                <BeginStoryboard Name="BtnFocusStory">
                                    <Storyboard>
                                        <ColorAnimation AutoReverse="True"
                                                        Duration="0:0:1"
                                                        RepeatBehavior="Forever"
                                                        Storyboard.TargetName="BtnBrd"
                                                        Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)"
                                                        To="PowderBlue" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                            <EventTrigger RoutedEvent="Keyboard.PreviewLostKeyboardFocus">
                                <StopStoryboard BeginStoryboardName="BtnFocusStory" />
                            </EventTrigger>
                            <EventTrigger RoutedEvent="Keyboard.LostKeyboardFocus">
                                <StopStoryboard BeginStoryboardName="BtnFocusStory" />
                            </EventTrigger>
                            <!--#endregion Button got focus -->
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style TargetType="Button"
               x:Key="BtnCopyOutputBaseStyle"
               BasedOn="{StaticResource BtnBaseStyle}">
            <Setter Property="Grid.Row"
                    Value="1" />
            <Setter Property="HorizontalAlignment"
                    Value="Right" />
            <Setter Property="VerticalAlignment"
                    Value="Center" />
        </Style>
        <Style TargetType="Button"
               x:Key="BtnCopyOutputDataStyle"
               BasedOn="{StaticResource BtnCopyOutputBaseStyle}">
            <EventSetter Event="Click" />
        </Style>
        <Style TargetType="Button"
               x:Key="BtnCopyOutputObjectStyle"
               BasedOn="{StaticResource BtnCopyOutputBaseStyle}">
            <EventSetter Event="Click" />
        </Style>
        <Style TargetType="Button"
               x:Key="BtnCopyPropertyStyle"
               BasedOn="{StaticResource BtnBaseStyle}">
            <EventSetter Event="Click" />
            <Setter Property="Content"
                    Value="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnCopyValue}" />
            <Setter Property="Grid.Column"
                    Value="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=ColumnDefinitions.Count}" />
            <Setter Property="Grid.Row"
                    Value="0" />
            <Setter Property="Padding"
                    Value="5,0" />
        </Style>
        <Style TargetType="Button"
               x:Key="BtnRunPropStyle"
               BasedOn="{StaticResource BtnBaseStyle}">
            <EventSetter Event="Click" />
        </Style>

        <Style TargetType="ComboBox"
               x:Key="CbInputStyle">
            <EventSetter Event="SelectionChanged" />
        </Style>

        <Style TargetType="DataGrid"
               x:Key="DgBaseStyle">
            <Setter Property="AutoGenerateColumns"
                    Value="True" />
            <Setter Property="Grid.Row"
                    Value="1" />
            <Setter Property="HeadersVisibility"
                    Value="Column" />
            <Setter Property="IsReadOnly"
                    Value="True" />
            <Setter Property="VerticalScrollBarVisibility"
                    Value="Auto" />
        </Style>
        <Style TargetType="DataGrid"
               x:Key="DgPropValueStyle"
               BasedOn="{StaticResource DgBaseStyle}">
            <Setter Property="CanUserAddRows"
                    Value="False" />
            <Setter Property="CanUserDeleteRows"
                    Value="False" />
            <Setter Property="CanUserReorderColumns"
                    Value="False" />
            <Setter Property="ItemsSource"
                    Value="{Binding Path=.}" />
        </Style>

        <Style TargetType="ItemsControl"
               x:Key="IcBaseStyle">
            <Setter Property="ItemsPanel">
                <Setter.Value>
                    <ItemsPanelTemplate>
                        <StackPanel />
                    </ItemsPanelTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility"
                    Value="Auto" />
            <Setter Property="ScrollViewer.VerticalScrollBarVisibility"
                    Value="Auto" />
            <Setter Property="VirtualizingPanel.IsVirtualizing"
                    Value="True" />
            <Setter Property="VirtualizingPanel.VirtualizationMode"
                    Value="Recycling" />
        </Style>

        <Style TargetType="ListBoxItem">
            <Style.Triggers>
                <Trigger Property="ItemsControl.AlternationIndex"
                         Value="0">
                    <Setter Property="Background"
                            Value="#FFFFFFFF" />
                </Trigger>
                <Trigger Property="ItemsControl.AlternationIndex"
                         Value="1">
                    <Setter Property="Background"
                            Value="#19000000" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="Menu"
               x:Key="MenuBaseStyle">
            <Setter Property="ItemsPanel">
                <Setter.Value>
                    <ItemsPanelTemplate>
                        <StackPanel />
                    </ItemsPanelTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Background">
                <Setter.Value>
                    <SolidColorBrush Opacity="0" />
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="MenuItem"
               x:Key="MiSubLevelBaseStyle">
            <Setter Property="FontSize"
                    Value="12" />
            <Setter Property="FontStyle"
                    Value="Normal" />
            <Setter Property="FontWeight"
                    Value="Normal" />
            <Setter Property="ToolTip">
                <Setter.Value>
                    <Border Background="{StaticResource HoverBorderBrush}"
                            BorderBrush="Black"
                            Margin="2">
                        <StackPanel Margin="{StaticResource StdMargin}">
                            <StackPanel.Resources>
                                <Style TargetType="TextBlock"
                                       x:Key="TblTtStyle">
                                    <Setter Property="FontStyle"
                                            Value="Italic" />
                                    <Setter Property="FontWeight"
                                            Value="Bold" />
                                    <Setter Property="Margin"
                                            Value="{StaticResource StdMargin}" />
                                </Style>
                            </StackPanel.Resources>
                            <TextBlock FontStyle="Normal"
                                       FontWeight="Normal"
                                       Text="{Binding Path=Description}">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock"
                                           BasedOn="{StaticResource TblTtStyle}">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Path=Description}"
                                                         Value="{x:Null}">
                                                <Setter Property="Visibility"
                                                        Value="Collapsed" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                            <TextBlock Grid.Row="1"
                                       Text="{DynamicResource StrOpensSeparateWindow}">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock"
                                           BasedOn="{StaticResource TblTtStyle}">
                                        <Setter Property="Visibility"
                                                Value="Collapsed" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Path=Separate}"
                                                         Value="True">
                                                <Setter Property="Visibility"
                                                        Value="Visible" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                            <TextBlock Grid.Row="2"
                                       Text="{Binding Path=ValidDateNote}">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock"
                                           BasedOn="{StaticResource TblTtStyle}">
                                        <Setter Property="Visibility"
                                                Value="Visible" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Path=ValidDateNote}"
                                                         Value="{x:Null}">
                                                <Setter Property="Visibility"
                                                        Value="Collapsed" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </StackPanel>
                    </Border>
                </Setter.Value>
            </Setter>
            <Setter Property="ToolTipService.ShowOnDisabled"
                    Value="True" />
            <Setter Property="UsesItemContainerTemplate"
                    Value="True" />
            <Setter Property="Visibility"
                    Value="Collapsed" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding Path=Separate}"
                             Value="True">
                    <Setter Property="FontStyle"
                            Value="Italic" />
                    <Setter Property="FontWeight"
                            Value="Bold" />
                </DataTrigger>
                <DataTrigger Binding="{Binding Path=MenuItem}"
                             Value="{x:Null}">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate>
                                <Separator />
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </DataTrigger>
                <DataTrigger Binding="{Binding Path=Description}"
                             Value="{x:Null}">
                    <Setter Property="ToolTip"
                            Value="{x:Null}" />
                </DataTrigger>
                <DataTrigger Binding="{Binding Path=IsSubMenuHeader}"
                             Value="1">
                    <Setter Property="HeaderTemplate">
                        <Setter.Value>
                            <DataTemplate>
                                <Border BorderBrush="Black"
                                        BorderThickness="0,0,5,0">
                                    <TextBlock FontSize="14"
                                               FontWeight="Bold"
                                               Margin="{StaticResource StdMargin}"
                                               Text="{Binding RelativeSource={RelativeSource AncestorType=MenuItem}, Path=DataContext.MenuItem}" />
                                </Border>
                            </DataTemplate>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="Visibility"
                            Value="Visible" />
                </DataTrigger>
                <MultiDataTrigger>
                    <MultiDataTrigger.Conditions>
                        <Condition Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=DataContext.SearchedItemRequest}"
                                   Value="Required" />
                        <Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=DataContext.SearchedItem}"
                                   Value="{x:Null}" />
                    </MultiDataTrigger.Conditions>
                    <Setter Property="Visibility"
                            Value="Collapsed" />
                </MultiDataTrigger>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=DataContext.SearchedItemRequest}"
                             Value="None">
                    <Setter Property="Visibility"
                            Value="Visible" />
                </DataTrigger>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=DataContext.SearchedItemRequest}"
                             Value="Allowed">
                    <Setter Property="Visibility"
                            Value="Visible" />
                </DataTrigger>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=DataContext.SearchedItemRequest}"
                             Value="{x:Null}">
                    <Setter Property="Visibility"
                            Value="Visible" />
                </DataTrigger>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=DataContext.Depends}"
                             Value="ExchangeAdministrator">
                    <Setter Property="Visibility"
                            Value="{DynamicResource ExchangeAdministrator}" />
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="MenuItem"
               x:Key="MiSubLevelFunctionsStyle"
               BasedOn="{StaticResource MiSubLevelBaseStyle}">
            <EventSetter Event="Click" />
        </Style>
        <Style TargetType="MenuItem"
               x:Key="MiSubLevelToolStyle"
               BasedOn="{StaticResource MiSubLevelBaseStyle}">
            <EventSetter Event="Click" />
            <Setter Property="Visibility"
                    Value="Visible" />
        </Style>
        <Style TargetType="MenuItem"
               x:Key="MiTopLevelStyle">
            <Setter Property="FontWeight"
                    Value="Bold" />
            <Setter Property="FontSize"
                    Value="14" />
            <Setter Property="Foreground"
                    Value="{StaticResource DefaultFontColor}" />
            <Setter Property="ItemTemplate">
                <Setter.Value>
                    <HierarchicalDataTemplate ItemsSource="{Binding Path=MenuItems}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Border BorderThickness="5,0,0,0"
                                    HorizontalAlignment="Stretch">
                                <Border.Style>
                                    <Style TargetType="Border">
                                        <Setter Property="BorderBrush"
                                                Value="Transparent" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Path=SearchedItemRequest}"
                                                         Value="Allowed">
                                                <Setter Property="BorderBrush"
                                                        Value="Yellow" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Path=SearchedItemRequest}"
                                                         Value="Required">
                                                <Setter Property="BorderBrush"
                                                        Value="Green" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>
                                <TextBlock Margin="{StaticResource StdMargin}"
                                           Text="{Binding Path=MenuItem}" />
                            </Border>
                            <Path Grid.Column="1"
                                  Margin="0,5,0,0">
                                <Path.Style>
                                    <Style TargetType="Path">
                                        <Setter Property="RenderTransform">
                                            <Setter.Value>
                                                <ScaleTransform ScaleX="0.75"
                                                                ScaleY="0.75" />
                                            </Setter.Value>
                                        </Setter>
                                        <Setter Property="Visibility"
                                                Value="Collapsed" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Path=Note.NoteType}"
                                                         Value="Info">
                                                <Setter Property="Visibility"
                                                        Value="Visible" />
                                                <Setter Property="Data"
                                                        Value="M13,9H11V7H13M13,17H11V11H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z" />
                                                <Setter Property="Fill"
                                                        Value="LightBlue" />
                                                <Setter Property="Stroke"
                                                        Value="Blue" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Path=Note.NoteType}"
                                                         Value="Warning">
                                                <Setter Property="Visibility"
                                                        Value="Visible" />
                                                <Setter Property="Data"
                                                        Value="M13 14H11V9H13M13 18H11V16H13M1 21H23L12 2L1 21Z" />
                                                <Setter Property="Fill"
                                                        Value="Yellow" />
                                                <Setter Property="Stroke"
                                                        Value="Red" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Path.Style>
                            </Path>
                        </Grid>
                    </HierarchicalDataTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Visibility"
                    Value="Visible" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding ElementName=PbSearchProgress, Path=Visibility}"
                             Value="Visible">
                    <Setter Property="IsEnabled"
                            Value="False" />
                </DataTrigger>
                <DataTrigger Binding="{Binding ElementName=GridProgress, Path=Visibility}"
                             Value="Visible">
                    <Setter Property="IsEnabled"
                            Value="False" />
                </DataTrigger>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=IsEnabled}"
                             Value="False">
                    <Setter Property="Foreground"
                            Value="LightGray" />
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="RepeatButton"
               x:Key="ScrollBarLineButton">
            <Setter Property="Focusable"
                    Value="False" />
            <Setter Property="Foreground"
                    Value="{StaticResource DefaultFontColor}" />
            <Setter Property="OverridesDefaultStyle"
                    Value="True" />
            <Setter Property="SnapsToDevicePixels"
                    Value="True" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type RepeatButton}">
                        <Border Name="Border"
                                Background="{StaticResource NormalBrush}"
                                BorderBrush="{StaticResource NormalBorderBrush}"
                                BorderThickness="1"
                                CornerRadius="0"
                                Margin="0">
                            <Path Data="{Binding Path=Content, RelativeSource={RelativeSource TemplatedParent}}"
                                  Fill="{StaticResource GlyphBrush}"
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsPressed"
                                     Value="True">
                                <Setter TargetName="Border"
                                        Property="Background"
                                        Value="{StaticResource PressedBrush}" />
                            </Trigger>
                            <Trigger Property="IsEnabled"
                                     Value="False">
                                <Setter Property="Foreground"
                                        Value="{StaticResource DisabledForegroundBrush}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style TargetType="{x:Type RepeatButton}"
               x:Key="ScrollBarPageButton">
            <Setter Property="SnapsToDevicePixels"
                    Value="True" />
            <Setter Property="OverridesDefaultStyle"
                    Value="True" />
            <Setter Property="IsTabStop"
                    Value="False" />
            <Setter Property="Focusable"
                    Value="False" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type RepeatButton}">
                        <Border Background="Transparent" />
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="DataGridRow"
               x:Key="DgrFuncOutputStyle">
            <EventSetter Event="Control.RequestBringIntoView" />
            <Style.Triggers>
                <Trigger Property="DataGrid.AlternationCount"
                         Value="0">
                    <Setter Property="Background"
                            Value="White" />
                </Trigger>
                <Trigger Property="DataGrid.AlternationIndex"
                         Value="1">
                    <Setter Property="Background"
                            Value="#e1e1e1" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="Label"
               x:Key="LblPropStringValueStyle">
            <Setter Property="Background"
                    Value="White" />
            <Setter Property="Padding"
                    Value="{StaticResource StdPadding}" />
            <Setter Property="VerticalAlignment"
                    Value="Center" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=IsMouseOver}"
                             Value="True">
                    <Setter Property="Background"
                            Value="PowderBlue" />
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="{x:Type Thumb}"
               x:Key="ScrollBarThumb">
            <Setter Property="SnapsToDevicePixels"
                    Value="True" />
            <Setter Property="OverridesDefaultStyle"
                    Value="True" />
            <Setter Property="IsTabStop"
                    Value="False" />
            <Setter Property="Focusable"
                    Value="False" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Thumb}">
                        <Border CornerRadius="0"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="1" />
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="ScrollViewer"
               x:Key="ScVObjStyle">
            <Setter Property="HorizontalScrollBarVisibility"
                    Value="Auto" />
            <Setter Property="OverridesDefaultStyle"
                    Value="True" />
            <Setter Property="VerticalScrollBarVisibility"
                    Value="Auto" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollViewer">
                        <Grid Background="Transparent">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <ScrollContentPresenter />

                            <ScrollBar Name="PART_VerticalScrollBar"
                                       Grid.Column="1"
                                       Maximum="{TemplateBinding ScrollableHeight}"
                                       Value="{TemplateBinding VerticalOffset}"
                                       ViewportSize="{TemplateBinding ViewportHeight}"
                                       Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}" />
                            <ScrollBar Name="PART_HorizontalScrollBar"
                                       Grid.Column="0"
                                       Grid.ColumnSpan="2"
                                       Grid.Row="1"
                                       Maximum="{TemplateBinding ScrollableWidth}"
                                       Orientation="Horizontal"
                                       Value="{TemplateBinding HorizontalOffset}"
                                       ViewportSize="{TemplateBinding ViewportWidth}"
                                       Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}" />

                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="TextBlock"
               x:Key="TblBaseStyle">
            <Setter Property="Padding"
                    Value="{StaticResource StdPadding}" />
        </Style>
        <Style TargetType="TextBlock"
               x:Key="TblFunctionMenuStyle">
            <Setter Property="Grid.Column"
                    Value="1" />
            <Setter Property="VerticalAlignment"
                    Value="Center" />
            <Setter Property="Visibility"
                    Value="{DynamicResource MenuTextVisibility}" />
        </Style>
        <Style TargetType="TextBlock"
               x:Key="TblMenuTitleStyle">
            <Setter Property="FontSize"
                    Value="18" />
            <Setter Property="FontWeight"
                    Value="DemiBold" />
            <Setter Property="Margin"
                    Value="{StaticResource StdMargin}" />
            <Setter Property="TextAlignment"
                    Value="Center" />
            <Setter Property="Visibility"
                    Value="{DynamicResource MenuTextVisibility}" />
        </Style>
        <Style TargetType="TextBlock"
               x:Key="TblObjectMenuStyle">
            <Setter Property="Foreground"
                    Value="{StaticResource DefaultFontColor}" />
            <Setter Property="Grid.Column"
                    Value="1" />
            <Setter Property="VerticalAlignment"
                    Value="Center" />
            <Setter Property="Visibility"
                    Value="{DynamicResource MenuTextVisibility}" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=MenuItem}, Path=IsEnabled}"
                             Value="False">
                    <Setter Property="Foreground"
                            Value="LightGray" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style TargetType="TextBlock"
               x:Key="TblPropListItemStyle"
               BasedOn="{StaticResource TblBaseStyle}">
            <Setter Property="Background"
                    Value="White" />
            <Setter Property="TextWrapping"
                    Value="Wrap" />
            <Setter Property="VerticalAlignment"
                    Value="Center" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=IsMouseOver}"
                             Value="True">
                    <Setter Property="Background"
                            Value="PowderBlue" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style TargetType="TextBlock"
               x:Key="PropTitleStyle"
               BasedOn="{StaticResource TblBaseStyle}">
            <Setter Property="FontSize"
                    Value="15" />
            <Setter Property="FontWeight"
                    Value="Bold" />
            <Setter Property="TextWrapping"
                    Value="Wrap" />
            <Setter Property="VerticalAlignment"
                    Value="Bottom" />
        </Style>
        <Style TargetType="TextBlock"
               x:Key="TblHlStyle">
            <EventSetter Event="MouseDown" />
            <Setter Property="Margin"
                    Value="{StaticResource StdMargin}" />
            <Setter Property="Padding"
                    Value="{StaticResource StdPadding}" />
            <Setter Property="Foreground"
                    Value="Blue" />
            <Setter Property="TextDecorations"
                    Value="None" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=IsMouseOver}"
                             Value="True">
                    <Setter Property="TextDecorations"
                            Value="Underline" />
                    <Setter Property="Background">
                        <Setter.Value>
                            <LinearGradientBrush>
                                <LinearGradientBrush.GradientStops>
                                    <GradientStop Color="Transparent"
                                                  Offset="0" />
                                    <GradientStop Color="PowderBlue"
                                                  Offset="1" />
                                </LinearGradientBrush.GradientStops>
                            </LinearGradientBrush>
                        </Setter.Value>
                    </Setter>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="TextBox"
               x:Key="TbBaseStyle">
            <Setter Property="Margin"
                    Value="{StaticResource StdMargin}" />
            <Setter Property="Padding"
                    Value="{StaticResource StdPadding}" />
        </Style>
        <Style TargetType="TextBox"
               x:Key="TbInputStyle"
               BasedOn="{StaticResource TbBaseStyle}">
            <EventSetter Event="Loaded" />
            <EventSetter Event="TextChanged" />
        </Style>
        <Style TargetType="TextBox"
               x:Key="TbListValueBaseStyle"
               BasedOn="{StaticResource TbBaseStyle}">
            <Setter Property="IsReadOnly"
                    Value="True" />
            <Setter Property="Margin"
                    Value="0" />
            <Setter Property="VerticalContentAlignment"
                    Value="Center" />
        </Style>

        <Style TargetType="Path"
               x:Key="PathMirroredMenuIconStyle"
               BasedOn="{StaticResource PathObjectMenuIconStyle}">
            <Setter Property="RenderTransform"
                    Value="{StaticResource TgMirrored}" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding ElementName=IcPropsList, Path=ItemsSource.Count}"
                             Value="{x:Null}">
                    <Setter Property="Fill"
                            Value="LightGray" />
                    <Setter Property="Stroke"
                            Value="LightGray" />
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <!--#region Styled controls -->
        <ControlTemplate TargetType="{x:Type ScrollBar}"
                         x:Key="VerticalScrollBar">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition MaxHeight="18" />
                    <RowDefinition Height="0.00001*" />
                    <RowDefinition MaxHeight="18" />
                </Grid.RowDefinitions>
                <RepeatButton Grid.Row="0"
                              Style="{StaticResource ScrollBarLineButton}"
                              Height="18"
                              Command="ScrollBar.LineUpCommand"
                              Content="M 0 4 L 8 4 L 4 0 Z" />
                <Track Name="PART_Track"
                       Grid.Row="1"
                       IsDirectionReversed="True">
                    <Track.DecreaseRepeatButton>
                        <RepeatButton Style="{StaticResource ScrollBarPageButton}"
                                      Command="ScrollBar.PageUpCommand" />
                    </Track.DecreaseRepeatButton>
                    <Track.Thumb>
                        <Thumb Style="{StaticResource ScrollBarThumb}"
                               Margin="0"
                               Background="{StaticResource HorizontalNormalBrush}"
                               BorderBrush="{StaticResource HorizontalNormalBorderBrush}" />
                    </Track.Thumb>
                    <Track.IncreaseRepeatButton>
                        <RepeatButton Style="{StaticResource ScrollBarPageButton}"
                                      Command="ScrollBar.PageDownCommand" />
                    </Track.IncreaseRepeatButton>
                </Track>
                <RepeatButton Grid.Row="3"
                              Style="{StaticResource ScrollBarLineButton}"
                              Height="18"
                              Command="ScrollBar.LineDownCommand"
                              Content="M 0 0 L 4 4 L 8 0 Z" />
            </Grid>
        </ControlTemplate>
        <ControlTemplate TargetType="{x:Type ScrollBar}"
                         x:Key="HorizontalScrollBar">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition MaxWidth="18" />
                    <ColumnDefinition Width="0.00001*" />
                    <ColumnDefinition MaxWidth="18" />
                </Grid.ColumnDefinitions>
                <RepeatButton Grid.Column="0"
                              Style="{StaticResource ScrollBarLineButton}"
                              Width="18"
                              Command="ScrollBar.LineLeftCommand"
                              Content="M 4 0 L 4 8 L 0 4 Z" />
                <Track Name="PART_Track"
                       Grid.Column="1"
                       IsDirectionReversed="False">
                    <Track.DecreaseRepeatButton>
                        <RepeatButton Style="{StaticResource ScrollBarPageButton}"
                                      Command="ScrollBar.PageLeftCommand" />
                    </Track.DecreaseRepeatButton>
                    <Track.Thumb>
                        <Thumb Style="{StaticResource ScrollBarThumb}"
                               Margin="0"
                               Background="{StaticResource NormalBrush}"
                               BorderBrush="{StaticResource NormalBorderBrush}" />
                    </Track.Thumb>
                    <Track.IncreaseRepeatButton>
                        <RepeatButton Style="{StaticResource ScrollBarPageButton}"
                                      Command="ScrollBar.PageRightCommand" />
                    </Track.IncreaseRepeatButton>
                </Track>
                <RepeatButton Grid.Column="3"
                              Style="{StaticResource ScrollBarLineButton}"
                              Width="18"
                              Command="ScrollBar.LineRightCommand"
                              Content="M 0 0 L 4 4 L 0 8 Z" />
            </Grid>
        </ControlTemplate>
        <ControlTemplate TargetType="ToggleButton"
                         x:Key="TBtnWithProgressBarStyle">
            <Grid>
                <TextBlock Background="Transparent"
                           HorizontalAlignment="Stretch"
                           Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTBtnObjectDetailed}"
                           TextAlignment="Center"
                           VerticalAlignment="Center" />
            </Grid>
        </ControlTemplate>
        <ControlTemplate TargetType="ToggleButton"
                         x:Key="TBtnCheckedWithProgressBarStyle">
            <Grid>
                <ProgressBar Background="Transparent"
                             IsIndeterminate="True">
                    <ProgressBar.Style>
                        <Style TargetType="ProgressBar">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding ElementName=TBtnObjectDetailed, Path=IsMouseOver}"
                                             Value="True">
                                    <Setter Property="Background"
                                            Value="#FFCCE8FF" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ProgressBar.Style>
                </ProgressBar>
                <TextBlock Background="Transparent"
                           HorizontalAlignment="Center"
                           Text="{Binding ElementName=Window, Path=DataContext.MsgTable.StrSelectPropsDesc}"
                           VerticalAlignment="Center" />
            </Grid>
        </ControlTemplate>
        <!--#endregion-->

        <Style TargetType="{x:Type ScrollBar}"
               x:Key="{x:Type ScrollBar}">
            <Setter Property="Background"
                    Value="#00000000" />
            <Setter Property="BorderThickness"
                    Value="0" />
            <Setter Property="OverridesDefaultStyle"
                    Value="True" />
            <Setter Property="SnapsToDevicePixels"
                    Value="True" />
            <Style.Triggers>
                <Trigger Property="Orientation"
                         Value="Horizontal">
                    <Setter Property="Width"
                            Value="Auto" />
                    <Setter Property="Height"
                            Value="18" />
                    <Setter Property="Template"
                            Value="{StaticResource HorizontalScrollBar}" />
                </Trigger>
                <Trigger Property="Orientation"
                         Value="Vertical">
                    <Setter Property="Width"
                            Value="18" />
                    <Setter Property="Height"
                            Value="Auto" />
                    <Setter Property="Template"
                            Value="{StaticResource VerticalScrollBar}" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <Path x:Key="PathObjDetailed"
              Data="{StaticResource ObjDetailedInfoIcon}"
              Style="{StaticResource PathMenuIconStyle}" />
        <Path x:Key="PathObjDetailedMirrored"
              Data="{StaticResource ObjDetailedInfoIcon}"
              Fill="Red"
              Stroke="Red"
              Style="{StaticResource PathMirroredMenuIconStyle}" />

        <Page x:Key="MainOutput"
              Name="MainOutput">
            <Page.Resources>
                <sys:Double x:Key="IconSize">25</sys:Double>
                <sys:String x:Key="StrBtnNoteWarningUnderstood">x</sys:String>
                <sys:String x:Key="StrBtnEnterFunctionInput">x</sys:String>
                <sys:String x:Key="StrCompressedDateTimeFormat">x</sys:String>
                <sys:String x:Key="StrDateFormat">x</sys:String>
                <sys:String x:Key="StrFullDateTimeFormat">x</sys:String>
                <sys:String x:Key="StrGbFunctionInputTitle">x</sys:String>
                <sys:String x:Key="StrNoteWarningInfo">x</sys:String>
                <sys:String x:Key="StrScriptRunningWithoutRunspace">x</sys:String>
                <sys:String x:Key="StrTimeFormat">x</sys:String>
            </Page.Resources>
            <Grid Name="GridOutputs">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="1*" />
                </Grid.RowDefinitions>
                <Grid Name="GridFunctionOp"
                      DataContext="{x:Null}"
                      Margin="{StaticResource StdMargin}">
                    <Grid.Style>
                        <Style TargetType="Grid">
                            <Setter Property="Visibility"
                                    Value="Visible" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Path=InputData}"
                                             Value="{x:Null}">
                                    <Setter Property="Visibility"
                                            Value="Collapsed" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Path=Note.NoteType}"
                                             Value="Warning">
                                    <Setter Property="Visibility"
                                            Value="Visible" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Path=Note.NoteType}"
                                             Value="Info">
                                    <Setter Property="Visibility"
                                            Value="Visible" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Grid.Style>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid Name="GridFunctionMenuItem">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <TextBlock Style="{StaticResource TblMenuTitleStyle}"
                                   HorizontalAlignment="Left"
                                   Text="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.MenuItem}" />
                        <Grid Grid.Row="1">
                            <Grid.Style>
                                <Style TargetType="Grid">
                                    <Setter Property="Visibility"
                                            Value="Collapsed" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.NoRunspace}"
                                                     Value="True">
                                            <Setter Property="Visibility"
                                                    Value="Visible" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Grid.Style>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Ellipse Fill="White"
                                     Height="{StaticResource IconSize}"
                                     UseLayoutRounding="True"
                                     Width="{StaticResource IconSize}" />
                            <Path Name="PathNoRunspaceInfo"
                                  Fill="LightBlue"
                                  Height="{StaticResource IconSize}"
                                  StrokeThickness="3"
                                  UseLayoutRounding="True"
                                  Width="{StaticResource IconSize}">
                                <Path.Data>
                                    <Geometry>M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z</Geometry>
                                </Path.Data>
                            </Path>
                            <TextBlock FontStyle="Italic"
                                       Grid.Column="1"
                                       Margin="{StaticResource StdMargin}"
                                       Text="{DynamicResource StrScriptRunningWithoutRunspace}"
                                       TextWrapping="Wrap" />
                        </Grid>
                    </Grid>
                    <Grid Name="GridFuntionDescription"
                          Grid.Column="1">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <TextBlock Margin="{StaticResource StdMargin}"
                                   Text="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.Synopsis}"
                                   TextWrapping="Wrap" />
                        <TextBlock Grid.Row="1"
                                   Margin="{StaticResource StdMargin}"
                                   Text="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.Description}"
                                   TextWrapping="Wrap" />
                    </Grid>
                    <Border Name="BrdFunctionValidDateNote"
                            BorderBrush="Blue"
                            Background="LightBlue"
                            BorderThickness="1"
                            Grid.ColumnSpan="2"
                            Grid.Row="2"
                            Margin="{StaticResource StdMargin}">
                        <Border.Style>
                            <Style TargetType="Border">
                                <Setter Property="Visibility"
                                        Value="Visible" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.ValidDateNote}"
                                                 Value="{x:Null}">
                                        <Setter Property="Visibility"
                                                Value="Collapsed" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Border.Style>
                        <Grid Name="GridValidDateNote">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Path Data="M13,9H11V7H13M13,17H11V11H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"
                                  Fill="LightBlue"
                                  Margin="{StaticResource StdMargin}"
                                  Stroke="Blue" />
                            <Label Content="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.ValidDateNote}"
                                   Grid.Column="1"
                                   Margin="{StaticResource StdMargin}"
                                   VerticalContentAlignment="Center" />
                        </Grid>
                    </Border>
                    <Border Name="BrdFunctionNote"
                            BorderThickness="1"
                            Grid.ColumnSpan="2"
                            Grid.Row="3"
                            Margin="{StaticResource StdMargin}">
                        <Border.Style>
                            <Style TargetType="Border">
                                <Setter Property="Visibility"
                                        Value="Visible" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.Note}"
                                                 Value="{x:Null}">
                                        <Setter Property="Visibility"
                                                Value="Collapsed" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.Note.NoteType}"
                                                 Value="Info">
                                        <Setter Property="BorderBrush"
                                                Value="Blue" />
                                        <Setter Property="Background"
                                                Value="LightBlue" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.Note.NoteType}"
                                                 Value="Warning">
                                        <Setter Property="BorderBrush"
                                                Value="Red" />
                                        <Setter Property="Background"
                                                Value="PeachPuff" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Border.Style>
                        <Grid Name="GridFunctionNote">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <Path Grid.RowSpan="2"
                                  Margin="{StaticResource StdMargin}">
                                <Path.Style>
                                    <Style TargetType="Path">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.Note.NoteType}"
                                                         Value="Info">
                                                <Setter Property="Data"
                                                        Value="M13,9H11V7H13M13,17H11V11H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z" />
                                                <Setter Property="Fill"
                                                        Value="LightBlue" />
                                                <Setter Property="Stroke"
                                                        Value="Blue" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.Note.NoteType}"
                                                         Value="Warning">
                                                <Setter Property="Data"
                                                        Value="M13 14H11V9H13M13 18H11V16H13M1 21H23L12 2L1 21Z" />
                                                <Setter Property="Fill"
                                                        Value="Yellow" />
                                                <Setter Property="Stroke"
                                                        Value="Red" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Path.Style>
                            </Path>
                            <Label Content="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.Note.NoteText}"
                                   Grid.Column="1"
                                   Margin="{StaticResource StdMargin}"
                                   VerticalContentAlignment="Center" />
                            <Label Content="{DynamicResource StrNoteWarningInfo}"
                                   FontStyle="Italic"
                                   Grid.Column="1"
                                   Grid.Row="1" />
                            <Button Name="BtnNoteWarningUnderstood"
                                    Content="{DynamicResource StrBtnNoteWarningUnderstood}"
                                    Grid.Column="2"
                                    Margin="{StaticResource StdMargin}"
                                    Padding="{StaticResource StdPadding}"
                                    VerticalAlignment="Center">
                                <Button.Style>
                                    <Style TargetType="Button">
                                        <Setter Property="Visibility"
                                                Value="Collapsed" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.Note.NoteType}"
                                                         Value="Warning">
                                                <Setter Property="Visibility"
                                                        Value="Visible" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>
                        </Grid>
                    </Border>
                    <GroupBox Name="GbFunctionInput"
                              Grid.ColumnSpan="2"
                              Grid.Row="4"
                              Margin="5,10,5,5"
                              MaxHeight="700">
                        <GroupBox.Style>
                            <Style TargetType="GroupBox">
                                <Setter Property="IsEnabled"
                                        Value="True" />
                                <Setter Property="Visibility"
                                        Value="Visible" />
                                <Style.Triggers>
                                    <MultiDataTrigger>
                                        <MultiDataTrigger.Conditions>
                                            <Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.Note.NoteType}"
                                                       Value="Warning" />
                                            <Condition Binding="{Binding ElementName=BrdFunctionNote, Path=Visibility}"
                                                       Value="Visible" />
                                        </MultiDataTrigger.Conditions>
                                        <Setter Property="IsEnabled"
                                                Value="False" />
                                    </MultiDataTrigger>
                                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.InputData}"
                                                 Value="{x:Null}">
                                        <Setter Property="Visibility"
                                                Value="Collapsed" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </GroupBox.Style>
                        <GroupBox.Header>
                            <TextBlock FontSize="16"
                                       FontWeight="Bold"
                                       Text="{DynamicResource StrGbFunctionInputTitle}" />
                        </GroupBox.Header>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="1*" />
                            </Grid.RowDefinitions>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock Name="TblUnfinishedInputCountTitle"
                                           Margin="{StaticResource StdMargin}" />
                                <TextBlock Name="TblUnfinishedInputCount"
                                           Grid.Column="1"
                                           Margin="{StaticResource StdMargin}">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="FontWeight"
                                                    Value="Bold" />
                                            <Setter Property="Foreground"
                                                    Value="Red" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}"
                                                             Value="0">
                                                    <Setter Property="Foreground"
                                                            Value="Green" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                            </Grid>
                            <ScrollViewer Grid.Row="1"
                                          Margin="{StaticResource StdMargin}"
                                          VerticalScrollBarVisibility="Auto">
                                <ItemsControl Name="IcFunctionInput"
                                              ItemsSource="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.InputData}"
                                              Margin="{StaticResource StdMargin}">
                                    <ItemsControl.Style>
                                        <Style TargetType="ItemsControl"
                                               BasedOn="{StaticResource IcBaseStyle}">
                                            <Setter Property="IsEnabled"
                                                    Value="True" />
                                            <Setter Property="Visibility"
                                                    Value="Visible" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=ItemsSource.Count}"
                                                             Value="0">
                                                    <Setter Property="Visibility"
                                                            Value="Collapsed" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=ItemsSource.Count}"
                                                             Value="{x:Null}">
                                                    <Setter Property="Visibility"
                                                            Value="Collapsed" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding ElementName=GridProgress, Path=Visibility}"
                                                             Value="Visible">
                                                    <Setter Property="IsEnabled"
                                                            Value="False" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </ItemsControl.Style>
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <Grid.Style>
                                                    <Style TargetType="Grid">
                                                        <Setter Property="Background"
                                                                Value="#0000" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsMouseOver}"
                                                                         Value="True">
                                                                <Setter Property="Background"
                                                                        Value="{StaticResource ScbPropListItemMouseOver}" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Grid.Style>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition />
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition />
                                                    <RowDefinition />
                                                </Grid.RowDefinitions>
                                                <TextBlock FontSize="13"
                                                           FontWeight="Bold"
                                                           Margin="{StaticResource StdMargin}"
                                                           Text="{Binding Path=Name, Mode=OneWay}" />
                                                <TextBlock FontSize="13"
                                                           Grid.Column="1"
                                                           Margin="{StaticResource StdMargin}"
                                                           Text="{Binding Path=InputDescription, Mode=OneWay}" />
                                                <Label Content="*"
                                                       Focusable="False"
                                                       FontSize="25"
                                                       Grid.Column="2"
                                                       IsTabStop="False">
                                                    <Label.Style>
                                                        <Style TargetType="Label">
                                                            <Setter Property="Foreground"
                                                                    Value="Red" />
                                                            <Setter Property="Padding"
                                                                    Value="0" />
                                                            <Setter Property="VerticalContentAlignment"
                                                                    Value="Center" />
                                                            <Setter Property="Visibility"
                                                                    Value="Visible" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.Mandatory}"
                                                                             Value="{x:Null}">
                                                                    <Setter Property="Visibility"
                                                                            Value="Collapsed" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Label.Style>
                                                </Label>
                                                <ContentControl Grid.ColumnSpan="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=ColumnDefinitions.Count}"
                                                                Grid.Row="1"
                                                                IsTabStop="False">
                                                    <ContentControl.Style>
                                                        <Style TargetType="ContentControl">
                                                            <Setter Property="ContentTemplate">
                                                                <Setter.Value>
                                                                    <DataTemplate>
                                                                        <TextBox Height="30"
                                                                                 Text="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.EnteredValue, Mode=TwoWay}"
                                                                                 Style="{StaticResource TbInputStyle}"
                                                                                 VerticalContentAlignment="Center" />
                                                                    </DataTemplate>
                                                                </Setter.Value>
                                                            </Setter>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.InputType}"
                                                                             Value="List">
                                                                    <Setter Property="ContentTemplate">
                                                                        <Setter.Value>
                                                                            <DataTemplate>
                                                                                <ComboBox Height="30"
                                                                                          ItemsSource="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.InputList}"
                                                                                          Margin="{StaticResource StdMargin}"
                                                                                          SelectedItem="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.EnteredValue, Mode=TwoWay}"
                                                                                          Style="{StaticResource CbInputStyle}"
                                                                                          VerticalContentAlignment="Center" />
                                                                            </DataTemplate>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.InputType}"
                                                                             Value="Bool">
                                                                    <Setter Property="ContentTemplate">
                                                                        <Setter.Value>
                                                                            <DataTemplate>
                                                                                <CheckBox Height="30"
                                                                                          IsChecked="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.EnteredValue, Mode=TwoWay}"
                                                                                          Margin="{StaticResource StdMargin}"
                                                                                          VerticalContentAlignment="Center" />
                                                                            </DataTemplate>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </ContentControl.Style>
                                                </ContentControl>
                                            </Grid>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </ScrollViewer>
                        </Grid>
                    </GroupBox>
                    <Button Name="BtnEnterFunctionInput"
                            Content="{DynamicResource StrBtnEnterFunctionInput}"
                            Grid.Column="1"
                            Grid.Row="5"
                            HorizontalAlignment="Right"
                            Margin="10"
                            Padding="7"
                            Visibility="{Binding ElementName=IcFunctionInput, Path=Visibility}" />
                </Grid>
                <ItemsControl Name="IcOutputObjects"
                              Grid.Row="1"
                              VirtualizingPanel.IsVirtualizing="True"
                              VirtualizingPanel.VirtualizationMode="Recycling">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <UniformGrid Columns="1" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="1*" />
                                </Grid.RowDefinitions>
                                <Grid Name="GridOutputTitle">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock FontSize="20"
                                               Margin="{StaticResource StdMargin}"
                                               Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblOutputTitle}"
                                               VerticalAlignment="Bottom">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding ElementName=IcOutputObjects, Path=ActualWidth, Converter={StaticResource WidthLessThan}, ConverterParameter=532}"
                                                                 Value="True">
                                                        <Setter Property="Visibility"
                                                                Value="Collapsed" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                    <TextBlock FontSize="20"
                                               FontWeight="Bold"
                                               Grid.Column="1"
                                               Margin="{StaticResource StdMargin}"
                                               VerticalAlignment="Bottom"
                                               Text="{Binding Path=Script.Name}"
                                               ToolTip="{Binding Path=Script.Synopsis}" />
                                    <TextBlock FontSize="20"
                                               Grid.Column="2"
                                               Margin="{StaticResource StdMargin}"
                                               TextTrimming="CharacterEllipsis"
                                               VerticalAlignment="Bottom">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Visibility"
                                                        Value="Visible" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding Path=Item}"
                                                                 Value="{x:Null}">
                                                        <Setter Property="Visibility"
                                                                Value="Collapsed" />
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding Path=Script.SearchedItemRequest}"
                                                                 Value="None">
                                                        <Setter Property="Visibility"
                                                                Value="Collapsed" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                        <Run Text="'" />
                                        <Run Text="{Binding Path=Item.Name}" />
                                        <Run Text="'" />
                                    </TextBlock>
                                    <Label Content="{Binding Path=Finished}"
                                           ContentStringFormat="{DynamicResource StrFullDateTimeFormat}"
                                           FontSize="20"
                                           Grid.Column="3"
                                           Margin="0"
                                           VerticalContentAlignment="Bottom" />
                                    <Grid Grid.Column="5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition />
                                            <RowDefinition />
                                        </Grid.RowDefinitions>
                                        <TextBlock FontSize="14"
                                                   FontWeight="Bold"
                                                   Grid.ColumnSpan="2"
                                                   Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblCopyOutput}" />
                                        <Button Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnCopyOutputData}"
                                                Style="{StaticResource BtnCopyOutputDataStyle}" />
                                        <Button Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnCopyOutputObject}"
                                                Grid.Column="1"
                                                Style="{StaticResource BtnCopyOutputObjectStyle}" />
                                    </Grid>
                                </Grid>
                                <Border BorderBrush="Red"
                                        BorderThickness="4,0"
                                        Grid.Row="1">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="Visibility"
                                                    Value="Visible" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Path=Error.Count}"
                                                             Value="0">
                                                    <Setter Property="Visibility"
                                                            Value="Collapsed" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Path=Error}"
                                                             Value="{x:Null}">
                                                    <Setter Property="Visibility"
                                                            Value="Collapsed" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition />
                                        </Grid.RowDefinitions>
                                        <TextBlock Name="TblOutputErrorTitle"
                                                   Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblOutputErrorsTitle}">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock"
                                                       BasedOn="{StaticResource PropTitleStyle}">
                                                    <Setter Property="Visibility"
                                                            Value="Visible" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Path=Error}"
                                                                     Value="{x:Null}">
                                                            <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <ListView Grid.Row="1"
                                                  ItemsSource="{Binding Path=Error}"
                                                  Margin="{StaticResource StdMargin}">
                                            <ListView.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Path=Exception.Message}" />
                                                </DataTemplate>
                                            </ListView.ItemTemplate>
                                        </ListView>
                                    </Grid>
                                </Border>
                                <!-- Data output from function -->
                                <Grid Grid.Row="2">
                                    <ScrollViewer Name="ScvOutputData"
                                                  Grid.Row="2"
                                                  HorizontalScrollBarVisibility="Auto"
                                                  VerticalScrollBarVisibility="Auto">
                                        <ContentControl>
                                            <ContentControl.Style>
                                                <Style TargetType="ContentControl">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.OutputType}"
                                                                     Value="String">
                                                            <Setter Property="Template">
                                                                <Setter.Value>
                                                                    <ControlTemplate>
                                                                        <TextBlock Margin="{StaticResource StdMargin}"
                                                                                   Style="{StaticResource TblBaseStyle}"
                                                                                   Text="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.Data}" />
                                                                    </ControlTemplate>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.OutputType}"
                                                                     Value="ObjectList">
                                                            <Setter Property="Template">
                                                                <Setter.Value>
                                                                    <ControlTemplate>
                                                                        <DataGrid AlternationCount="2"
                                                                                  AutoGenerateColumns="True"
                                                                                  HeadersVisibility="Column"
                                                                                  IsReadOnly="True"
                                                                                  ItemsSource="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.Data}">
                                                                            <DataGrid.CellStyle>
                                                                                <Style TargetType="{x:Type DataGridCell}">
                                                                                    <Setter Property="Padding"
                                                                                            Value="5" />
                                                                                </Style>
                                                                            </DataGrid.CellStyle>
                                                                            <DataGrid.RowStyle>
                                                                                <Style TargetType="{x:Type DataGridRow}"
                                                                                       BasedOn="{StaticResource DgrFuncOutputStyle}" />
                                                                            </DataGrid.RowStyle>
                                                                        </DataGrid>
                                                                    </ControlTemplate>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.OutputType}"
                                                                     Value="List">
                                                            <Setter Property="Template">
                                                                <Setter.Value>
                                                                    <ControlTemplate>
                                                                        <ListBox AlternationCount="2"
                                                                                 ItemsSource="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.Data}">
                                                                            <ListBox.Resources>
                                                                                <Style TargetType="ListBoxItem">
                                                                                    <Style.Triggers>
                                                                                        <DataTrigger Binding="{Binding Path=Type}"
                                                                                                     Value="Hyperlink">
                                                                                            <Setter Property="Template">
                                                                                                <Setter.Value>
                                                                                                    <ControlTemplate>
                                                                                                        <TextBlock Style="{StaticResource TblHlStyle}"
                                                                                                                   Text="{Binding Path=Text}" />
                                                                                                    </ControlTemplate>
                                                                                                </Setter.Value>
                                                                                            </Setter>
                                                                                        </DataTrigger>
                                                                                    </Style.Triggers>
                                                                                </Style>
                                                                            </ListBox.Resources>
                                                                        </ListBox>
                                                                    </ControlTemplate>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.Data}"
                                                                     Value="{x:Null}">
                                                            <Setter Property="Template">
                                                                <Setter.Value>
                                                                    <ControlTemplate>
                                                                        <TextBlock Margin="{StaticResource StdMargin}"
                                                                                   Style="{StaticResource TblBaseStyle}"
                                                                                   Text="{Binding ElementName=Window, Path=DataContext.MsgTable.StrNoScriptOutput}" />
                                                                    </ControlTemplate>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </ContentControl.Style>
                                        </ContentControl>
                                    </ScrollViewer>
                                </Grid>
                            </Grid>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </Grid>
        </Page>
    </Window.Resources>
    <Grid Name="GridMain">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="1*" />
        </Grid.RowDefinitions>
        <Grid Name="GridSearch">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="1*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <TextBlock Name="TblSearchHint"
                       FontSize="15"
                       FontWeight="Bold"
                       Grid.ColumnSpan="2"
                       Margin="{StaticResource StdMargin}"
                       Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblSearchHint}">
                <TextBlock.Style>
                    <Style TargetType="TextBlock">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding ElementName=TbSearch, Path=IsKeyboardFocused}"
                                         Value="True">
                                <Setter Property="FontSize"
                                        Value="12" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </TextBlock.Style>
            </TextBlock>
            <TextBox Name="TbSearch"
                     AcceptsReturn="False"
                     Grid.Row="1"
                     IsEnabled="True"
                     Padding="5"
                     Text="{x:Static sys:String.Empty}"
                     VerticalContentAlignment="Center">
                <TextBox.Style>
                    <Style TargetType="TextBox">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding ElementName=PbSearchProgress, Path=Visibility}"
                                         Value="Visible">
                                <Setter Property="IsEnabled"
                                        Value="False" />
                            </DataTrigger>
                            <DataTrigger Binding="{Binding ElementName=GridProgress, Path=Visibility}"
                                         Value="Visible">
                                <Setter Property="IsEnabled"
                                        Value="False" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </TextBox.Style>
            </TextBox>
            <Grid Name="GridSearchProgress"
                  Grid.Row="2">
                <ProgressBar Name="PbSearchProgress"
                             Height="8"
                             IsIndeterminate="True" />
                <Grid HorizontalAlignment="Center">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <TextBlock Name="TbIdentifiedSearchPatternTitle"
                               Text="{Binding ElementName=Window, Path=DataContext.MsgTable.StrTextIdentifiedAs}" />
                    <TextBlock Name="TbIdentifiedSearchPattern"
                               FontWeight="Bold"
                               Grid.Column="1"
                               Margin="5,0" />
                </Grid>
            </Grid>
            <Button Name="BtnSearch"
                    Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnSearch}"
                    Grid.Column="1"
                    Grid.Row="1"
                    IsEnabled="{Binding ElementName=TbSearch, Path=IsEnabled}"
                    Margin="0"
                    Style="{StaticResource BtnBaseStyle}" />
            <Border Name="BrdAsterixWarning"
                    BorderBrush="Red"
                    BorderThickness="5,0,5,5"
                    Grid.ColumnSpan="2"
                    Grid.Row="2">
                <TextBlock Name="TblAsterixWarning"
                           FontSize="18"
                           FontWeight="Bold" />
            </Border>
        </Grid>
        <Popup Name="PopupMenu"
               Placement="Bottom"
               PlacementTarget="{Binding ElementName=GridSearch}"
               Width="{Binding ElementName=GridMain, Path=ActualWidth}">
            <Popup.Resources>
                <Style TargetType="TextBlock">
                    <Setter Property="VerticalAlignment"
                            Value="Center" />
                </Style>
            </Popup.Resources>
            <DataGrid Name="DgSearchResults"
                      AutoGenerateColumns="False"
                      HeadersVisibility="All"
                      IsReadOnly="True"
                      Margin="0"
                      MaxHeight="300"
                      SelectedItem="{Binding Path=SelectedUnit, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                      SelectionMode="Single"
                      SelectionUnit="FullRow">
                <DataGrid.Style>
                    <Style TargetType="DataGrid"
                           BasedOn="{StaticResource DgBaseStyle}">
                        <Setter Property="Visibility"
                                Value="Visible" />
                        <Style.Triggers>
                            <Trigger Property="HasItems"
                                     Value="False">
                                <Setter Property="Visibility"
                                        Value="Collapsed" />
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </DataGrid.Style>
                <DataGrid.Columns>
                    <DataGridTextColumn Binding="{Binding Path=Name}">
                        <DataGridTextColumn.Header>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Name="DgSearchResultsColRunTitle"
                                           Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentDgSearchResultsColNameTitle}" />
                                <TextBlock Name="DgSearchResultsColRunCount" />
                                <TextBlock Name="DgSearchResultsColRunEnd">
                                    <Run Text=" " />
                                    <Run Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentDgSearchResultsColNameTitle}" />
                                </TextBlock>
                            </StackPanel>
                        </DataGridTextColumn.Header>
                    </DataGridTextColumn>
                    <DataGridTextColumn Binding="{Binding Path=ObjectClass}"
                                        Header="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentDgSearchResultsColObjClass}" />
                </DataGrid.Columns>
            </DataGrid>
        </Popup>
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="1*" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="1*" />
            </Grid.RowDefinitions>
            <Grid Name="GridProgress"
                  Grid.Column="2"
                  Grid.ColumnSpan="2"
                  Visibility="Hidden">
                <ProgressBar Name="PbProgress"
                             IsIndeterminate="True" />
                <TextBox Name="TbProgress"
                         Background="Transparent"
                         BorderBrush="Transparent"
                         BorderThickness="0"
                         FontSize="15"
                         HorizontalAlignment="Center"
                         Text="{Binding ElementName=GridFunctionOp, Path=DataContext.Name, Mode=OneWay}"
                         VerticalAlignment="Center">
                    <TextBox.Effect>
                        <DropShadowEffect Color="Black"
                                          Direction="330"
                                          Opacity="0.1"
                                          ShadowDepth="4"
                                          BlurRadius="4" />
                    </TextBox.Effect>
                </TextBox>
            </Grid>
            <Button Name="BtnHideMenuTexts"
                    BorderThickness="0"
                    Content="&lt;"
                    Grid.Column="0"
                    Grid.RowSpan="2"
                    VerticalAlignment="Stretch">
                <Button.Style>
                    <Style TargetType="Button"
                           BasedOn="{StaticResource {x:Static ToolBar.ButtonStyleKey}}">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=IsMouseOver}"
                                         Value="True">
                                <Setter Property="Background"
                                        Value="#99A9D8FF" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Button.Style>
            </Button>
            <Grid Name="GridMenus"
                  Grid.Column="1"
                  Grid.RowSpan="2">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Border Name="BrdObjMenu"
                        Style="{StaticResource MenuTitleStyle}">
                    <Grid Name="GridObjMenu">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="24" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition />
                        </Grid.RowDefinitions>
                        <Grid Visibility="{DynamicResource MenuTextVisibility}">
                            <Grid.Style>
                                <Style TargetType="Grid">
                                    <Setter Property="Grid.RowSpan"
                                            Value="1" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ElementName=TblObjName, Path=Visibility}"
                                                     Value="Collapsed">
                                            <Setter Property="Grid.RowSpan"
                                                    Value="2" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Grid.Style>
                            <TextBlock Name="TblObjMenuTitle"
                                       Style="{StaticResource TblMenuTitleStyle}"
                                       Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblObjMenuTitle}"
                                       VerticalAlignment="Center" />
                        </Grid>
                        <TextBlock Name="TblObjName"
                                   FontSize="13"
                                   Grid.Row="1"
                                   Text="{Binding Path=SearchedItem.Name}"
                                   TextWrapping="Wrap">
                            <TextBlock.Style>
                                <Style TargetType="TextBlock"
                                       BasedOn="{StaticResource TblMenuTitleStyle}">
                                    <Setter Property="Visibility"
                                            Value="{DynamicResource MenuTextVisibility}" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}"
                                                     Value="{x:Static sys:String.Empty}">
                                            <Setter Property="Visibility"
                                                    Value="Collapsed" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>
                        <StackPanel Name="SpComputerOnlineStatus"
                                    Grid.Row="2"
                                    Orientation="Horizontal">
                            <StackPanel.Style>
                                <Style TargetType="StackPanel">
                                    <Setter Property="Visibility"
                                            Value="Collapsed" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Path=SearchedItem.ObjectClass}"
                                                     Value="computer">
                                            <Setter Property="Visibility"
                                                    Value="Visible" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </StackPanel.Style>
                            <TextBlock Name="TblComputerOnline"
                                       FontSize="13"
                                       Grid.Row="2"
                                       Text="{Binding Path=MsgTable.StrComputerOnline}"
                                       VerticalAlignment="Center"
                                       Visibility="{DynamicResource MenuTextVisibility}" />
                            <Border Name="BrdComputerOnlineStatus">
                                <Border.Style>
                                    <Style TargetType="Border">
                                        <Setter Property="Background"
                                                Value="Transparent" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ElementName=LblComputerOnlineStatus, Path=Content, NotifyOnSourceUpdated=True}"
                                                         Value="Online">
                                                <Setter Property="Background"
                                                        Value="LightGreen" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding ElementName=LblComputerOnlineStatus, Path=Content, NotifyOnSourceUpdated=True}"
                                                         Value="Offline">
                                                <Setter Property="Background"
                                                        Value="Coral" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>
                                <Label Name="LblComputerOnlineStatus"
                                       VerticalContentAlignment="Center" />
                            </Border>
                        </StackPanel>
                        <Menu Name="MenuObject"
                              Grid.Row="3"
                              IsEnabled="False"
                              Style="{StaticResource MenuBaseStyle}"
                              ToolTip="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTTMiCloseObj}">
                            <MenuItem Name="MiCloseObj"
                                      Style="{StaticResource MiTopLevelStyle}">
                                <MenuItem.Header>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="{StaticResource MiIconWidth}" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Path Data="{StaticResource ObjCloseIcon}"
                                              Style="{StaticResource PathObjectMenuIconStyle}" />
                                        <TextBlock Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblMiCloseObj}"
                                                   Style="{StaticResource TblObjectMenuStyle}" />
                                    </Grid>
                                </MenuItem.Header>
                            </MenuItem>
                            <MenuItem Name="MiObjDetailed">
                                <MenuItem.Style>
                                    <Style TargetType="MenuItem"
                                           BasedOn="{StaticResource MiTopLevelStyle}">
                                        <Setter Property="ToolTip"
                                                Value="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTTMiObjDetailedShow}" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ElementName=IcObjectDetailed, Path=Visibility}"
                                                         Value="Visible">
                                                <Setter Property="ToolTip"
                                                        Value="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTTMiObjDetailedHide}" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </MenuItem.Style>
                                <MenuItem.Header>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="{StaticResource MiIconWidth}" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Path Data="{StaticResource ObjDetailedInfoIcon}">
                                            <Path.Style>
                                                <Style TargetType="Path"
                                                       BasedOn="{StaticResource PathObjectMenuIconStyle}">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding ElementName=IcObjectDetailed, Path=Visibility}"
                                                                     Value="Visible">
                                                            <Setter Property="Fill"
                                                                    Value="Red" />
                                                            <Setter Property="RenderTransform"
                                                                    Value="{StaticResource TgMirrored}" />
                                                            <Setter Property="Stroke"
                                                                    Value="Red" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Path.Style>
                                        </Path>
                                        <TextBlock>
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock"
                                                       BasedOn="{StaticResource TblObjectMenuStyle}">
                                                    <Setter Property="Text"
                                                            Value="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblMiObjDetailed}" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding ElementName=IcObjectDetailed, Path=Visibility}"
                                                                     Value="Visible">
                                                            <Setter Property="Text"
                                                                    Value="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentMiObjDetailedHide}" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </Grid>
                                </MenuItem.Header>
                            </MenuItem>
                            <MenuItem Name="MiCopyObj">
                                <MenuItem.Style>
                                    <Style TargetType="MenuItem"
                                           BasedOn="{StaticResource MiTopLevelStyle}">
                                        <Setter Property="ToolTip"
                                                Value="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTTMiCopyObjSelected}" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ElementName=IcObjectDetailed, Path=Visibility}"
                                                         Value="Visible">
                                                <Setter Property="ToolTip"
                                                        Value="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTTMiCopyObj}" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </MenuItem.Style>
                                <MenuItem.Header>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="{StaticResource MiIconWidth}" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Path Data="{StaticResource ObjCopyInfoIcon}"
                                              Style="{StaticResource PathObjectMenuIconStyle}" />
                                        <TextBlock>
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock"
                                                       BasedOn="{StaticResource TblObjectMenuStyle}">
                                                    <Setter Property="Text"
                                                            Value="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblMiCopyObj}" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding ElementName=IcPropsList, Path=Visibility}"
                                                                     Value="Visible">
                                                            <Setter Property="Text"
                                                                    Value="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblMiCopyObjSelected}" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </Grid>
                                </MenuItem.Header>
                            </MenuItem>
                            <MenuItem Name="MiShowHideObj"
                                      Style="{StaticResource MiTopLevelStyle}"
                                      ToolTip="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTTTblContentTblMiShowHideObj}">
                                <MenuItem.Header>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="{StaticResource MiIconWidth}" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Path Data="{StaticResource ArrowRightIcon}">
                                            <Path.Style>
                                                <Style TargetType="Path"
                                                       BasedOn="{StaticResource PathObjectMenuIconStyle}">
                                                    <Setter Property="RenderTransform"
                                                            Value="{StaticResource TgOriginal}" />
                                                    <Style.Triggers>
                                                        <MultiDataTrigger>
                                                            <MultiDataTrigger.Conditions>
                                                                <Condition Binding="{Binding ElementName=GridObj, Path=Visibility}"
                                                                           Value="Collapsed" />
                                                                <Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=MenuItem}, Path=IsEnabled}"
                                                                           Value="True" />
                                                            </MultiDataTrigger.Conditions>
                                                            <Setter Property="RenderTransform"
                                                                    Value="{StaticResource TgMirrored}" />
                                                            <Setter Property="Stroke"
                                                                    Value="Red" />
                                                        </MultiDataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Path.Style>
                                        </Path>
                                        <TextBlock>
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock"
                                                       BasedOn="{StaticResource TblObjectMenuStyle}">
                                                    <Setter Property="Text"
                                                            Value="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblMiHideObj}" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding ElementName=GridObj, Path=Visibility}"
                                                                     Value="Collapsed">
                                                            <Setter Property="Text"
                                                                    Value="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblMiShowObj}" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </Grid>
                                </MenuItem.Header>
                            </MenuItem>
                            <MenuItem Name="MiGetSysManInfo"
                                      Style="{StaticResource MiTopLevelStyle}"
                                      ToolTip="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblMiGetSysManInfoTt}"
                                      Visibility="Collapsed">
                                <MenuItem.Header>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="{StaticResource MiIconWidth}" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Path Data="{StaticResource GetSysManInfo}"
                                              Style="{StaticResource PathObjectMenuIconStyle}" />
                                        <TextBlock Style="{StaticResource TblObjectMenuStyle}"
                                                   Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblMiGetSysManInfo}" />
                                    </Grid>
                                </MenuItem.Header>
                            </MenuItem>
                        </Menu>
                    </Grid>
                </Border>
                <Border Name="BrdOutputViewMenu"
                        Grid.Row="1"
                        Margin="0,10"
                        Style="{StaticResource MenuTitleStyle}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition />
                        </Grid.RowDefinitions>
                        <TextBlock Name="TblOutputMenuTitle"
                                   Style="{StaticResource TblMenuTitleStyle}"
                                   Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblOutputMenuTitle}" />
                        <Menu Name="OutputMenu"
                              Grid.Row="1">
                            <Menu.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <StackPanel />
                                </ItemsPanelTemplate>
                            </Menu.ItemsPanel>
                            <MenuItem Name="MiShowHideOutputView"
                                      ToolTip="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTTTblContentTblMiShowHideOutputView}">
                                <MenuItem.Style>
                                    <Style TargetType="MenuItem"
                                           BasedOn="{StaticResource MiTopLevelStyle}">
                                        <Setter Property="IsEnabled"
                                                Value="True" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ElementName=IcOutputObjects, Path=ItemsSource.Count}"
                                                         Value="0">
                                                <Setter Property="IsEnabled"
                                                        Value="False" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </MenuItem.Style>
                                <MenuItem.Header>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Path Data="{StaticResource OutputIcon}">
                                            <Path.Style>
                                                <Style TargetType="Path"
                                                       BasedOn="{StaticResource PathMenuIconStyle}">
                                                    <Setter Property="RenderTransform"
                                                            Value="{StaticResource TgOriginal}" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=MenuItem}, Path=IsEnabled}"
                                                                     Value="False">
                                                            <Setter Property="Stroke"
                                                                    Value="LightGray" />
                                                        </DataTrigger>
                                                        <MultiDataTrigger>
                                                            <MultiDataTrigger.Conditions>
                                                                <Condition Binding="{Binding ElementName=IcOutputObjects, Path=ItemsSource.Count}"
                                                                           Value="1" />
                                                                <Condition Binding="{Binding ElementName=IcOutputObjects, Path=IsVisible}"
                                                                           Value="False" />
                                                            </MultiDataTrigger.Conditions>
                                                            <Setter Property="RenderTransform"
                                                                    Value="{StaticResource TgMirrored}" />
                                                            <Setter Property="Stroke"
                                                                    Value="Red" />
                                                        </MultiDataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Path.Style>
                                        </Path>
                                        <TextBlock>
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock"
                                                       BasedOn="{StaticResource TblFunctionMenuStyle}">
                                                    <Setter Property="Foreground"
                                                            Value="{StaticResource DefaultFontColor}" />
                                                    <Setter Property="Text"
                                                            Value="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentMiShowHideOutputViewNoOutput}" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=MenuItem}, Path=IsEnabled}"
                                                                     Value="False">
                                                            <Setter Property="Foreground"
                                                                    Value="LightGray" />
                                                        </DataTrigger>
                                                        <MultiDataTrigger>
                                                            <MultiDataTrigger.Conditions>
                                                                <Condition Binding="{Binding ElementName=IcOutputObjects, Path=ItemsSource.Count}"
                                                                           Value="1" />
                                                                <Condition Binding="{Binding ElementName=FrameTool, Path=Content.Name}"
                                                                           Value="MainOutput" />
                                                            </MultiDataTrigger.Conditions>
                                                            <Setter Property="Text"
                                                                    Value="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentMiShowHideOutputViewHide}" />
                                                        </MultiDataTrigger>
                                                        <MultiDataTrigger>
                                                            <MultiDataTrigger.Conditions>
                                                                <Condition Binding="{Binding ElementName=IcOutputObjects, Path=ItemsSource.Count}"
                                                                           Value="1" />
                                                                <Condition Binding="{Binding ElementName=IcOutputObjects, Path=IsVisible}"
                                                                           Value="False" />
                                                            </MultiDataTrigger.Conditions>
                                                            <Setter Property="Text"
                                                                    Value="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentMiShowHideOutputViewShow}" />
                                                        </MultiDataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </Grid>
                                </MenuItem.Header>
                            </MenuItem>
                            <MenuItem Name="MiOutputHistory">
                                <MenuItem.Style>
                                    <Style TargetType="MenuItem"
                                           BasedOn="{StaticResource MiTopLevelStyle}">
                                        <Setter Property="IsEnabled"
                                                Value="True" />
                                        <Setter Property="ItemsSource"
                                                Value="{Binding Source={StaticResource CvsMiOutputHistory}}" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=ItemsSource.Count}"
                                                         Value="0">
                                                <Setter Property="IsEnabled"
                                                        Value="False" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </MenuItem.Style>
                                <MenuItem.Header>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Path Data="{StaticResource HistoryIcon}">
                                            <Path.Style>
                                                <Style TargetType="Path"
                                                       BasedOn="{StaticResource PathMenuIconStyle}">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=MenuItem}, Path=IsEnabled}"
                                                                     Value="False">
                                                            <Setter Property="Stroke"
                                                                    Value="LightGray" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Path.Style>
                                        </Path>
                                        <TextBlock Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblMiOutputHistoryText}">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock"
                                                       BasedOn="{StaticResource TblFunctionMenuStyle}">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=MenuItem}, Path=IsEnabled}"
                                                                     Value="False">
                                                            <Setter Property="Foreground"
                                                                    Value="LightGray" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </Grid>
                                </MenuItem.Header>
                                <MenuItem.ItemContainerStyle>
                                    <Style TargetType="MenuItem">
                                        <EventSetter Event="Click" />
                                    </Style>
                                </MenuItem.ItemContainerStyle>
                                <MenuItem.ItemTemplate>
                                    <DataTemplate>
                                        <Border BorderBrush="Red"
                                                BorderThickness="5,0,0,0">
                                            <Border.Style>
                                                <Style TargetType="Border">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Path=Error.Count}"
                                                                     Value="0">
                                                            <Setter Property="BorderBrush"
                                                                    Value="LightGreen" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Border.Style>
                                            <Grid>
                                                <Grid.Resources>
                                                    <Style TargetType="TextBlock"
                                                           x:Key="TblMenuItemstyle">
                                                        <Setter Property="FontSize"
                                                                Value="12" />
                                                        <Setter Property="FontWeight"
                                                                Value="Normal" />
                                                        <Setter Property="HorizontalAlignment"
                                                                Value="Stretch" />
                                                        <Setter Property="Margin"
                                                                Value="{StaticResource StdMargin}" />
                                                    </Style>
                                                </Grid.Resources>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition />
                                                    <ColumnDefinition />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                <Label Content="{Binding Path=Finished}"
                                                       ContentStringFormat="{DynamicResource StrTimeFormat}"
                                                       FontSize="12"
                                                       HorizontalAlignment="Right" />
                                                <TextBlock FontSize="12"
                                                           FontWeight="Bold"
                                                           Grid.Column="1"
                                                           Style="{StaticResource TblMenuItemstyle}"
                                                           Text="{Binding Path=Script.Name}"
                                                           ToolTip="{Binding Path=Script.Description}" />
                                                <TextBlock Grid.Column="2"
                                                           Style="{StaticResource TblMenuItemstyle}"
                                                           Text="{Binding Path=Item.Name}"
                                                           TextWrapping="NoWrap" />
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </MenuItem.ItemTemplate>
                            </MenuItem>
                        </Menu>
                    </Grid>
                </Border>
                <Menu Name="FunctionsMenu"
                      Grid.Row="3"
                      Style="{StaticResource MenuBaseStyle}">
                    <MenuItem Name="MiUserFunctions"
                              ItemsSource="{Binding Source={StaticResource CvsMiUserFunctions}}"
                              Style="{StaticResource MiTopLevelStyle}">
                        <MenuItem.Header>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="{StaticResource MiIconWidth}" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Path Data="{StaticResource UserIcon}"
                                      Style="{StaticResource PathMenuIconStyle}" />
                                <TextBlock Style="{StaticResource TblFunctionMenuStyle}"
                                           Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblMiUserFunctionsText}" />
                            </Grid>
                        </MenuItem.Header>
                        <MenuItem.ItemContainerStyle>
                            <Style TargetType="MenuItem"
                                   BasedOn="{StaticResource MiSubLevelFunctionsStyle}">
                                <Style.Triggers>
                                    <MultiDataTrigger>
                                        <MultiDataTrigger.Conditions>
                                            <Condition Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=DataContext.SearchedItemRequest}"
                                                       Value="Required" />
                                            <Condition Binding="{Binding ElementName=Window, Path=DataContext.SearchedItem.ObjectClass}"
                                                       Value="user" />
                                        </MultiDataTrigger.Conditions>
                                        <Setter Property="Visibility"
                                                Value="Visible" />
                                    </MultiDataTrigger>
                                </Style.Triggers>
                            </Style>
                        </MenuItem.ItemContainerStyle>
                    </MenuItem>
                    <MenuItem Name="MiDirectoryInfoFunctions"
                              ItemsSource="{Binding Source={StaticResource CvsMiDirectoryInfoFunctions}}"
                              Style="{StaticResource MiTopLevelStyle}">
                        <MenuItem.Header>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="{StaticResource MiIconWidth}" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Path Data="{StaticResource FolderIcon}"
                                      Style="{StaticResource PathMenuIconStyle}" />
                                <TextBlock Style="{StaticResource TblFunctionMenuStyle}"
                                           Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblMiDirectoryInfoFunctionsText}" />
                            </Grid>
                        </MenuItem.Header>
                        <MenuItem.ItemContainerStyle>
                            <Style TargetType="MenuItem"
                                   BasedOn="{StaticResource MiSubLevelFunctionsStyle}">
                                <Style.Triggers>
                                    <MultiDataTrigger>
                                        <MultiDataTrigger.Conditions>
                                            <Condition Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=DataContext.SearchedItemRequest}"
                                                       Value="Required" />
                                            <Condition Binding="{Binding ElementName=Window, Path=DataContext.SearchedItem.ObjectClass}"
                                                       Value="DirectoryInfo" />
                                        </MultiDataTrigger.Conditions>
                                        <Setter Property="Visibility"
                                                Value="Visible" />
                                    </MultiDataTrigger>
                                </Style.Triggers>
                            </Style>
                        </MenuItem.ItemContainerStyle>
                    </MenuItem>
                    <MenuItem Name="MiFileInfoFunctions"
                              ItemsSource="{Binding Source={StaticResource CvsMiFileInfoFunctions}}"
                              Style="{StaticResource MiTopLevelStyle}">
                        <MenuItem.Header>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="{StaticResource MiIconWidth}" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Path Data="{StaticResource FileIcon}"
                                      Style="{StaticResource PathMenuIconStyle}" />
                                <TextBlock Style="{StaticResource TblFunctionMenuStyle}"
                                           Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblFileInfoText}" />
                            </Grid>
                        </MenuItem.Header>
                        <MenuItem.ItemContainerStyle>
                            <Style TargetType="MenuItem"
                                   BasedOn="{StaticResource MiSubLevelFunctionsStyle}">
                                <Style.Triggers>
                                    <MultiDataTrigger>
                                        <MultiDataTrigger.Conditions>
                                            <Condition Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=DataContext.SearchedItemRequest}"
                                                       Value="Required" />
                                            <Condition Binding="{Binding ElementName=Window, Path=DataContext.SearchedItem.ObjectClass}"
                                                       Value="FileInfo" />
                                        </MultiDataTrigger.Conditions>
                                        <Setter Property="Visibility"
                                                Value="Visible" />
                                    </MultiDataTrigger>
                                </Style.Triggers>
                            </Style>
                        </MenuItem.ItemContainerStyle>
                    </MenuItem>
                    <MenuItem Name="MiComputerFunctions"
                              ItemsSource="{Binding Source={StaticResource CvsMiComputerFunctions}}"
                              Style="{StaticResource MiTopLevelStyle}">
                        <MenuItem.Header>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="{StaticResource MiIconWidth}" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Path Data="{StaticResource ComputerIcon}"
                                      Style="{StaticResource PathMenuIconStyle}" />
                                <TextBlock Style="{StaticResource TblFunctionMenuStyle}"
                                           Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblMiComputerFunctionsText}" />
                            </Grid>
                        </MenuItem.Header>
                        <MenuItem.ItemContainerStyle>
                            <Style TargetType="MenuItem"
                                   BasedOn="{StaticResource MiSubLevelFunctionsStyle}">
                                <Style.Triggers>
                                    <MultiDataTrigger>
                                        <MultiDataTrigger.Conditions>
                                            <Condition Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=DataContext.SearchedItemRequest}"
                                                       Value="Required" />
                                            <Condition Binding="{Binding ElementName=Window, Path=DataContext.SearchedItem.ObjectClass}"
                                                       Value="computer" />
                                        </MultiDataTrigger.Conditions>
                                        <Setter Property="Visibility"
                                                Value="Visible" />
                                    </MultiDataTrigger>
                                </Style.Triggers>
                            </Style>
                        </MenuItem.ItemContainerStyle>
                    </MenuItem>
                    <MenuItem Name="MiGroupFunctions"
                              ItemsSource="{Binding Source={StaticResource CvsMiGroupFunctions}}"
                              Style="{StaticResource MiTopLevelStyle}">
                        <MenuItem.Header>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="{StaticResource MiIconWidth}" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Path Data="{StaticResource GroupIcon}"
                                      Style="{StaticResource PathMenuIconStyle}" />
                                <TextBlock Style="{StaticResource TblFunctionMenuStyle}"
                                           Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblMiGroupFunctionsText}" />
                            </Grid>
                        </MenuItem.Header>
                        <MenuItem.ItemContainerStyle>
                            <Style TargetType="MenuItem"
                                   BasedOn="{StaticResource MiSubLevelFunctionsStyle}">
                                <Style.Triggers>
                                    <MultiDataTrigger>
                                        <MultiDataTrigger.Conditions>
                                            <Condition Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=DataContext.SearchedItemRequest}"
                                                       Value="Required" />
                                            <Condition Binding="{Binding ElementName=Window, Path=DataContext.SearchedItem.ObjectClass}"
                                                       Value="group" />
                                        </MultiDataTrigger.Conditions>
                                        <Setter Property="Visibility"
                                                Value="Visible" />
                                    </MultiDataTrigger>
                                </Style.Triggers>
                            </Style>
                        </MenuItem.ItemContainerStyle>
                    </MenuItem>
                    <MenuItem Name="MiPrintQueueFunctions"
                              ItemsSource="{Binding Source={StaticResource CvsMiPrintQueueFunctions}}"
                              Style="{StaticResource MiTopLevelStyle}">
                        <MenuItem.Header>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="{StaticResource MiIconWidth}" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Path Data="{StaticResource PrinterIcon}"
                                      Style="{StaticResource PathMenuIconStyle}" />
                                <TextBlock Style="{StaticResource TblFunctionMenuStyle}"
                                           Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblMiPrintQueueFunctionsText}" />
                            </Grid>
                        </MenuItem.Header>
                        <MenuItem.ItemContainerStyle>
                            <Style TargetType="MenuItem"
                                   BasedOn="{StaticResource MiSubLevelFunctionsStyle}">
                                <Style.Triggers>
                                    <MultiDataTrigger>
                                        <MultiDataTrigger.Conditions>
                                            <Condition Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=DataContext.SearchedItemRequest}"
                                                       Value="Required" />
                                            <Condition Binding="{Binding ElementName=Window, Path=DataContext.SearchedItem.ObjectClass}"
                                                       Value="printQueue" />
                                        </MultiDataTrigger.Conditions>
                                        <Setter Property="Visibility"
                                                Value="Visible" />
                                    </MultiDataTrigger>
                                </Style.Triggers>
                            </Style>
                        </MenuItem.ItemContainerStyle>
                    </MenuItem>
                    <MenuItem Name="MiOtherFunctions"
                              ItemsSource="{Binding Source={StaticResource CvsMiOtherFunctions}}"
                              Style="{StaticResource MiTopLevelStyle}">
                        <MenuItem.Header>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="{StaticResource MiIconWidth}" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Path Data="{StaticResource OtherIcon}"
                                      Style="{StaticResource PathMenuIconStyle}" />
                                <TextBlock Style="{StaticResource TblFunctionMenuStyle}"
                                           Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblMiOtherFunctions}" />
                            </Grid>
                        </MenuItem.Header>
                        <MenuItem.ItemContainerStyle>
                            <Style TargetType="MenuItem"
                                   BasedOn="{StaticResource MiSubLevelFunctionsStyle}">
                                <Setter Property="Visibility"
                                        Value="Visible" />
                            </Style>
                        </MenuItem.ItemContainerStyle>
                    </MenuItem>
                    <MenuItem Name="MiO365Connect"
                              Style="{StaticResource MiTopLevelStyle}"
                              Visibility="Visible">
                        <MenuItem.Header>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="{StaticResource MiIconWidth}" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Path Name="PathMiO365Connect"
                                      Data="{StaticResource O365Icon}">
                                    <Path.Style>
                                        <Style TargetType="Path"
                                               BasedOn="{StaticResource PathMenuIconStyle}">
                                            <Setter Property="Stroke"
                                                    Value="Black" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding ElementName=Window, Path=DataContext.O365Connected}"
                                                             Value="False">
                                                    <Setter Property="Stroke"
                                                            Value="Red" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Path.Style>
                                </Path>
                                <TextBlock Name="TblMiO365Connect"
                                           Foreground="Black"
                                           Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblMiConnectO365ServicesText}">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock"
                                               BasedOn="{StaticResource TblFunctionMenuStyle}">
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding ElementName=Window, Path=DataContext.O365Connected}"
                                                             Value="False">
                                                    <Setter Property="Foreground"
                                                            Value="Red" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                            </Grid>
                        </MenuItem.Header>
                    </MenuItem>
                    <MenuItem Name="MiO365User"
                              ItemsSource="{Binding Source={StaticResource CvsMiO365UserFunctions}}"
                              Style="{StaticResource MiTopLevelStyle}"
                              Visibility="{DynamicResource MiO365TopVisible}">
                        <MenuItem.Header>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="{StaticResource MiIconWidth}" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Path Data="{StaticResource O365UserIcon}"
                                      Style="{StaticResource PathMenuIconStyle}" />
                                <TextBlock Style="{StaticResource TblFunctionMenuStyle}"
                                           Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblMiO365User}" />
                            </Grid>
                        </MenuItem.Header>
                        <MenuItem.ItemContainerStyle>
                            <Style TargetType="MenuItem"
                                   BasedOn="{StaticResource MiSubLevelFunctionsStyle}">
                                <Style.Triggers>
                                    <MultiDataTrigger>
                                        <MultiDataTrigger.Conditions>
                                            <Condition Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=DataContext.SearchedItemRequest}"
                                                       Value="Required" />
                                            <Condition Binding="{Binding ElementName=Window, Path=DataContext.SearchedItem.ObjectClass}"
                                                       Value="user" />
                                        </MultiDataTrigger.Conditions>
                                        <Setter Property="Visibility"
                                                Value="Visible" />
                                    </MultiDataTrigger>
                                    <MultiDataTrigger>
                                        <MultiDataTrigger.Conditions>
                                            <Condition Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=DataContext.SearchedItemRequest}"
                                                       Value="Required" />
                                            <Condition Binding="{Binding ElementName=Window, Path=DataContext.SearchedItem.ObjectClass}"
                                                       Value="O365User" />
                                        </MultiDataTrigger.Conditions>
                                        <Setter Property="Visibility"
                                                Value="Visible" />
                                    </MultiDataTrigger>
                                </Style.Triggers>
                            </Style>
                        </MenuItem.ItemContainerStyle>
                    </MenuItem>
                    <MenuItem Name="MiO365SharedMailbox"
                              ItemsSource="{Binding Source={StaticResource CvsMiO365SharedMailboxFunctions}}"
                              Style="{StaticResource MiTopLevelStyle}"
                              Visibility="{DynamicResource MiO365TopVisible}">
                        <MenuItem.Header>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="{StaticResource MiIconWidth}" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Path Data="{StaticResource O365SharedMailboxIcon}"
                                      Style="{StaticResource PathMenuIconStyle}" />
                                <TextBlock Style="{StaticResource TblFunctionMenuStyle}"
                                           Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblMiO365SharedMailbox}" />
                            </Grid>
                        </MenuItem.Header>
                        <MenuItem.ItemContainerStyle>
                            <Style TargetType="MenuItem"
                                   BasedOn="{StaticResource MiSubLevelFunctionsStyle}">
                                <Style.Triggers>
                                    <MultiDataTrigger>
                                        <MultiDataTrigger.Conditions>
                                            <Condition Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=DataContext.SearchedItemRequest}"
                                                       Value="Required" />
                                            <Condition Binding="{Binding ElementName=Window, Path=DataContext.SearchedItem.ObjectClass}"
                                                       Value="O365SharedMailbox" />
                                        </MultiDataTrigger.Conditions>
                                        <Setter Property="Visibility"
                                                Value="Visible" />
                                    </MultiDataTrigger>
                                </Style.Triggers>
                            </Style>
                        </MenuItem.ItemContainerStyle>
                    </MenuItem>
                    <MenuItem Name="MiO365Distributionlist"
                              ItemsSource="{Binding Source={StaticResource CvsMiO365DistributionlistFunctions}}"
                              Style="{StaticResource MiTopLevelStyle}"
                              Visibility="{DynamicResource MiO365TopVisible}">
                        <MenuItem.Header>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="{StaticResource MiIconWidth}" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Path Data="{StaticResource O365DistributionlistIcon}"
                                      Style="{StaticResource PathMenuIconStyle}" />
                                <TextBlock Style="{StaticResource TblFunctionMenuStyle}"
                                           Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblMiO365Distributionlist}" />
                            </Grid>
                        </MenuItem.Header>
                        <MenuItem.ItemContainerStyle>
                            <Style TargetType="MenuItem"
                                   BasedOn="{StaticResource MiSubLevelFunctionsStyle}">
                                <Style.Triggers>
                                    <MultiDataTrigger>
                                        <MultiDataTrigger.Conditions>
                                            <Condition Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=DataContext.SearchedItemRequest}"
                                                       Value="Required" />
                                            <Condition Binding="{Binding ElementName=Window, Path=DataContext.SearchedItem.ObjectClass}"
                                                       Value="O365Distributionlist" />
                                        </MultiDataTrigger.Conditions>
                                        <Setter Property="Visibility"
                                                Value="Visible" />
                                    </MultiDataTrigger>
                                </Style.Triggers>
                            </Style>
                        </MenuItem.ItemContainerStyle>
                    </MenuItem>
                    <MenuItem Name="MiO365Resource"
                              ItemsSource="{Binding Source={StaticResource CvsMiO365ResourceFunctions}}"
                              Style="{StaticResource MiTopLevelStyle}"
                              Visibility="{DynamicResource MiO365TopVisible}">
                        <MenuItem.Header>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="{StaticResource MiIconWidth}" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Path Data="{StaticResource O365ResourceIcon}"
                                      Style="{StaticResource PathMenuIconStyle}" />
                                <TextBlock Style="{StaticResource TblFunctionMenuStyle}"
                                           Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblMiO365Resource}" />
                            </Grid>
                        </MenuItem.Header>
                        <MenuItem.ItemContainerStyle>
                            <Style TargetType="MenuItem"
                                   BasedOn="{StaticResource MiSubLevelFunctionsStyle}">
                                <Style.Triggers>
                                    <MultiDataTrigger>
                                        <MultiDataTrigger.Conditions>
                                            <Condition Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=DataContext.SearchedItemRequest}"
                                                       Value="Required" />
                                            <Condition Binding="{Binding ElementName=Window, Path=DataContext.SearchedItem.ObjectClass}"
                                                       Value="O365Resource" />
                                        </MultiDataTrigger.Conditions>
                                        <Setter Property="Visibility"
                                                Value="Visible" />
                                    </MultiDataTrigger>
                                </Style.Triggers>
                            </Style>
                        </MenuItem.ItemContainerStyle>
                    </MenuItem>
                    <MenuItem Name="MiO365Room"
                              ItemsSource="{Binding Source={StaticResource CvsMiO365RoomFunctions}}"
                              Style="{StaticResource MiTopLevelStyle}"
                              Visibility="{DynamicResource MiO365TopVisible}">
                        <MenuItem.Header>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="{StaticResource MiIconWidth}" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Path Data="{StaticResource O365RoomIcon}"
                                      Style="{StaticResource PathMenuIconStyle}" />
                                <TextBlock Style="{StaticResource TblFunctionMenuStyle}"
                                           Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblMiO365Room}" />
                            </Grid>
                        </MenuItem.Header>
                        <MenuItem.ItemContainerStyle>
                            <Style TargetType="MenuItem"
                                   BasedOn="{StaticResource MiSubLevelFunctionsStyle}">
                                <Style.Triggers>
                                    <MultiDataTrigger>
                                        <MultiDataTrigger.Conditions>
                                            <Condition Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=DataContext.SearchedItemRequest}"
                                                       Value="Required" />
                                            <Condition Binding="{Binding ElementName=Window, Path=DataContext.SearchedItem.ObjectClass}"
                                                       Value="O365Room" />
                                        </MultiDataTrigger.Conditions>
                                        <Setter Property="Visibility"
                                                Value="Visible" />
                                    </MultiDataTrigger>
                                </Style.Triggers>
                            </Style>
                        </MenuItem.ItemContainerStyle>
                    </MenuItem>
                    <MenuItem Name="MiTools"
                              IsEnabled="True"
                              ItemsSource="{Binding Source={StaticResource CvsMiTools}}">
                        <MenuItem.Style>
                            <Style TargetType="MenuItem"
                                   BasedOn="{StaticResource MiTopLevelStyle}">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding ElementName=PbSearchProgress, Path=Visibility}"
                                                 Value="Visible">
                                        <Setter Property="IsEnabled"
                                                Value="True" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding ElementName=GridProgress, Path=Visibility}"
                                                 Value="Visible">
                                        <Setter Property="IsEnabled"
                                                Value="True" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </MenuItem.Style>
                        <MenuItem.Header>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="{StaticResource MiIconWidth}" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Path Data="{StaticResource ToolsIcon}"
                                      Style="{StaticResource PathMenuIconStyle}" />
                                <TextBlock Style="{StaticResource TblFunctionMenuStyle}"
                                           Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblMiToolsText}" />
                            </Grid>
                        </MenuItem.Header>
                        <MenuItem.ItemContainerStyle>
                            <Style TargetType="MenuItem"
                                   BasedOn="{StaticResource MiSubLevelToolStyle}" />
                        </MenuItem.ItemContainerStyle>
                    </MenuItem>
                    <MenuItem Name="MiSeparateToolsFunctions"
                              IsEnabled="True"
                              ItemsSource="{Binding Source={StaticResource CvsMiSeparateToolsFunctions}}">
                        <MenuItem.Style>
                            <Style TargetType="MenuItem"
                                   BasedOn="{StaticResource MiTopLevelStyle}">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding ElementName=PbSearchProgress, Path=Visibility}"
                                                 Value="Visible">
                                        <Setter Property="IsEnabled"
                                                Value="True" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding ElementName=GridProgress, Path=Visibility}"
                                                 Value="Visible">
                                        <Setter Property="IsEnabled"
                                                Value="True" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </MenuItem.Style>
                        <MenuItem.Header>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="{StaticResource MiIconWidth}" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Path Data="{StaticResource SeparateToolsIcon}"
                                      Style="{StaticResource PathMenuIconStyle}" />
                                <TextBlock Style="{StaticResource TblFunctionMenuStyle}"
                                           Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblMiSeparateToolsText}" />
                            </Grid>
                        </MenuItem.Header>
                        <MenuItem.ItemContainerStyle>
                            <Style TargetType="MenuItem"
                                   BasedOn="{StaticResource MiSubLevelToolStyle}" />
                        </MenuItem.ItemContainerStyle>
                    </MenuItem>
                    <MenuItem Name="MiAbout"
                              ItemsSource="{Binding Source={StaticResource CvsMiAbout}}">
                        <MenuItem.Style>
                            <Style TargetType="MenuItem"
                                   BasedOn="{StaticResource MiTopLevelStyle}">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding ElementName=PbSearchProgress, Path=Visibility}"
                                                 Value="Visible">
                                        <Setter Property="IsEnabled"
                                                Value="True" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding ElementName=GridProgress, Path=Visibility}"
                                                 Value="Visible">
                                        <Setter Property="IsEnabled"
                                                Value="True" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </MenuItem.Style>
                        <MenuItem.Header>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="{StaticResource MiIconWidth}" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Path Data="{StaticResource AboutIcon}"
                                      Style="{StaticResource PathMenuIconStyle}" />
                                <TextBlock Style="{StaticResource TblFunctionMenuStyle}"
                                           Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblMiAboutText}" />
                            </Grid>
                        </MenuItem.Header>
                        <MenuItem.ItemContainerStyle>
                            <Style TargetType="MenuItem"
                                   BasedOn="{StaticResource MiSubLevelToolStyle}" />
                        </MenuItem.ItemContainerStyle>
                    </MenuItem>
                </Menu>
            </Grid>
            <Grid Name="GridViews"
                  Grid.Column="2"
                  Grid.Row="1">
                <Grid Name="GridObj"
                      Visibility="Collapsed">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition />
                    </Grid.RowDefinitions>
                    <Grid Name="GridDetailedProps"
                          Grid.Column="0"
                          Grid.Row="1">
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition />
                        </Grid.RowDefinitions>
                        <Border Background="#FFDDDDDD"
                                BorderBrush="#FF707070"
                                BorderThickness="1"
                                Margin="{StaticResource StdMargin}"
                                Visibility="{Binding ElementName=IcObjectDetailed, Path=Visibility}">
                            <Border.Style>
                                <Style TargetType="Border">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=IsMouseOver}"
                                                     Value="True">
                                            <Setter Property="Background"
                                                    Value="#FFCCE8FF" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Border.Style>
                            <ToggleButton Name="TBtnObjectDetailed"
                                          Background="Transparent"
                                          Height="30">
                                <ToggleButton.Style>
                                    <Style TargetType="ToggleButton">
                                        <Setter Property="Template"
                                                Value="{StaticResource TBtnWithProgressBarStyle}" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=IsChecked}"
                                                         Value="True">
                                                <Setter Property="Template"
                                                        Value="{StaticResource TBtnCheckedWithProgressBarStyle}" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </ToggleButton.Style>
                            </ToggleButton>
                        </Border>
                        <TextBlock Name="TblVisiblePropsTitle"
                                   Grid.Row="1"
                                   Margin="{StaticResource StdMargin}"
                                   Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblVisiblePropsTitle}"
                                   Visibility="{Binding ElementName=IcObjectDetailed, Path=Visibility}" />
                    </Grid>
                    <StackPanel Grid.Column="1"
                                Grid.Row="1"
                                Visibility="{Binding ElementName=IcObjectDetailed, Path=Visibility}">
                        <TextBlock FontSize="13"
                                   FontWeight="Bold"
                                   Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblSourceFilterTitle}" />
                        <ItemsControl Name="IcSourceFilter"
                                      ItemsSource="{Binding Source={StaticResource CvsPropSourceFilters}}">
                            <ItemsControl.Resources>
                                <Style TargetType="CheckBox"
                                       x:Key="ChbFilterStyle">
                                    <EventSetter Event="Checked" />
                                    <EventSetter Event="Unchecked" />
                                </Style>
                            </ItemsControl.Resources>
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel />
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <CheckBox Content="{Binding Path=Name}"
                                              IsChecked="{Binding Path=Checked, Mode=TwoWay}"
                                              Margin="{StaticResource StdMargin}"
                                              Style="{StaticResource ChbFilterStyle}"
                                              VerticalAlignment="Center"
                                              VerticalContentAlignment="Center" />
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                    <ScrollViewer Name="ScObjInfo"
                                  DataContext="{Binding ElementName=Window, Path=DataContext.SearchedObject}"
                                  Grid.ColumnSpan="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=ColumnDefinitions.Count}"
                                  Grid.Row="2"
                                  Style="{StaticResource ScVObjStyle}"
                                  Visibility="Visible">
                        <Grid Name="GridObjInfo"
                              HorizontalAlignment="Stretch">
                            <Grid.RowDefinitions>
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <ItemsControl Name="IcObjectDetailed"
                                          ItemsSource="{Binding Source={StaticResource CvsDetailedProps}}"
                                          Style="{StaticResource IcBaseStyle}"
                                          Visibility="Collapsed">
                                <ItemsControl.Resources>
                                    <sys:String x:Key="ContentTblPropNameTT">x</sys:String>
                                </ItemsControl.Resources>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="{StaticResource GridDetailedColWidth}" />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition />
                                                <RowDefinition />
                                            </Grid.RowDefinitions>
                                            <Grid.Style>
                                                <Style TargetType="Grid">
                                                    <Setter Property="Background"
                                                            Value="#0000" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsMouseOver}"
                                                                     Value="True">
                                                            <Setter Property="Background"
                                                                    Value="{StaticResource ScbPropListItemMouseOver}" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Grid.Style>
                                            <CheckBox IsChecked="{Binding Path=CheckedForVisible}"
                                                      IsThreeState="False"
                                                      VerticalAlignment="Center">
                                                <CheckBox.Style>
                                                    <Style TargetType="CheckBox">
                                                        <Setter Property="Visibility"
                                                                Value="Hidden" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding ElementName=TBtnObjectDetailed, Path=IsChecked}"
                                                                         Value="True">
                                                                <Setter Property="Visibility"
                                                                        Value="Visible" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </CheckBox.Style>
                                            </CheckBox>
                                            <TextBlock FontWeight="Bold"
                                                       Grid.Column="1"
                                                       Margin="{StaticResource StdMargin}"
                                                       Text="{Binding Path=Name}">
                                                <TextBlock.ToolTip>
                                                    <Grid>
                                                        <TextBlock>
                                                            <Run Text="{DynamicResource ContentTblPropNameTT}"
                                                                 FontWeight="Bold" />
                                                            <Run Text=": " />
                                                            <Run Text="{Binding Path=Source}" />
                                                        </TextBlock>
                                                    </Grid>
                                                </TextBlock.ToolTip>
                                            </TextBlock>
                                            <ContentControl>
                                                <ContentControl.Style>
                                                    <Style TargetType="ContentControl">
                                                        <Setter Property="Grid.Column"
                                                                Value="2" />
                                                        <Setter Property="Template">
                                                            <Setter.Value>
                                                                <ControlTemplate>
                                                                    <TextBox Grid.Column="1">
                                                                        <TextBox.Style>
                                                                            <Style TargetType="TextBox"
                                                                                   BasedOn="{StaticResource TbListValueBaseStyle}">
                                                                                <Setter Property="Text"
                                                                                        Value="{Binding Path=Value, Mode=OneWay}" />
                                                                                <Style.Triggers>
                                                                                    <DataTrigger Binding="{Binding Path=Value}"
                                                                                                 Value="NULL">
                                                                                        <Setter Property="FontStyle"
                                                                                                Value="Italic" />
                                                                                        <Setter Property="FontWeight"
                                                                                                Value="Bold" />
                                                                                        <Setter Property="Background"
                                                                                                Value="LightGray" />
                                                                                    </DataTrigger>
                                                                                </Style.Triggers>
                                                                            </Style>
                                                                        </TextBox.Style>
                                                                    </TextBox>
                                                                </ControlTemplate>
                                                            </Setter.Value>
                                                        </Setter>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding Path=Type}"
                                                                         Value="ArrayList">
                                                                <Setter Property="Template">
                                                                    <Setter.Value>
                                                                        <ControlTemplate>
                                                                            <Expander>
                                                                                <Expander.Header>
                                                                                    <StackPanel Orientation="Horizontal">
                                                                                        <StackPanel.Resources>
                                                                                            <Style TargetType="TextBlock">
                                                                                                <Setter Property="FontWeight"
                                                                                                        Value="Bold" />
                                                                                            </Style>
                                                                                        </StackPanel.Resources>
                                                                                        <TextBlock Text="{Binding ElementName=Window, Path=DataContext.MsgTable.StrPropListTitle1}" />
                                                                                        <TextBlock Text=" " />
                                                                                        <TextBlock Text="{Binding RelativeSource={RelativeSource AncestorType=ContentControl}, Path=DataContext.Value.Count}" />
                                                                                        <TextBlock Text=" " />
                                                                                        <TextBlock Text="{Binding ElementName=Window, Path=DataContext.MsgTable.StrPropListTitle2}" />
                                                                                    </StackPanel>
                                                                                </Expander.Header>
                                                                                <ItemsControl ItemsSource="{Binding RelativeSource={RelativeSource AncestorType=ContentControl}, Path=DataContext.Value}">
                                                                                    <ItemsControl.ItemTemplate>
                                                                                        <DataTemplate>
                                                                                            <TextBox Style="{StaticResource TbListValueBaseStyle}"
                                                                                                     Text="{Binding Mode=OneWay}" />
                                                                                        </DataTemplate>
                                                                                    </ItemsControl.ItemTemplate>
                                                                                </ItemsControl>
                                                                            </Expander>
                                                                        </ControlTemplate>
                                                                    </Setter.Value>
                                                                </Setter>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding Path=Type}"
                                                                         Value="ObjectList">
                                                                <Setter Property="Template">
                                                                    <Setter.Value>
                                                                        <ControlTemplate>
                                                                            <Expander>
                                                                                <Expander.Header>
                                                                                    <StackPanel Orientation="Horizontal">
                                                                                        <StackPanel.Resources>
                                                                                            <Style TargetType="TextBlock">
                                                                                                <Setter Property="FontWeight"
                                                                                                        Value="Bold" />
                                                                                            </Style>
                                                                                        </StackPanel.Resources>
                                                                                        <TextBlock Text="{Binding ElementName=Window, Path=DataContext.MsgTable.StrPropListTitle1}" />
                                                                                        <TextBlock Text=" " />
                                                                                        <TextBlock Text="{Binding RelativeSource={RelativeSource AncestorType=ContentControl}, Path=DataContext.Value.Count}" />
                                                                                        <TextBlock Text=" " />
                                                                                        <TextBlock Text="{Binding ElementName=Window, Path=DataContext.MsgTable.StrPropListTitle2}" />
                                                                                    </StackPanel>
                                                                                </Expander.Header>
                                                                                <ItemsControl ItemsSource="{Binding RelativeSource={RelativeSource AncestorType=ContentControl}, Path=DataContext.Value}">
                                                                                    <ItemsControl.ItemTemplate>
                                                                                        <DataTemplate>
                                                                                            <TextBox Style="{StaticResource TbListValueBaseStyle}"
                                                                                                     Text="{Binding Mode=OneWay}" />
                                                                                        </DataTemplate>
                                                                                    </ItemsControl.ItemTemplate>
                                                                                </ItemsControl>
                                                                            </Expander>
                                                                        </ControlTemplate>
                                                                    </Setter.Value>
                                                                </Setter>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </ContentControl.Style>
                                            </ContentControl>
                                            <!-- Information about prop handler -->
                                            <Grid Grid.Column="2"
                                                  Grid.ColumnSpan="2"
                                                  Grid.Row="1">
                                                <Grid.Style>
                                                    <Style TargetType="Grid">
                                                        <Setter Property="Visibility"
                                                                Value="Collapsed" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding Path=CheckedForVisible}"
                                                                         Value="True">
                                                                <Setter Property="Visibility"
                                                                        Value="Visible" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Grid.Style>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                </Grid.RowDefinitions>
                                                <TextBlock FontWeight="Bold">
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="Text"
                                                                    Value="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblPropHandlerTitle}" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Path=Handler}"
                                                                             Value="{x:Null}">
                                                                    <Setter Property="Text"
                                                                            Value="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblPropHandlerTitleEmpty}" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                                <TextBox Grid.Row="1"
                                                         HorizontalScrollBarVisibility="Hidden"
                                                         IsEnabled="False"
                                                         MaxHeight="60"
                                                         Text="{Binding Path=Handler.Description, Mode=OneWay}"
                                                         VerticalScrollBarVisibility="Auto">
                                                    <TextBox.Style>
                                                        <Style TargetType="TextBox">
                                                            <Setter Property="Visibility"
                                                                    Value="Visible" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Path=Handler}"
                                                                             Value="{x:Null}">
                                                                    <Setter Property="Visibility"
                                                                            Value="Collapsed" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBox.Style>
                                                </TextBox>
                                            </Grid>
                                        </Grid>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                            <ItemsControl Name="IcPropsList"
                                          ItemsSource="{Binding Source={StaticResource CvsPropsList}}">
                                <ItemsControl.Style>
                                    <Style TargetType="ItemsControl"
                                           BasedOn="{StaticResource IcBaseStyle}">
                                        <Setter Property="Visibility"
                                                Value="Visible" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ElementName=IcObjectDetailed, Path=Visibility}"
                                                         Value="Visible">
                                                <Setter Property="Visibility"
                                                        Value="Collapsed" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </ItemsControl.Style>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Style="{StaticResource PropBorder}">
                                            <Grid Margin="5,0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition />
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition />
                                                </Grid.RowDefinitions>
                                                <TextBlock TextAlignment="Center">
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock"
                                                               BasedOn="{StaticResource PropTitleStyle}">
                                                            <Setter Property="Text"
                                                                    Value="{Binding Path=NameLocalization}" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Path=NameLocalization}"
                                                                             Value="{x:Null}">
                                                                    <Setter Property="Text"
                                                                            Value="{Binding Path=Name}" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                                <TextBlock Grid.Column="1"
                                                           TextAlignment="Center">
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock"
                                                               BasedOn="{StaticResource PropTitleStyle}">
                                                            <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Path=Type}"
                                                                             Value="ArrayList">
                                                                    <Setter Property="Visibility"
                                                                            Value="Visible" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                    <Run Text="(" />
                                                    <Run Text="{Binding Path=Value.Count, Mode=OneWay}" />
                                                    <Run Text=")" />
                                                </TextBlock>
                                                <Canvas Background="White"
                                                        Grid.Column="2"
                                                        Margin="{StaticResource StdMargin}"
                                                        Visibility="{Binding Path=DisplayPropInfo}">
                                                    <Canvas.Style>
                                                        <Style TargetType="Canvas">
                                                            <Setter Property="ToolTip">
                                                                <Setter.Value>
                                                                    <ToolTip>
                                                                        <Grid>
                                                                            <Grid.RowDefinitions>
                                                                                <RowDefinition />
                                                                                <RowDefinition />
                                                                            </Grid.RowDefinitions>
                                                                            <Grid>
                                                                                <Grid.Style>
                                                                                    <Style TargetType="Grid">
                                                                                        <Setter Property="Visibility"
                                                                                                Value="Visible" />
                                                                                        <Style.Triggers>
                                                                                            <DataTrigger Binding="{Binding Path=NameLocalization}"
                                                                                                         Value="{x:Null}">
                                                                                                <Setter Property="Visibility"
                                                                                                        Value="Collapsed" />
                                                                                            </DataTrigger>
                                                                                        </Style.Triggers>
                                                                                    </Style>
                                                                                </Grid.Style>
                                                                                <Grid.ColumnDefinitions>
                                                                                    <ColumnDefinition />
                                                                                    <ColumnDefinition />
                                                                                </Grid.ColumnDefinitions>
                                                                                <TextBlock FontWeight="Bold"
                                                                                           Margin="{StaticResource StdMargin}"
                                                                                           Text="{DynamicResource StrRealPropName}" />
                                                                                <TextBlock Grid.Column="1"
                                                                                           Margin="{StaticResource StdMargin}"
                                                                                           Text="{Binding Path=Name}" />
                                                                            </Grid>
                                                                            <TextBlock Grid.ColumnSpan="2"
                                                                                       Grid.Row="1"
                                                                                       Margin="{StaticResource StdMargin}"
                                                                                       Text="{Binding Path=PropDescription}">
                                                                                <TextBlock.Style>
                                                                                    <Style TargetType="TextBlock">
                                                                                        <Setter Property="Visibility"
                                                                                                Value="Visible" />
                                                                                        <Style.Triggers>
                                                                                            <DataTrigger Binding="{Binding Path=PropDescription}"
                                                                                                         Value="{x:Null}">
                                                                                                <Setter Property="Visibility"
                                                                                                        Value="Collapsed" />
                                                                                            </DataTrigger>
                                                                                        </Style.Triggers>
                                                                                    </Style>
                                                                                </TextBlock.Style>
                                                                            </TextBlock>
                                                                        </Grid>
                                                                    </ToolTip>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </Style>
                                                    </Canvas.Style>
                                                    <Path Data="M13 9H11V7H13V9M13 17H11V11H13V17M5 3H19C20.1 3 21 3.89 21 5V19C21 19.53 20.79 20.04 20.41 20.41C20.04 20.79 19.53 21 19 21H5C4.47 21 3.96 20.79 3.59 20.41C3.21 20.04 3 19.53 3 19V5C3 3.89 3.89 3 5 3M19 19V5H5V19H19Z"
                                                          Fill="LightBlue"
                                                          Stroke="LightBlue"
                                                          VerticalAlignment="Center">
                                                        <Path.Style>
                                                            <Style TargetType="Path">
                                                                <Setter Property="RenderTransform">
                                                                    <Setter.Value>
                                                                        <ScaleTransform ScaleX="1.0"
                                                                                        ScaleY="1.0" />
                                                                    </Setter.Value>
                                                                </Setter>
                                                            </Style>
                                                        </Path.Style>
                                                    </Path>
                                                </Canvas>
                                                <TextBlock FontSize="13"
                                                           Grid.Column="4"
                                                           Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblPropNameTT}">
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock"
                                                               BasedOn="{StaticResource PropTitleStyle}">
                                                            <Setter Property="Visibility"
                                                                    Value="Hidden" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Border}, Path=IsMouseOver}"
                                                                             Value="True">
                                                                    <Setter Property="Visibility"
                                                                            Value="Visible" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                                <TextBlock FontSize="13"
                                                           Grid.Column="5"
                                                           Text="{Binding Path=Source}">
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock"
                                                               BasedOn="{StaticResource PropTitleStyle}">
                                                            <Setter Property="Visibility"
                                                                    Value="Hidden" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Border}, Path=IsMouseOver}"
                                                                             Value="True">
                                                                    <Setter Property="Visibility"
                                                                            Value="Visible" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                                <Button Content="{Binding Path=Handler.Title}"
                                                        Grid.Column="6"
                                                        Padding="5,0"
                                                        ToolTip="{Binding Path=Handler.Description}">
                                                    <Button.Style>
                                                        <Style TargetType="Button"
                                                               BasedOn="{StaticResource BtnRunPropStyle}">
                                                            <Setter Property="Visibility"
                                                                    Value="Visible" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Path=Handler}"
                                                                             Value="{x:Null}">
                                                                    <Setter Property="Visibility"
                                                                            Value="Hidden" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                                <Button Style="{StaticResource BtnCopyPropertyStyle}" />
                                                <ProgressBar Grid.ColumnSpan="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=ColumnDefinitions.Count}"
                                                             Grid.Row="1"
                                                             Height="8"
                                                             IsIndeterminate="True"
                                                             Maximum="{Binding Path=Handler.ProgressMax}"
                                                             Visibility="Hidden" />
                                                <ContentControl Grid.ColumnSpan="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=ColumnDefinitions.Count}"
                                                                Grid.Row="2">
                                                    <ContentControl.Style>
                                                        <Style TargetType="ContentControl">
                                                            <Setter Property="ContentTemplate">
                                                                <Setter.Value>
                                                                    <DataTemplate>
                                                                        <TextBlock Margin="0"
                                                                                   Style="{StaticResource TblPropListItemStyle}"
                                                                                   Text="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.Value}" />
                                                                    </DataTemplate>
                                                                </Setter.Value>
                                                            </Setter>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Path=Type}"
                                                                             Value="ArrayList">
                                                                    <Setter Property="ContentTemplate">
                                                                        <Setter.Value>
                                                                            <DataTemplate>
                                                                                <ScrollViewer MaxHeight="{StaticResource PropValMaxHeight}">
                                                                                    <ScrollViewer.Resources>
                                                                                        <CollectionViewSource x:Key="CvsItems"
                                                                                                              Source="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.Value}">
                                                                                            <CollectionViewSource.SortDescriptions>
                                                                                                <componentmodel:SortDescription Direction="Ascending" />
                                                                                            </CollectionViewSource.SortDescriptions>
                                                                                        </CollectionViewSource>
                                                                                        <Style TargetType="Label"
                                                                                               x:Key="LblStyle">
                                                                                            <Setter Property="Background"
                                                                                                    Value="White" />
                                                                                            <Setter Property="Margin"
                                                                                                    Value="0" />
                                                                                            <Setter Property="VerticalAlignment"
                                                                                                    Value="Center" />
                                                                                            <Style.Triggers>
                                                                                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=IsMouseOver}"
                                                                                                             Value="True">
                                                                                                    <Setter Property="Background"
                                                                                                            Value="PowderBlue" />
                                                                                                </DataTrigger>
                                                                                            </Style.Triggers>
                                                                                        </Style>
                                                                                        <Style TargetType="TextBlock"
                                                                                               x:Key="TblStyle">
                                                                                            <Setter Property="Background"
                                                                                                    Value="White" />
                                                                                            <Setter Property="Padding"
                                                                                                    Value="5" />
                                                                                            <Setter Property="TextWrapping"
                                                                                                    Value="Wrap" />
                                                                                            <Setter Property="VerticalAlignment"
                                                                                                    Value="Center" />
                                                                                            <Style.Triggers>
                                                                                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=IsMouseOver}"
                                                                                                             Value="True">
                                                                                                    <Setter Property="Background"
                                                                                                            Value="PowderBlue" />
                                                                                                </DataTrigger>
                                                                                            </Style.Triggers>
                                                                                        </Style>
                                                                                        <DataTemplate x:Key="BoolTemplate">
                                                                                            <TextBlock Style="{StaticResource TblStyle}"
                                                                                                       Text="{Binding Path=.}" />
                                                                                        </DataTemplate>
                                                                                        <DataTemplate x:Key="DateTimeTemplate">
                                                                                            <Label Content="{Binding Path=.}"
                                                                                                   ContentStringFormat="{DynamicResource StrFullDateTimeFormat}"
                                                                                                   Margin="0"
                                                                                                   Style="{StaticResource LblStyle}" />
                                                                                        </DataTemplate>
                                                                                        <DataTemplate x:Key="DefaultTemplate">
                                                                                            <TextBlock Style="{StaticResource TblStyle}"
                                                                                                       Text="{Binding Path=.}" />
                                                                                        </DataTemplate>
                                                                                        <DataTemplate x:Key="GroupTemplate">
                                                                                            <TextBlock Style="{StaticResource TblStyle}"
                                                                                                       Text="{Binding Path=.}" />
                                                                                        </DataTemplate>
                                                                                        <DataTemplate x:Key="StringTemplate">
                                                                                            <TextBlock Style="{StaticResource TblStyle}"
                                                                                                       Text="{Binding Path=.}" />
                                                                                        </DataTemplate>
                                                                                        <DataTemplate x:Key="UserTemplate">
                                                                                            <TextBlock  Style="{StaticResource TblStyle}"
                                                                                                        Text="{Binding Path=.}" />
                                                                                        </DataTemplate>
                                                                                        <c:IcItemTemplateSelector x:Key="DataTemplateSelector"
                                                                                                                  BoolTpl="{StaticResource BoolTemplate}"
                                                                                                                  DateTimeTpl="{StaticResource DateTimeTemplate}"
                                                                                                                  DefaultTpl="{StaticResource DefaultTemplate}"
                                                                                                                  GroupTpl="{StaticResource GroupTemplate}"
                                                                                                                  StringTpl="{StaticResource StringTemplate}"
                                                                                                                  UserTpl="{StaticResource UserTemplate}" />
                                                                                    </ScrollViewer.Resources>
                                                                                    <ItemsControl ItemsSource="{Binding Source={StaticResource CvsItems}}"
                                                                                                  ItemTemplateSelector="{DynamicResource DataTemplateSelector}"
                                                                                                  ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                                                                                  ScrollViewer.VerticalScrollBarVisibility="Auto"
                                                                                                  VirtualizingPanel.CacheLength="1"
                                                                                                  VirtualizingPanel.CacheLengthUnit="Item"
                                                                                                  VirtualizingPanel.IsVirtualizing="True"
                                                                                                  VirtualizingPanel.VirtualizationMode="Recycling">
                                                                                        <ItemsControl.ItemsPanel>
                                                                                            <ItemsPanelTemplate>
                                                                                                <StackPanel />
                                                                                            </ItemsPanelTemplate>
                                                                                        </ItemsControl.ItemsPanel>
                                                                                    </ItemsControl>
                                                                                </ScrollViewer>
                                                                            </DataTemplate>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Path=Type}"
                                                                             Value="ObjectList">
                                                                    <Setter Property="ContentTemplate">
                                                                        <Setter.Value>
                                                                            <DataTemplate>
                                                                                <DataGrid ItemsSource="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.Value}"
                                                                                          MaxColumnWidth="300"
                                                                                          MaxHeight="{StaticResource PropValMaxHeight}"
                                                                                          MaxWidth="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=ActualWidth}"
                                                                                          ScrollViewer.CanContentScroll="False"
                                                                                          Style="{StaticResource DgPropValueStyle}"
                                                                                          VerticalScrollBarVisibility="Auto"
                                                                                          Width="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=ActualWidth}" />
                                                                            </DataTemplate>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Path=Type}"
                                                                             Value="DateTime">
                                                                    <Setter Property="ContentTemplate">
                                                                        <Setter.Value>
                                                                            <DataTemplate>
                                                                                <Label Content="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.Value}"
                                                                                       ContentStringFormat="{DynamicResource StrFullDateTimeFormat}"
                                                                                       Margin="0"
                                                                                       Style="{StaticResource LblPropStringValueStyle}" />
                                                                            </DataTemplate>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Path=Type}"
                                                                             Value="Boolean">
                                                                    <Setter Property="ContentTemplate">
                                                                        <Setter.Value>
                                                                            <DataTemplate>
                                                                                <TextBlock Text="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.Value}"
                                                                                           Margin="0"
                                                                                           Style="{StaticResource TblPropListItemStyle}" />
                                                                            </DataTemplate>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Path=Type}"
                                                                             Value="Int64">
                                                                    <Setter Property="ContentTemplate">
                                                                        <Setter.Value>
                                                                            <DataTemplate>
                                                                                <TextBlock Margin="0"
                                                                                           Style="{StaticResource TblPropListItemStyle}"
                                                                                           Text="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.Value}" />
                                                                            </DataTemplate>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </ContentControl.Style>
                                                </ContentControl>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </Grid>
                    </ScrollViewer>
                </Grid>
                <Grid x:Name="GridFailedSearch"
                      Visibility="Collapsed">
                    <Grid.Resources>
                        <sys:Double x:Key="IconSize">100</sys:Double>
                    </Grid.Resources>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition />
                        <RowDefinition />
                    </Grid.RowDefinitions>
                    <Image Height="{StaticResource IconSize}"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Bottom"
                           Width="{StaticResource IconSize}">
                        <Image.Source>
                            <DrawingImage>
                                <DrawingImage.Drawing>
                                    <GeometryDrawing Geometry="{StaticResource FailedSearchIcon}">
                                        <GeometryDrawing.Pen>
                                            <Pen Thickness="2"
                                                 Brush="Black" />
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Brush>
                                            <SolidColorBrush Color="LightCoral" />
                                        </GeometryDrawing.Brush>
                                    </GeometryDrawing>
                                </DrawingImage.Drawing>
                            </DrawingImage>
                        </Image.Source>
                    </Image>
                    <TextBlock FontSize="20"
                               Grid.Row="1"
                               HorizontalAlignment="Center"
                               Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblFailedSearchText}"
                               VerticalAlignment="Top" />
                    <TextBlock Name="TblFailedSearchMessage"
                               FontSize="20"
                               Grid.Row="2"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Top" />
                </Grid>
                <Frame Name="FrameTool"
                       NavigationUIVisibility="Hidden"
                       ScrollViewer.VerticalScrollBarVisibility="Auto"
                       Visibility="Collapsed" />
            </Grid>
        </Grid>
    </Grid>
</Window>
