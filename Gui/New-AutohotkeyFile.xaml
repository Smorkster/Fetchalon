<Page Name="Window"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:ComponentModel="clr-namespace:System.ComponentModel;assembly=WindowsBase"
      xmlns:sys="clr-namespace:System;assembly=mscorlib"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Page.Resources>
        <CollectionViewSource x:Key="CvsExtractionMessageQueue">
            <CollectionViewSource.SortDescriptions>
                <ComponentModel:SortDescription PropertyName="OpDate"
                                                Direction="Ascending" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>
        <CollectionViewSource x:Key="CvsFileInfoMessageQueue">
            <CollectionViewSource.SortDescriptions>
                <ComponentModel:SortDescription Direction="Descending"
                                                PropertyName="OpTime" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>
        <CollectionViewSource x:Key="CvsFunctionMessageQueue"
                              IsLiveSortingRequested="True">
            <CollectionViewSource.SortDescriptions>
                <ComponentModel:SortDescription Direction="Descending"
                                                PropertyName="OpTime" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>
        <CollectionViewSource x:Key="CvsFunctions"
                              IsLiveSortingRequested="True">
            <CollectionViewSource.LiveSortingProperties>
                Name
            </CollectionViewSource.LiveSortingProperties>
            <CollectionViewSource.SortDescriptions>
                <ComponentModel:SortDescription Direction="Ascending"
                                                PropertyName="Name" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>
        <CollectionViewSource x:Key="CvsHotkeys">
            <CollectionViewSource.SortDescriptions>
                <ComponentModel:SortDescription PropertyName="Name" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>
        <CollectionViewSource x:Key="CvsHotkeyModifierKeys">
            <CollectionViewSource.SortDescriptions>
                <ComponentModel:SortDescription PropertyName="Name" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>
        <CollectionViewSource x:Key="CvsHotkeyMessageQueue">
            <CollectionViewSource.SortDescriptions>
                <ComponentModel:SortDescription PropertyName="OpTime" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>
        <CollectionViewSource x:Key="CvsHotstringListOfSystems"
                              IsLiveSortingRequested="True">
            <CollectionViewSource.SortDescriptions>
                <ComponentModel:SortDescription Direction="Ascending" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>
        <CollectionViewSource x:Key="CvsHotstringMessageQueue"
                              IsLiveSortingRequested="True">
            <CollectionViewSource.SortDescriptions>
                <ComponentModel:SortDescription Direction="Descending"
                                                PropertyName="OpTime" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>
        <CollectionViewSource x:Key="CvsHotstrings"
                              IsLiveSortingRequested="True"
                              IsLiveFilteringRequested="True">
            <CollectionViewSource.SortDescriptions>
                <ComponentModel:SortDescription Direction="Ascending"
                                                PropertyName="Name" />
            </CollectionViewSource.SortDescriptions>
            <CollectionViewSource.LiveSortingProperties>
                Name
            </CollectionViewSource.LiveSortingProperties>
        </CollectionViewSource>
        <CollectionViewSource x:Key="CvsHotstringSystemList"
                              IsLiveSortingRequested="True">
            <CollectionViewSource.SortDescriptions>
                <ComponentModel:SortDescription Direction="Ascending" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>
        <CollectionViewSource x:Key="CvsHotstringSystemListNewObject"
                              IsLiveSortingRequested="True">
            <CollectionViewSource.SortDescriptions>
                <ComponentModel:SortDescription Direction="Ascending" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>
        <CollectionViewSource x:Key="CvsHsOptionsCollection">
            <CollectionViewSource.SortDescriptions>
                <ComponentModel:SortDescription Direction="Ascending"
                                                PropertyName="Name" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>
        <CollectionViewSource x:Key="CvsImportFunctions"
                              IsLiveSortingRequested="True">
            <CollectionViewSource.SortDescriptions>
                <ComponentModel:SortDescription PropertyName="Name"
                                                Direction="Ascending" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>
        <CollectionViewSource x:Key="CvsImportMessageQueue"
                              IsLiveSortingRequested="True" />
        <CollectionViewSource x:Key="CvsImportHotkeys"
                              IsLiveSortingRequested="True">
            <CollectionViewSource.SortDescriptions>
                <ComponentModel:SortDescription PropertyName="Name"
                                                Direction="Ascending" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>
        <CollectionViewSource x:Key="CvsImportHotstrings"
                              IsLiveSortingRequested="True">
            <CollectionViewSource.SortDescriptions>
                <ComponentModel:SortDescription PropertyName="Name"
                                                Direction="Ascending" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>
        <CollectionViewSource x:Key="CvsImportSettings"
                              IsLiveSortingRequested="True">
            <CollectionViewSource.SortDescriptions>
                <ComponentModel:SortDescription PropertyName="Name"
                                                Direction="Ascending" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>
        <CollectionViewSource x:Key="CvsImportVariables"
                              IsLiveSortingRequested="True">
            <CollectionViewSource.SortDescriptions>
                <ComponentModel:SortDescription PropertyName="Name"
                                                Direction="Ascending" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>
        <CollectionViewSource x:Key="CvsSettingsFiles" />
        <CollectionViewSource x:Key="CvsSettingScriptPaths" />
        <CollectionViewSource x:Key="CvsSettingBackupPaths" />
        <CollectionViewSource x:Key="CvsSettingsMessageQueue"
                              IsLiveSortingRequested="True">
            <CollectionViewSource.SortDescriptions>
                <ComponentModel:SortDescription Direction="Descending"
                                                PropertyName="OpTime" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>
        <CollectionViewSource x:Key="CvsSettingsOperations"
                              IsLiveFilteringRequested="True"
                              IsLiveSortingRequested="True">
            <CollectionViewSource.SortDescriptions>
                <ComponentModel:SortDescription Direction="Ascending"
                                                PropertyName="Name" />
            </CollectionViewSource.SortDescriptions>
            <CollectionViewSource.LiveSortingProperties>
                Name
            </CollectionViewSource.LiveSortingProperties>
        </CollectionViewSource>
        <CollectionViewSource x:Key="CvsSettingsSettings"
                              IsLiveFilteringRequested="True"
                              IsLiveSortingRequested="True">
            <CollectionViewSource.SortDescriptions>
                <ComponentModel:SortDescription Direction="Ascending"
                                                PropertyName="Name" />
            </CollectionViewSource.SortDescriptions>
            <CollectionViewSource.LiveSortingProperties>
                Name
            </CollectionViewSource.LiveSortingProperties>
        </CollectionViewSource>
        <CollectionViewSource x:Key="CvsToExtract">
            <CollectionViewSource.SortDescriptions>
                <ComponentModel:SortDescription PropertyName="Type" />
                <ComponentModel:SortDescription PropertyName="Name" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>
        <CollectionViewSource x:Key="CvsVariables"
                              IsLiveSortingRequested="True">
            <CollectionViewSource.SortDescriptions>
                <ComponentModel:SortDescription Direction="Ascending"
                                                PropertyName="Name" />
            </CollectionViewSource.SortDescriptions>
            <CollectionViewSource.LiveSortingProperties>
                Name
            </CollectionViewSource.LiveSortingProperties>
        </CollectionViewSource>
        <CollectionViewSource x:Key="CvsVariableMessageQueue"
                              IsLiveSortingRequested="True">
            <CollectionViewSource.SortDescriptions>
                <ComponentModel:SortDescription Direction="Descending"
                                                PropertyName="OpTime" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>

        <Brush x:Key="DefaultFontColor">#FF444444</Brush>
        <GridLength x:Key="ObjListColumnWidth">200</GridLength>

        <sys:String x:Key="StrExtractionTarget">x</sys:String>
        <sys:String x:Key="StrSettingResetDefault">x</sys:String>
        <sys:String x:Key="StrSettingSelectFolder">x</sys:String>

        <Thickness x:Key="StdMargin">5</Thickness>
        <Thickness x:Key="StdPadding">5</Thickness>

        <Style TargetType="Button"
               x:Key="BtnBaseStyle">
            <Setter Property="Margin"
                    Value="{StaticResource StdMargin}" />
            <Setter Property="Padding"
                    Value="10,5" />
            <Setter Property="VerticalAlignment"
                    Value="Center" />
            <Setter Property="VerticalContentAlignment"
                    Value="Center" />
        </Style>
        <Style TargetType="Button"
               x:Key="BtnFileStyle"
               BasedOn="{StaticResource BtnBaseStyle}">
            <Setter Property="FontSize"
                    Value="16" />
            <Setter Property="FontWeight"
                    Value="ExtraBold" />
            <Setter Property="IsEnabled"
                    Value="True" />
            <Setter Property="Padding"
                    Value="15" />
        </Style>
        <Style TargetType="Button"
               x:Key="BtnImpOps"
               BasedOn="{StaticResource BtnBaseStyle}">
            <Setter Property="Width"
                    Value="{Binding ElementName=BtnSelectFileToImport, Path=ActualWidth}" />
        </Style>
        <Style TargetType="Button"
               x:Key="BtnResetSetting"
               BasedOn="{StaticResource BtnBaseStyle}">
            <EventSetter Event="Click" />
        </Style>

        <Style TargetType="CheckBox"
               x:Key="ChbBaseStyle">
            <Setter Property="IsThreeState"
                    Value="False" />
            <Setter Property="Margin"
                    Value="{StaticResource StdMargin}" />
            <Setter Property="VerticalAlignment"
                    Value="Center" />
            <Setter Property="VerticalContentAlignment"
                    Value="Center" />
        </Style>
        <Style TargetType="CheckBox"
               x:Key="ChbHsOptionStyle"
               BasedOn="{StaticResource ChbBaseStyle}">
            <EventSetter Event="Unchecked" />
        </Style>

        <Style TargetType="ComboBox"
               x:Key="CbBaseStyle">
            <Setter Property="Height"
                    Value="30" />
            <Setter Property="Margin"
                    Value="{StaticResource StdMargin}" />
            <Setter Property="VerticalContentAlignment"
                    Value="Center" />
        </Style>
        <Style TargetType="ComboBox"
               x:Key="CbEditable"
               BasedOn="{StaticResource CbBaseStyle}">
            <EventSetter Event="SelectionChanged" />
            <EventSetter Event="KeyUp" />
            <Setter Property="IsEditable"
                    Value="True" />
            <Setter Property="SelectedItem"
                    Value="{Binding RelativeSource={RelativeSource AncestorType=ContentControl}, Path=DataContext.Value, Mode=TwoWay}" />
            <Setter Property="StaysOpenOnEdit"
                    Value="True" />
            <Setter Property="Tag"
                    Value="{Binding RelativeSource={RelativeSource AncestorType=Grid}}" />
        </Style>
        <Style TargetType="ToolTip">
            <Setter Property="ContentTemplate">
                <Setter.Value>
                    <DataTemplate>
                        <TextBlock Text="{Binding}"
                                   TextWrapping="Wrap" />
                    </DataTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="MaxWidth"
                    Value="300" />
            <Setter Property="ToolTipService.ShowDuration"
                    Value="10000" />
        </Style>
        <Style TargetType="Grid"
               x:Key="GridImportItemStyle">
            <Style.Resources>
                <Style TargetType="CheckBox"
                       BasedOn="{StaticResource ChbBaseStyle}">
                    <Setter Property="IsChecked"
                            Value="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.ImportThis, FallbackValue=True}" />
                </Style>
                <Style TargetType="TextBlock">
                    <Setter Property="Grid.Column"
                            Value="1" />
                    <Setter Property="Margin"
                            Value="{StaticResource StdMargin}" />
                    <Setter Property="Text"
                            Value="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.Name}" />
                </Style>
            </Style.Resources>
        </Style>
        <Style TargetType="Grid"
               x:Key="GridInfoStyle">
            <Style.Resources>
                <SolidColorBrush x:Key="FillEllipse">White</SolidColorBrush>
                <SolidColorBrush x:Key="FillPath">LightBlue</SolidColorBrush>
                <sys:Double x:Key="IconScale">1.0</sys:Double>
                <Style TargetType="Ellipse">
                    <Setter Property="Fill"
                            Value="{DynamicResource FillEllipse}" />
                    <Setter Property="Height"
                            Value="20" />
                    <Setter Property="LayoutTransform">
                        <Setter.Value>
                            <ScaleTransform ScaleX="{DynamicResource IconScale}"
                                            ScaleY="{DynamicResource IconScale}" />
                        </Setter.Value>
                    </Setter>
                    <Setter Property="Width"
                            Value="20" />
                </Style>
                <Style TargetType="Path">
                    <Setter Property="Data"
                            Value="M11 7V9H13V7H11M14 17V15H13V11H10V13H11V15H10V17H14M22 12C22 17.5 17.5 22 12 22C6.5 22 2 17.5 2 12C2 6.5 6.5 2 12 2C17.5 2 22 6.5 22 12M20 12C20 7.58 16.42 4 12 4C7.58 4 4 7.58 4 12C4 16.42 7.58 20 12 20C16.42 20 20 16.42 20 12Z" />
                    <Setter Property="Fill"
                            Value="{DynamicResource FillPath}" />
                    <Setter Property="Height"
                            Value="24" />
                    <Setter Property="LayoutTransform">
                        <Setter.Value>
                            <ScaleTransform ScaleX="{DynamicResource IconScale}"
                                            ScaleY="{DynamicResource IconScale}" />
                        </Setter.Value>
                    </Setter>
                    <Setter Property="Margin"
                            Value="{StaticResource StdMargin}" />
                    <Setter Property="VerticalAlignment"
                            Value="Center" />
                    <Setter Property="Width"
                            Value="24" />
                </Style>
            </Style.Resources>
            <Setter Property="Grid.Column"
                    Value="1" />
            <Setter Property="ToolTip"
                    Value="{Binding Path=LocalizedTt}" />
            <Setter Property="VerticalAlignment"
                    Value="Top" />
        </Style>
        <Style TargetType="Grid"
               x:Key="GridImportError"
               BasedOn="{StaticResource GridInfoStyle}">
            <Style.Resources>
                <SolidColorBrush x:Key="FillEllipse">Yellow</SolidColorBrush>
                <SolidColorBrush x:Key="FillPath">Red</SolidColorBrush>
                <sys:Double x:Key="IconScale">0.7</sys:Double>
            </Style.Resources>
            <Setter Property="Grid.Column"
                    Value="2" />
            <Setter Property="ToolTip"
                    Value="{Binding RelativeSource={RelativeSource Mode=Self}, Path=DataContext.ImportError}" />
            <Setter Property="Visibility"
                    Value="Visible" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=DataContext.ImportError}"
                             Value="{x:Null}">
                    <Setter Property="Visibility"
                            Value="Collapsed" />
                </DataTrigger>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=DataContext.ImportError}"
                             Value="{x:Static sys:String.Empty}">
                    <Setter Property="Visibility"
                            Value="Collapsed" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style TargetType="GroupBox"
               x:Key="GbBaseStyle">
            <Setter Property="HeaderTemplate">
                <Setter.Value>
                    <DataTemplate>
                        <Grid ToolTip="{Binding RelativeSource={RelativeSource AncestorType=GroupBox}, Path=Tag}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Label Content="{Binding}"
                                   FontSize="14"
                                   FontWeight="Bold" />
                            <Grid Style="{StaticResource GridInfoStyle}">
                                <Ellipse />
                                <Path />
                            </Grid>
                        </Grid>
                    </DataTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="RadioButton"
               x:Key="RbBaseStyle">
            <Setter Property="Margin"
                    Value="{StaticResource StdMargin}" />
            <Setter Property="VerticalContentAlignment"
                    Value="Center" />
        </Style>
        <Style TargetType="RadioButton"
               x:Key="RbBaseWInfoStyle"
               BasedOn="{StaticResource RbBaseStyle}">
            <Setter Property="Content">
                <Setter.Value>
                    <DataTemplate>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="{Binding RelativeSource={RelativeSource AncestorType=RadioButton}, Path=Content}" />
                            <Grid Grid.Column="1"
                                  Style="{StaticResource GridInfoStyle}"
                                  ToolTip="{Binding RelativeSource={RelativeSource AncestorType=RadioButton}, Path=DataContext.ToolTip}">
                                <Ellipse />
                                <Path />
                            </Grid>
                        </Grid>
                    </DataTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style TargetType="RadioButton"
               x:Key="RbHkModifierStyle"
               BasedOn="{StaticResource RbBaseStyle}">
            <Setter Property="Grid.Row"
                    Value="1" />
            <Setter Property="GroupName"
                    Value="ModifierDisplay" />
            <Setter Property="HorizontalAlignment"
                    Value="Left" />
            <Setter Property="VerticalAlignment"
                    Value="Center" />
        </Style>

        <Style TargetType="TextBlock"
               x:Key="TblBaseStyle">
            <Setter Property="Margin"
                    Value="{StaticResource StdMargin}" />
        </Style>
        <Style TargetType="TextBox"
               x:Key="TbBaseStyle">
            <Setter Property="AcceptsReturn"
                    Value="False" />
            <Setter Property="AcceptsTab"
                    Value="False" />
            <Setter Property="Margin"
                    Value="{StaticResource StdMargin}" />
            <Setter Property="Padding"
                    Value="{StaticResource StdPadding}" />
            <Setter Property="VerticalContentAlignment"
                    Value="Center" />
        </Style>
        <Style TargetType="TextBox"
               x:Key="TbUserIdStyle"
               BasedOn="{StaticResource TbBaseStyle}">
            <EventSetter Event="TextChanged" />
            <Setter Property="Text"
                    Value="{Binding Path=Value, Mode=TwoWay}" />
        </Style>

        <DataTemplate x:Key="DtMessagesTemplate">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>
                <Path Data="M21 13H14.4L19.1 17.7L17.7 19.1L13 14.4V21H11V14.3L6.3 19L4.9 17.6L9.4 13H3V11H9.6L4.9 6.3L6.3 4.9L11 9.6V3H13V9.4L17.6 4.8L19 6.3L14.3 11H21V13Z"
                      Fill="{Binding ElementName=TblMsg, Path=Foreground}"
                      Margin="{StaticResource StdMargin}"
                      Stroke="{Binding ElementName=TblMsg, Path=Foreground}"
                      ToolTip="{Binding Path=OpTime}"
                      VerticalAlignment="Center">
                    <Path.RenderTransform>
                        <ScaleTransform ScaleX="0.75"
                                        ScaleY="0.75" />
                    </Path.RenderTransform>
                </Path>
                <TextBlock Name="TblMsg"
                           FontSize="14"
                           Grid.Column="1"
                           Margin="{StaticResource StdMargin}"
                           Text="{Binding Path=Message}"
                           TextWrapping="Wrap">
                    <TextBlock.Style>
                        <Style TargetType="TextBlock">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Path=Type}"
                                             Value="Error">
                                    <Setter Property="FontWeight"
                                            Value="Bold" />
                                    <Setter Property="Foreground"
                                            Value="Red" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Path=Type}"
                                             Value="Warning">
                                    <Setter Property="FontWeight"
                                            Value="Bold" />
                                    <Setter Property="Foreground"
                                            Value="Orange" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Path=Type}"
                                             Value="Success">
                                    <Setter Property="Foreground"
                                            Value="Green" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Path=Type}"
                                             Value="Info">
                                    <Setter Property="Foreground"
                                            Value="Blue" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </TextBlock.Style>
                </TextBlock>
            </Grid>
        </DataTemplate>

        <DataTemplate x:Key="DtSettingTemplate">
            <Grid>
                <Grid.Style>
                    <Style TargetType="Grid">
                        <Style.Triggers>
                            <Trigger Property="IsMouseOver"
                                     Value="True">
                                <Setter Property="Background"
                                        Value="#FF11BEFF" />
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </Grid.Style>
                <Grid.Resources>
                    <CollectionViewSource x:Key="CvsPaths"
                                          Source="{Binding Path=Suggestions, Mode=TwoWay}" />
                </Grid.Resources>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="1*" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="2*" />
                    <ColumnDefinition SharedSizeGroup="SettingButton"
                                      Width="Auto" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Label Content="{Binding Path=LocalizedName}"
                       VerticalContentAlignment="Center" />
                <Grid Style="{StaticResource GridInfoStyle}">
                    <Ellipse />
                    <Path />
                </Grid>
                <ContentControl Grid.Column="2">
                    <ContentControl.Style>
                        <Style TargetType="ContentControl">
                            <Setter Property="ContentTemplate">
                                <Setter.Value>
                                    <DataTemplate>
                                        <TextBox Style="{StaticResource TbBaseStyle}"
                                                 Text="{Binding RelativeSource={RelativeSource AncestorType=ContentControl}, Path=DataContext.Value}" />
                                    </DataTemplate>
                                </Setter.Value>
                            </Setter>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Path=SettingType}"
                                             Value="bool">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <CheckBox IsChecked="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext.Value, Mode=TwoWay}"
                                                          Margin="{StaticResource StdMargin}"
                                                          VerticalAlignment="Center"
                                                          VerticalContentAlignment="Center" />
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Path=Name}"
                                             Value="UserId">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <TextBox DataContext="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=DataContext}"
                                                         Style="{StaticResource TbUserIdStyle}"
                                                         Tag="{Binding RelativeSource={RelativeSource AncestorType=Grid}}" />
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Path=Name}"
                                             Value="ScriptPath">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <ComboBox ItemsSource="{Binding Source={StaticResource CvsPaths}}"
                                                          Style="{StaticResource CbEditable}" />
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Path=Name}"
                                             Value="BackupPath">
                                    <Setter Property="ContentTemplate">
                                        <Setter.Value>
                                            <DataTemplate>
                                                <ComboBox ItemsSource="{Binding Source={StaticResource CvsPaths}}"
                                                          Style="{StaticResource CbEditable}" />
                                            </DataTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ContentControl.Style>
                </ContentControl>
                <Label Content="{Binding Path=SettingInfo}"
                       FontSize="12"
                       FontWeight="Bold"
                       Grid.Column="2"
                       Grid.Row="1"
                       Margin="0"
                       ToolTip="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Content}">
                    <Label.Style>
                        <Style TargetType="Label">
                            <Setter Property="Margin"
                                    Value="{StaticResource StdMargin}" />
                            <Setter Property="Visibility"
                                    Value="Visible" />
                            <Style.Triggers>
                                <Trigger Property="Content"
                                         Value="{x:Static sys:String.Empty}">
                                    <Setter Property="Visibility"
                                            Value="Collapsed" />
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Label.Style>
                </Label>
                <Button Grid.Column="3"
                        Content="{DynamicResource StrSettingResetDefault}">
                    <Button.Style>
                        <Style TargetType="Button"
                               BasedOn="{StaticResource BtnResetSetting}">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Path=DefaultValue}"
                                             Value="{x:Null}">
                                    <Setter Property="Visibility"
                                            Value="Hidden" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>
            </Grid>
        </DataTemplate>

        <Style TargetType="Button"
               x:Key="BtnOpsStyle"
               BasedOn="{StaticResource BtnBaseStyle}">
            <Setter Property="IsEnabled"
                    Value="True" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=TabItem}, Path=Content.Children[1].DataContext}"
                             Value="{x:Null}">
                    <Setter Property="IsEnabled"
                            Value="False" />
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="ItemsControl"
               x:Key="IcBaseStyle">
            <Setter Property="Margin"
                    Value="{StaticResource StdMargin}" />
        </Style>
        <Style TargetType="ItemsControl"
               x:Key="IcImport">
            <Setter Property="Margin"
                    Value="0" />
            <Setter Property="ItemsPanel">
                <Setter.Value>
                    <ItemsPanelTemplate>
                        <StackPanel />
                    </ItemsPanelTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style TargetType="ItemsControl"
               x:Key="IcMessages"
               BasedOn="{StaticResource IcBaseStyle}">
            <Setter Property="ItemTemplate"
                    Value="{StaticResource DtMessagesTemplate}" />
        </Style>
        <Style TargetType="ItemsControl"
               x:Key="IcSettings"
               BasedOn="{StaticResource IcBaseStyle}">
            <Setter Property="ItemTemplate"
                    Value="{StaticResource DtSettingTemplate}" />
        </Style>

        <Style TargetType="Label"
               x:Key="LblBaseStyle">
            <Setter Property="Margin"
                    Value="5" />
            <Setter Property="Padding"
                    Value="5" />
            <Setter Property="VerticalContentAlignment"
                    Value="Center" />
        </Style>
        <Style TargetType="Label"
               x:Key="LblTitleStyle"
               BasedOn="{StaticResource LblBaseStyle}">
            <Setter Property="FontSize"
                    Value="14" />
            <Setter Property="FontWeight"
                    Value="Bold" />
        </Style>

        <Style TargetType="ListView"
               x:Key="LvBaseStyle">
            <Setter Property="Background"
                    Value="White" />
            <Setter Property="IsEnabled"
                    Value="True" />
            <Setter Property="Margin"
                    Value="{StaticResource StdMargin}" />
            <Setter Property="SelectionMode"
                    Value="Single" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=ItemsSource.Count}"
                             Value="0">
                    <Setter Property="Background"
                            Value="Red" />
                    <Setter Property="IsEnabled"
                            Value="False" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style TargetType="ListViewItem"
               x:Key="LvImportStyle">
            <Style.Triggers>
                <DataTrigger Binding="{Binding Type}"
                             Value="AhkFunction">
                    <Setter Property="FontStyle"
                            Value="Italic" />
                    <Setter Property="FontWeight"
                            Value="Bold" />
                </DataTrigger>
                <DataTrigger Binding="{Binding Type}"
                             Value="AhkHotstring">
                    <Setter Property="FontWeight"
                            Value="Bold" />
                </DataTrigger>
                <DataTrigger Binding="{Binding Type}"
                             Value="AhkVariable">
                    <Setter Property="FontStyle"
                            Value="Italic" />
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="ScrollViewer"
               x:Key="SvBaseStyle">
            <Setter Property="HorizontalScrollBarVisibility"
                    Value="Disabled" />
            <Setter Property="Margin"
                    Value="{StaticResource StdMargin}" />
            <Setter Property="VerticalScrollBarVisibility"
                    Value="Auto" />
        </Style>

        <Style TargetType="TabItem"
               x:Key="TiDefaultStyle">
            <Setter Property="HeaderTemplate">
                <Setter.Value>
                    <DataTemplate>
                        <TextBlock Foreground="{StaticResource DefaultFontColor}"
                                   MaxWidth="140"
                                   Text="{Binding}"
                                   TextWrapping="Wrap"
                                   VerticalAlignment="Center"
                                   Width="140">
                            <TextBlock.Style>
                                <Style TargetType="TextBlock">
                                    <Setter Property="FontStyle"
                                            Value="Normal" />
                                    <Setter Property="FontSize"
                                            Value="14" />
                                    <Setter Property="FontWeight"
                                            Value="SemiBold" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=TabItem}, Path=IsSelected}"
                                                     Value="True">
                                            <Setter Property="FontSize"
                                                    Value="18" />
                                            <Setter Property="FontWeight"
                                                    Value="Bold" />
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=TabItem}, Path=IsEnabled}"
                                                     Value="False">
                                            <Setter Property="FontStyle"
                                                    Value="Italic" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>
                    </DataTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TabItem}">
                        <Border Name="Border"
                                Background="{Binding RelativeSource={RelativeSource AncestorType=TabItem}, Path=Background}"
                                BorderBrush="Black"
                                BorderThickness="1,1,0,1"
                                Margin="10,10,0,10"
                                ToolTipService.ShowOnDisabled="True">
                            <Border.Style>
                                <Style TargetType="Border">
                                    <Setter Property="ToolTip"
                                            Value="{x:Null}" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=TabItem}, Path=IsEnabled}"
                                                     Value="False">
                                            <Setter Property="ToolTip">
                                                <Setter.Value>
                                                    <ToolTip BorderBrush="Red"
                                                             BorderThickness="2">
                                                        <ToolTip.ContentTemplate>
                                                            <DataTemplate>
                                                                <Border>
                                                                    <TextBlock Text="{Binding RelativeSource={RelativeSource AncestorType=TabItem}, Path=Tag}" />
                                                                </Border>
                                                            </DataTemplate>
                                                        </ToolTip.ContentTemplate>
                                                    </ToolTip>
                                                </Setter.Value>
                                            </Setter>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Border.Style>
                            <ContentPresenter Name="ContentSite"
                                              ContentSource="Header"
                                              HorizontalAlignment="Center"
                                              Margin="5"
                                              RecognizesAccessKey="True"
                                              VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected"
                                     Value="True">
                                <Setter Property="Panel.ZIndex"
                                        Value="100" />
                                <Setter TargetName="Border"
                                        Property="BorderThickness"
                                        Value="1,1,0,1" />
                                <Setter TargetName="Border"
                                        Property="Margin"
                                        Value="5,5,0,5" />
                            </Trigger>
                            <Trigger Property="IsSelected"
                                     Value="False">
                                <Setter TargetName="Border"
                                        Property="BorderThickness"
                                        Value="0,1,1,1" />
                                <Setter TargetName="Border"
                                        Property="Margin"
                                        Value="0,5,5,5" />
                            </Trigger>
                            <Trigger Property="IsEnabled"
                                     Value="False">
                                <Setter TargetName="Border"
                                        Property="BorderThickness"
                                        Value="0" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="TextBlock"
               x:Key="TextBlockError">
            <Setter Property="Foreground"
                    Value="Red" />
            <Setter Property="Margin"
                    Value="{StaticResource StdMargin}" />
            <Setter Property="TextWrapping"
                    Value="Wrap" />
        </Style>
    </Page.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Menu>
            <MenuItem Name="MenuItemNewCommand">
                <MenuItem.HeaderTemplate>
                    <DataTemplate>
                        <Label Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentMenuItemNewCommand}"
                               Margin="0"
                               Style="{StaticResource LblTitleStyle}" />
                    </DataTemplate>
                </MenuItem.HeaderTemplate>
                <MenuItem Name="MenuItemNewFunction"
                          Header="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentMenuItemNewFunction}" />
                <MenuItem Name="MenuItemNewHotkey"
                          Header="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentMenuItemNewHotkey}" />
                <MenuItem Name="MenuItemNewHotstring"
                          Header="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentMenuItemNewHotstring}" />
                <MenuItem Name="MenuItemNewVariable"
                          Header="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentMenuItemNewVariable}" />
            </MenuItem>
        </Menu>
        <Grid Name="GridNewObject"
              DataContext="{x:Null}"
              Grid.Row="1">
            <Grid.Style>
                <Style TargetType="Grid">
                    <Setter Property="Visibility"
                            Value="Visible" />
                    <Style.Triggers>
                        <Trigger Property="DataContext"
                                 Value="{x:Null}">
                            <Setter Property="Visibility"
                                    Value="Collapsed" />
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </Grid.Style>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="1*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <Label Name="LblNewNameTitle"
                   Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblNewNameTitle}"
                   Style="{StaticResource LblTitleStyle}" />
            <TextBox Name="TbNewName"
                     Grid.Column="1"
                     Style="{StaticResource TbBaseStyle}"
                     Text="{Binding Path=Name}"
                     Width="200" />
            <Label Name="LblNewSystemTitle"
                   Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblNewSystemTitle}"
                   Grid.Column="2">
                <Label.Style>
                    <Style TargetType="Label"
                           BasedOn="{StaticResource LblTitleStyle}">
                        <Setter Property="Visibility"
                                Value="Collapsed" />
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Path=Type}"
                                         Value="Hotstring">
                                <Setter Property="Visibility"
                                        Value="Visible" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Label.Style>
            </Label>
            <Grid Name="GridNewSystemInfo"
                  Grid.Column="3"
                  Style="{StaticResource GridInfoStyle}"
                  ToolTip="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTtGridNewSystemInfo}">
                <Ellipse />
                <Path />
            </Grid>
            <ComboBox Name="CbNewSystem"
                      Grid.Column="4"
                      IsEditable="True"
                      ItemsSource="{Binding Source={StaticResource CvsHotstringSystemListNewObject}}"
                      SelectedIndex="{Binding Path=System}"
                      Style="{StaticResource CbBaseStyle}"
                      Visibility="{Binding ElementName=LblNewSystemTitle, Path=Visibility}"
                      Width="200" />
            <StackPanel Orientation="Horizontal"
                        Grid.Column="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=ColumnDefinitions.Count}">
                <Button Name="BtnAddNew"
                        Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnAddNew}">
                    <Button.Style>
                        <Style TargetType="Button"
                               BasedOn="{StaticResource BtnBaseStyle}">
                            <Setter Property="IsEnabled"
                                    Value="False" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding ElementName=TblNewObjectInfo, Path=Text}"
                                             Value="{x:Static sys:String.Empty}">
                                    <Setter Property="IsEnabled"
                                            Value="True" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>
                <Button Name="BtnCancelNew"
                        Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnCancelNew}"
                        Style="{StaticResource BtnBaseStyle}" />
            </StackPanel>
            <TextBlock Name="TblNewObjectInfo"
                       FontWeight="Bold"
                       Foreground="Red"
                       Grid.ColumnSpan="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=ColumnDefinitions.Count}"
                       Grid.Row="1">
                <TextBlock.Style>
                    <Style TargetType="TextBlock">
                        <Setter Property="Visibility"
                                Value="Visible" />
                        <Style.Triggers>
                            <Trigger Property="Text"
                                     Value="{x:Static sys:String.Empty}">
                                <Setter Property="Visibility"
                                        Value="Collapsed" />
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </TextBlock.Style>
            </TextBlock>
        </Grid>
        <TabControl Name="TcMain"
                    BorderBrush="Black"
                    Grid.Row="2"
                    TabStripPlacement="Left">
            <TabItem Name="TiScriptComment"
                     Header="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTiScriptComment}"
                     Style="{StaticResource TiDefaultStyle}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="1*" />
                    </Grid.RowDefinitions>
                    <TextBlock Name="TblScriptCommentTitle"
                               Style="{StaticResource TblBaseStyle}"
                               Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblScriptCommentTitle}" />
                    <TextBox Name="TbScriptComment"
                             AcceptsReturn="True"
                             AcceptsTab="True"
                             Grid.Row="1"
                             Padding="{StaticResource StdPadding}"
                             Style="{StaticResource TbBaseStyle}"
                             VerticalContentAlignment="Top" />
                </Grid>
            </TabItem>
            <TabItem Name="TiHotkeys"
                     Header="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTiHotkeys}"
                     Style="{StaticResource TiDefaultStyle}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="{StaticResource ObjListColumnWidth}" />
                        <ColumnDefinition Width="1*" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="1*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Label Name="LblHotkeysTitle"
                           Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblHotkeysTitle}"
                           Style="{StaticResource LblTitleStyle}" />
                    <ListView Name="LvHotkeys"
                              DisplayMemberPath="Name"
                              Grid.Row="1"
                              Grid.RowSpan="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=RowDefinitions.Count}"
                              ItemsSource="{Binding Source={StaticResource CvsHotkeys}}"
                              Style="{StaticResource LvBaseStyle}" />
                    <Grid Name="GridHotkey"
                          DataContext="{Binding ElementName=LvHotkeys, Path=SelectedItem}"
                          Grid.Column="1"
                          Grid.RowSpan="2">
                        <Grid.Style>
                            <Style TargetType="Grid">
                                <Setter Property="IsEnabled"
                                        Value="True" />
                                <Style.Triggers>
                                    <Trigger Property="DataContext"
                                             Value="{x:Null}">
                                        <Setter Property="IsEnabled"
                                                Value="False" />
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Grid.Style>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="1*" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="1*" />
                        </Grid.RowDefinitions>
                        <Label Name="LblHotkeyCommentTitle"
                               Style="{StaticResource LblTitleStyle}"
                               Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblHotkeyCommentTitle}" />
                        <TextBox Name="TbHotkeyComment"
                                 Grid.Column="1"
                                 Padding="{StaticResource StdPadding}"
                                 Style="{StaticResource TbBaseStyle}"
                                 Text="{Binding Path=Comment, Mode=OneWay}" />
                        <Label Name="LblHotkeyNameTitle"
                               Grid.Row="1"
                               Style="{StaticResource LblTitleStyle}"
                               Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblHotkeyNameTitle}" />
                        <TextBox Name="TbHotkeyName"
                                 Grid.Column="1"
                                 Grid.Row="1"
                                 Padding="{StaticResource StdPadding}"
                                 Style="{StaticResource TbBaseStyle}"
                                 Text="{Binding Path=Name, Mode=OneWay}" />
                        <Label Name="LblHotkeyHotkeyTitle"
                               Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblHotkeyHotkeyTitle}"
                               Grid.Row="2"
                               Style="{StaticResource LblTitleStyle}"
                               VerticalAlignment="Top" />
                        <Grid Grid.Column="1"
                              Grid.Row="2">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="1*" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBox Name="TbHotkeyHotkey"
                                     Grid.ColumnSpan="3"
                                     Padding="{StaticResource StdPadding}"
                                     Style="{StaticResource TbBaseStyle}"
                                     Text="{Binding Path=Hotkey, Mode=OneWay}" />
                            <Label Name="LblHotkeyModifierDisplayTitle"
                                   Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblHotkeyModifierDisplayTitle}"
                                   Grid.Row="1"
                                   Style="{StaticResource LblBaseStyle}" />
                            <RadioButton Name="RbHotkeyModifierDisplayCode"
                                         Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentRbHotkeyModifierDisplayCode}"
                                         Grid.Column="1"
                                         Style="{StaticResource RbHkModifierStyle}"/>
                            <RadioButton Name="RbHotkeyModifierDisplayName"
                                         Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentRbHotkeyModifierDisplayName}"
                                         Grid.Column="2"
                                         Style="{StaticResource RbHkModifierStyle}" />
                            <ItemsControl Name="IcHotkeyModifierkeys"
                                          Grid.ColumnSpan="3"
                                          Grid.Row="2"
                                          ItemsSource="{Binding Source={StaticResource CvsHotkeyModifierKeys}}"
                                          Style="{StaticResource IcBaseStyle}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel MaxWidth="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=ActualWidth}"
                                                   Orientation="Horizontal" />
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Label Margin="{StaticResource StdMargin}"
                                               VerticalContentAlignment="Center">
                                            <Label.Style>
                                                <Style TargetType="Label">
                                                    <Setter Property="Background"
                                                            Value="Transparent" />
                                                    <Setter Property="Content"
                                                            Value="{Binding Path=LocalizedTtTitle}" />
                                                    <Setter Property="Tag"
                                                            Value="{Binding Path=Name}" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Path=Used}"
                                                                     Value="True">
                                                            <Setter Property="Background"
                                                                    Value="LightGreen" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding ElementName=RbHotkeyModifierDisplayCode, Path=IsChecked}"
                                                                     Value="True">
                                                            <Setter Property="Content"
                                                                    Value="{Binding Path=Name}" />
                                                            <Setter Property="Tag"
                                                                    Value="{Binding Path=LocalizedTtTitle}" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Label.Style>
                                            <Label.ToolTip>
                                                <ToolTip MaxWidth="250">
                                                    <ToolTip.ContentTemplate>
                                                        <DataTemplate>
                                                            <Grid>
                                                                <Grid.RowDefinitions>
                                                                    <RowDefinition Height="Auto" />
                                                                    <RowDefinition Height="Auto" />
                                                                </Grid.RowDefinitions>
                                                                <TextBlock FontSize="13"
                                                                           FontWeight="Bold"
                                                                           Text="{Binding RelativeSource={RelativeSource AncestorType=Label}, Path=Tag}" />
                                                                <TextBlock Grid.Row="1"
                                                                           Text="{Binding RelativeSource={RelativeSource AncestorType=Label}, Path=DataContext.LocalizedTt}"
                                                                           TextWrapping="Wrap" />
                                                            </Grid>
                                                        </DataTemplate>
                                                    </ToolTip.ContentTemplate>
                                                </ToolTip>
                                            </Label.ToolTip>
                                        </Label>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </Grid>
                        <Label Name="LblHotkeyCodeTitle"
                               Grid.Row="3"
                               Style="{StaticResource LblTitleStyle}"
                               Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblHotkeyCodeTitle}" />
                        <TextBox Name="TbHotkeyCode"
                                 Grid.Column="1"
                                 Grid.Row="3"
                                 Padding="{StaticResource StdPadding}"
                                 Style="{StaticResource TbBaseStyle}"
                                 Text="{Binding Path=HotkeyCode, Mode=OneWay}" />
                    </Grid>
                    <Grid Name="GridHokeyOps"
                          Grid.Column="1"
                          Grid.Row="2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <ScrollViewer Grid.ColumnSpan="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=ColumnDefinitions.Count}"
                                      MaxHeight="200"
                                      Style="{StaticResource SvBaseStyle}">
                            <ItemsControl Name="IcHotkeyInfo"
                                          ItemsSource="{Binding Source={StaticResource CvsHotkeyMessageQueue}}"
                                          Margin="0"
                                          Style="{StaticResource IcMessages}" />
                        </ScrollViewer>
                        <Button Name="BtnHotkeySave"
                                Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnHotkeySave}"
                                Grid.Row="1"
                                IsEnabled="{Binding ElementName=GridHotkey, Path=DataContext.HasChanged, FallbackValue=False}"
                                Style="{StaticResource BtnBaseStyle}" />
                        <Button Name="BtnAddHotkeyForExtraction"
                                Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnAddHotkeyForExtraction}"
                                Grid.Column="1"
                                Grid.Row="1"
                                Style="{StaticResource BtnOpsStyle}" />
                        <Button Name="BtnHotkeyRemove"
                                Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnHotkeyRemove}"
                                Grid.Column="2"
                                Grid.Row="1"
                                Style="{StaticResource BtnOpsStyle}" />
                    </Grid>
                </Grid>
            </TabItem>
            <TabItem Name="TiHotstrings"
                     Header="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTiHotstringsHeader}"
                     Style="{StaticResource TiDefaultStyle}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="{StaticResource ObjListColumnWidth}" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="1*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid Grid.RowSpan="2">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Label Name="LblHotstringSystemsListTitle"
                               Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblHotstringSystemsListTitle}"
                               Style="{StaticResource LblTitleStyle}" />
                        <ListView Name="LvHotstrings"
                                  DisplayMemberPath="Name"
                                  Grid.Row="2"
                                  ItemsSource="{Binding Source={StaticResource CvsHotstrings}}"
                                  Style="{StaticResource LvBaseStyle}" />
                        <ComboBox Name="CbHotstringSystems"
                                  Grid.Row="1"
                                  ItemsSource="{Binding Source={StaticResource CvsHotstringSystemList}}"
                                  Margin="{StaticResource StdMargin}"
                                  Style="{StaticResource CbBaseStyle}" />
                    </Grid>
                    <ScrollViewer Grid.Column="1"
                                  HorizontalScrollBarVisibility="Disabled"
                                  VerticalScrollBarVisibility="Auto">
                        <Grid Name="GridHotstring"
                              DataContext="{Binding ElementName=LvHotstrings, Path=SelectedItem, Mode=OneWay}">
                            <Grid.Style>
                                <Style TargetType="Grid">
                                    <Setter Property="IsEnabled"
                                            Value="True" />
                                    <Style.Triggers>
                                        <Trigger Property="DataContext"
                                                 Value="{x:Null}">
                                            <Setter Property="IsEnabled"
                                                    Value="False" />
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </Grid.Style>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="1*" />
                            </Grid.RowDefinitions>
                            <Label Name="LblHotstringCommentTitle"
                                   Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblHotstringCommentTitle}"
                                   Style="{StaticResource LblTitleStyle}" />
                            <TextBox Name="TbHotstringComment"
                                     Grid.Column="1"
                                     Style="{StaticResource TbBaseStyle}"
                                     Text="{Binding Path=Comment, Mode=OneWay}" />
                            <Label Name="LblHotstringNameTitle"
                                   Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblHotstringNameTitle}"
                                   Grid.Row="1"
                                   Style="{StaticResource LblTitleStyle}" />
                            <TextBox Name="TbHotstringName"
                                     Grid.Column="1"
                                     Style="{StaticResource TbBaseStyle}"
                                     Text="{Binding Path=Name, Mode=OneWay}" />
                            <Label Name="LblHotstringSystemTitle"
                                   Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblHotstringSystemTitle}"
                                   Grid.Row="2"
                                   Style="{StaticResource LblTitleStyle}" />
                            <ComboBox Name="CbHotstringListOfSystems"
                                      Grid.Column="1"
                                      Grid.Row="2"
                                      IsEditable="True"
                                      ItemsSource="{Binding Source={StaticResource CvsHotstringListOfSystems}}"
                                      Style="{StaticResource CbBaseStyle}"
                                      Text="{Binding Path=System, Mode=OneWay}" />
                            <Label Name="LblHotstringMenuItemTitle"
                                   Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblHotstringMenuItemTitle}"
                                   Grid.Row="3"
                                   Style="{StaticResource LblTitleStyle}" />
                            <TextBox Name="TbHotstringMenuTitle"
                                     Grid.Column="1"
                                     Grid.Row="3"
                                     Style="{StaticResource TbBaseStyle}"
                                     Text="{Binding Path=MenuTitle, Mode=OneWay}" />
                            <Label Name="LblAdvancedHotstringTitle"
                                   Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblAdvancedHotstringTitle}"
                                   Grid.Row="4"
                                   Style="{StaticResource LblTitleStyle}" />
                            <CheckBox Name="CbAdvancedHotstring"
                                      Grid.Column="1"
                                      Grid.Row="4"
                                      IsChecked="{Binding Path=IsAdvanced, Mode=OneWay}"
                                      IsThreeState="False"
                                      Margin="{StaticResource StdMargin}"
                                      VerticalContentAlignment="Center">
                                <CheckBox.Style>
                                    <Style TargetType="CheckBox"
                                           BasedOn="{StaticResource ChbBaseStyle}">
                                        <Setter Property="IsChecked"
                                                Value="{Binding Path=IsAdvanced, Mode=OneWay}" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Path=IsAdvanced}"
                                                         Value="{x:Null}">
                                                <Setter Property="IsChecked"
                                                        Value="False" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </CheckBox.Style>
                            </CheckBox>
                            <Expander Name="ExpHotstringOptions"
                                      Grid.ColumnSpan="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=ColumnDefinitions.Count}"
                                      Grid.Row="5"
                                      HorizontalAlignment="Stretch"
                                      Margin="{StaticResource StdMargin}">
                                <Expander.Resources>
                                    <CollectionViewSource x:Key="CvsHotstringOptions"
                                                          IsLiveSortingRequested="True"
                                                          Source="{Binding Path=Options, Mode=OneWay}">
                                        <CollectionViewSource.SortDescriptions>
                                            <ComponentModel:SortDescription Direction="Ascending"
                                                                            PropertyName="Name" />
                                        </CollectionViewSource.SortDescriptions>
                                    </CollectionViewSource>
                                </Expander.Resources>
                                <Expander.Header>
                                    <Grid HorizontalAlignment="Stretch">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Label Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentExpHotstringOptions}"
                                               HorizontalAlignment="Stretch"
                                               Style="{StaticResource LblTitleStyle}" />
                                        <Button Name="BtnAddHsOption"
                                                Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnAddHsOption}"
                                                Grid.Column="1">
                                            <Button.Style>
                                                <Style TargetType="Button"
                                                       BasedOn="{StaticResource BtnBaseStyle}">
                                                    <Setter Property="Visibility"
                                                            Value="Visible" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Expander}, Path=IsExpanded}"
                                                                     Value="False">
                                                            <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Button.Style>
                                            <Button.ContextMenu>
                                                <ContextMenu Name="CmFuncAddSetting"
                                                             ItemsSource="{Binding Source={StaticResource CvsHsOptionsCollection}}">
                                                    <ContextMenu.Resources>
                                                        <Style TargetType="MenuItem">
                                                            <EventSetter Event="Click" />
                                                            <Setter Property="Header"
                                                                    Value="{Binding Path=Name}" />
                                                            <Setter Property="ToolTip">
                                                                <Setter.Value>
                                                                    <ToolTip StaysOpen="True"
                                                                             Width="250">
                                                                        <TextBlock Text="{Binding Path=Tt}"
                                                                                   TextWrapping="Wrap" />
                                                                    </ToolTip>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </Style>
                                                    </ContextMenu.Resources>
                                                </ContextMenu>
                                            </Button.ContextMenu>
                                        </Button>
                                    </Grid>
                                </Expander.Header>
                                <ItemsControl Name="IcHotstringOptions"
                                              ItemsSource="{Binding Source={StaticResource CvsHotstringOptions}}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <CheckBox Content="{Binding Path=Name}"
                                                      IsChecked="{Binding Path=IsUsed}"
                                                      Style="{StaticResource ChbHsOptionStyle}">
                                                <CheckBox.ToolTip>
                                                    <ToolTip StaysOpen="True"
                                                             Width="250">
                                                        <ToolTip.ContentTemplate>
                                                            <DataTemplate>
                                                                <TextBlock TextWrapping="Wrap">
                                                                        <Run FontWeight="Bold"
                                                                             Text="{Binding RelativeSource={RelativeSource AncestorType=CheckBox}, Path=DataContext.OptionCode}" />
                                                                        <Run Text="&#x0a;" />
                                                                        <Run Text="&#x0a;" />
                                                                        <Run Text="{Binding RelativeSource={RelativeSource AncestorType=CheckBox}, Path=DataContext.Tt}" />
                                                                </TextBlock>
                                                            </DataTemplate>
                                                        </ToolTip.ContentTemplate>
                                                    </ToolTip>
                                                </CheckBox.ToolTip>
                                            </CheckBox>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <WrapPanel Orientation="Horizontal" />
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                </ItemsControl>
                            </Expander>
                            <Grid Grid.ColumnSpan="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=ColumnDefinitions.Count}"
                                  Grid.Row="6">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Label Name="LblHotstringCodeTitle"
                                       Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblHotstringCodeTitle}"
                                       Style="{StaticResource LblTitleStyle}" />
                                <Label Name="LblHotstringCodeCharLimit"
                                       Grid.Column="2"
                                       HorizontalAlignment="Right"
                                       Margin="{StaticResource StdMargin}"
                                       ToolTip="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTtLblHotstringCodeCharLimit}"
                                       VerticalContentAlignment="Center">
                                    <Label.Style>
                                        <Style TargetType="Label">
                                            <Setter Property="Visibility"
                                                    Value="Collapsed" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding ElementName=TbHotstringCode, Path=MaxLength}"
                                                             Value="5000">
                                                    <Setter Property="Visibility"
                                                            Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Label.Style>
                                    <TextBlock>
                                        <Run Text="{Binding ElementName=TbHotstringCode, Path=Text.Length, Mode=OneWay}" />
                                        <Run Text=" / " />
                                        <Run Text="{Binding ElementName=TbHotstringCode, Path=MaxLength, Mode=OneWay}" />
                                    </TextBlock>
                                </Label>
                            </Grid>
                            <TextBox Name="TbHotstringCode"
                                     AcceptsTab="True"
                                     AcceptsReturn="True"
                                     Grid.ColumnSpan="2"
                                     Grid.Row="7"
                                     HorizontalScrollBarVisibility="Disabled"
                                     Style="{StaticResource TbBaseStyle}"
                                     Text="{Binding Path=Value, Mode=OneWay}"
                                     TextWrapping="Wrap"
                                     VerticalContentAlignment="Top"
                                     VerticalScrollBarVisibility="Auto" />
                        </Grid>
                    </ScrollViewer>
                    <Grid Name="GridHotstringOps"
                          Grid.Column="1"
                          Grid.Row="2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <ScrollViewer Grid.ColumnSpan="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=ColumnDefinitions.Count}"
                                      MaxHeight="200"
                                      Style="{StaticResource SvBaseStyle}">
                            <ItemsControl Name="IcHotstringInfo"
                                          ItemsSource="{Binding Source={StaticResource CvsHotstringMessageQueue}}"
                                          Margin="0"
                                          Style="{StaticResource IcMessages}" />
                        </ScrollViewer>
                        <Button Name="BtnHotstringSave"
                                Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnHotstringSave}"
                                Grid.Row="1"
                                IsEnabled="{Binding ElementName=GridHotstring, Path=DataContext.HasChanged, FallbackValue=False}"
                                Style="{StaticResource BtnBaseStyle}" />
                        <Button Name="BtnAddHotstringForExtraction"
                                Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnAddHotstringForExtraction}"
                                Grid.Column="1"
                                Grid.Row="1"
                                Style="{StaticResource BtnOpsStyle}" />
                        <Button Name="BtnHotstringRemove"
                                Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnHotstringRemove}"
                                Grid.Column="2"
                                Grid.Row="1"
                                Style="{StaticResource BtnOpsStyle}" />
                    </Grid>
                </Grid>
            </TabItem>
            <TabItem Name="TiVariables"
                     Header="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTiVariables}"
                     Style="{StaticResource TiDefaultStyle}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="{StaticResource ObjListColumnWidth}" />
                        <ColumnDefinition Width="1*" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid Grid.RowSpan="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=RowDefinitions.Count}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="1*" />
                        </Grid.RowDefinitions>
                        <Label Name="LblVariableListTitle"
                               Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblVariableListTitle}"
                               Style="{StaticResource LblTitleStyle}" />
                        <ListView Name="LvVariables"
                                  DisplayMemberPath="Name"
                                  Grid.Row="1"
                                  Grid.RowSpan="2"
                                  ItemsSource="{Binding Source={StaticResource CvsVariables}}"
                                  Style="{StaticResource LvBaseStyle}" />
                    </Grid>
                    <Grid Name="GridVariable"
                          DataContext="{Binding ElementName=LvVariables, Path=SelectedItem, Mode=OneWay}"
                          Grid.Column="1"
                          Grid.Row="1">
                        <Grid.Style>
                            <Style TargetType="Grid">
                                <Setter Property="IsEnabled"
                                        Value="True" />
                                <Style.Triggers>
                                    <Trigger Property="DataContext"
                                             Value="{x:Null}">
                                        <Setter Property="IsEnabled"
                                                Value="False" />
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Grid.Style>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="1*" />
                        </Grid.RowDefinitions>
                        <Label Name="LblVariableCommentTitle"
                               Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblVariableCommentTitle}"
                               Style="{StaticResource LblTitleStyle}" />
                        <TextBox Name="TbVariableComment"
                                 Grid.Row="1"
                                 Style="{StaticResource TbBaseStyle}"
                                 Text="{Binding Path=Comment, Mode=OneWay}" />
                        <Label Name="LblVariableNameTitle"
                               Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblVariableNameTitle}"
                               Grid.Row="2"
                               Style="{StaticResource LblTitleStyle}" />
                        <TextBox Name="TbVariableName"
                                 Grid.Row="3"
                                 Style="{StaticResource TbBaseStyle}"
                                 Text="{Binding Path=Name, Mode=OneWay}" />
                        <Label Name="LblVariableValueTitle"
                               Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblVariableValueTitle}"
                               Grid.Row="4"
                               Style="{StaticResource LblTitleStyle}" />
                        <TextBox Name="TbVariableCode"
                                 AcceptsTab="True"
                                 Grid.Row="5"
                                 Padding="{StaticResource StdPadding}"
                                 Style="{StaticResource TbBaseStyle}"
                                 Text="{Binding Path=Value, Mode=OneWay}"
                                 VerticalContentAlignment="Top" />
                        <Grid Grid.Row="6">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <RadioButton Name="RbVariableAsLegacy"
                                         Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentRbVariableAsLegacy}"
                                         GroupName="VariableType"
                                         ToolTip="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentRbVariableAsLegacyTt}">
                                <RadioButton.Style>
                                    <Style TargetType="RadioButton"
                                           BasedOn="{StaticResource RbBaseWInfoStyle}">
                                        <Setter Property="IsChecked"
                                                Value="False" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Path=VariableType}"
                                                         Value="Legacy">
                                                <Setter Property="IsChecked"
                                                        Value="True" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </RadioButton.Style>
                            </RadioButton>
                            <RadioButton Name="RbVariableAsExpression"
                                         Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentRbVariableAsExpression}"
                                         Grid.Column="1"
                                         GroupName="VariableType"
                                         ToolTip="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentRbVariableAsExpressionTt}">
                                <RadioButton.Style>
                                    <Style TargetType="RadioButton"
                                           BasedOn="{StaticResource RbBaseWInfoStyle}">
                                        <Setter Property="IsChecked"
                                                Value="False" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Path=VariableType}"
                                                         Value="Expression">
                                                <Setter Property="IsChecked"
                                                        Value="True" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </RadioButton.Style>
                            </RadioButton>

                        </Grid>
                    </Grid>
                    <Grid Name="GridVariableOps"
                          Grid.Column="1"
                          Grid.Row="2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <ScrollViewer Grid.ColumnSpan="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=ColumnDefinitions.Count}"
                                      MaxHeight="200"
                                      Style="{StaticResource SvBaseStyle}">
                            <ItemsControl Name="IcVariableInfo"
                                          ItemsSource="{Binding Source={StaticResource CvsVariableMessageQueue}}"
                                          Margin="0"
                                          Style="{StaticResource IcMessages}" />
                        </ScrollViewer>
                        <Button Name="BtnVariableSave"
                                Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnVariableSave}"
                                Grid.Row="1"
                                IsEnabled="{Binding ElementName=GridVariable, Path=DataContext.HasChanged, FallbackValue=False}"
                                Style="{StaticResource BtnBaseStyle}" />
                        <Button Name="BtnAddVariableForExtraction"
                                Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnAddVariableForExtraction}"
                                Grid.Column="1"
                                Grid.Row="1"
                                Style="{StaticResource BtnOpsStyle}" />
                        <Button Name="BtnVariableRemove"
                                Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnVariableRemove}"
                                Grid.Column="2"
                                Grid.Row="1"
                                Style="{StaticResource BtnOpsStyle}" />
                    </Grid>
                </Grid>
            </TabItem>
            <TabItem Name="TiFunctions"
                     Header="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTiFunctions}"
                     Style="{StaticResource TiDefaultStyle}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="{StaticResource ObjListColumnWidth}" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid Grid.RowSpan="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=RowDefinitions.Count}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition />
                        </Grid.RowDefinitions>
                        <Label Name="LblFunctionsListTitle"
                               Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblFunctionsListTitle}"
                               Style="{StaticResource LblTitleStyle}"
                               Grid.ColumnSpan="2"
                               Margin="5,5,5,5" />
                        <ListView Name="LvFunctions"
                                  DisplayMemberPath="Name"
                                  Grid.Row="1"
                                  Grid.RowSpan="2"
                                  ItemsSource="{Binding Source={StaticResource CvsFunctions}}"
                                  Style="{StaticResource LvBaseStyle}"
                                  Grid.ColumnSpan="2"
                                  Margin="5,5,5,5" />
                    </Grid>
                    <Grid Name="GridFunction"
                          FocusManager.FocusedElement="{Binding ElementName=TbFunctionCode}"
                          DataContext="{Binding ElementName=LvFunctions, Path=SelectedItem, Mode=OneWay}"
                          Grid.Column="2"
                          Grid.RowSpan="2">
                        <Grid.Style>
                            <Style TargetType="Grid">
                                <Setter Property="IsEnabled"
                                        Value="True" />
                                <Style.Triggers>
                                    <Trigger Property="DataContext"
                                             Value="{x:Null}">
                                        <Setter Property="IsEnabled"
                                                Value="False" />
                                    </Trigger>
                                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=DataContext.New}"
                                                 Value="True">
                                        <Setter Property="FocusManager.FocusedElement"
                                                Value="{Binding ElementName=TbFunctionName}" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Grid.Style>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="1*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="1*" />
                        </Grid.RowDefinitions>
                        <Label Name="LblFunctionCommentTitle"
                               Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblFunctionCommentTitle}"
                               Style="{StaticResource LblTitleStyle}" />
                        <TextBox Name="TbFunctionComment"
                                 Grid.Column="1"
                                 Style="{StaticResource TbBaseStyle}"
                                 Text="{Binding Path=Comment, Mode=OneWay}" />
                        <Label Name="LblFunctionNameTitle"
                               Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblFunctionNameTitle}"
                               Grid.Row="1"
                               Style="{StaticResource LblTitleStyle}" />
                        <TextBox Name="TbFunctionName"
                                 Grid.Column="1"
                                 Grid.Row="1"
                                 Style="{StaticResource TbBaseStyle}"
                                 Text="{Binding Path=Name, Mode=OneWay}" />
                        <Expander Name="ExpParameters"
                                  Grid.Column="2"
                                  Header="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentExpParameters}">
                            <Expander.Style>
                                <Style TargetType="Expander">
                                    <Setter Property="Grid.RowSpan"
                                            Value="1" />
                                    <Setter Property="IsExpanded"
                                            Value="True" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ElementName=IcFunctionParameterList, Path=Items.Count}"
                                                     Value="0">
                                            <Setter Property="IsExpanded"
                                                    Value="False" />
                                        </DataTrigger>
                                        <Trigger Property="IsExpanded"
                                                 Value="True">
                                            <Setter Property="Grid.RowSpan"
                                                    Value="{Binding ElementName=GridFunction, Path=RowDefinitions.Count}" />
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </Expander.Style>
                            <Grid Name="GridFuncParameters">
                                <Grid.Resources>
                                    <CollectionViewSource x:Key="CvsFuncParameters"
                                                          IsLiveFilteringRequested="True"
                                                          Source="{Binding Path=ParameterList}" />
                                </Grid.Resources>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <Button Name="BtnFunctionAddParameter"
                                        Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnFunctionAddParameter}"
                                        Style="{StaticResource BtnBaseStyle}"
                                        VerticalAlignment="Top" />
                                <ScrollViewer Grid.Row="2"
                                              HorizontalScrollBarVisibility="Disabled"
                                              VerticalScrollBarVisibility="Auto">
                                    <ItemsControl Name="IcFunctionParameterList"
                                                  ItemsSource="{Binding Source={StaticResource CvsFuncParameters}}">
                                        <ItemsControl.Resources>
                                            <sys:Double x:Key="ButtonSize">15</sys:Double>
                                            <Style TargetType="Button"
                                                   x:Key="BtnRemoveParam">
                                                <EventSetter Event="Click" />
                                                <Setter Property="Grid.Column"
                                                        Value="1" />
                                                <Setter Property="Height"
                                                        Value="{StaticResource ButtonSize}" />
                                                <Setter Property="Padding"
                                                        Value="-2" />
                                                <Setter Property="VerticalContentAlignment"
                                                        Value="Center" />
                                                <Setter Property="Width"
                                                        Value="{StaticResource ButtonSize}" />
                                            </Style>
                                            <Style TargetType="TextBox"
                                                   x:Key="TbParamStyle"
                                                   BasedOn="{StaticResource TbBaseStyle}">
                                                <EventSetter Event="TextChanged" />
                                            </Style>
                                        </ItemsControl.Resources>
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="1*" />
                                                        <ColumnDefinition Width="Auto" />
                                                    </Grid.ColumnDefinitions>
                                                    <TextBox Style="{StaticResource TbParamStyle}"
                                                             Text="{Binding Path=Name, Mode=OneWay, FallbackValue=OriginalName}" />
                                                    <Button Style="{StaticResource BtnRemoveParam}">
                                                        <Button.Content>
                                                            <TextBlock Margin="0"
                                                                       Text="x" />
                                                        </Button.Content>
                                                    </Button>
                                                </Grid>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </ScrollViewer>
                            </Grid>
                        </Expander>
                        <Label Name="LblFunctionHeaderTitle"
                               Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblFunctionHeaderTitle}"
                               Grid.ColumnSpan="2"
                               Grid.Row="2"
                               Style="{StaticResource LblTitleStyle}" />
                        <TextBlock Name="TblFunctionHeader"
                                   Grid.ColumnSpan="2"
                                   Grid.Row="3"
                                   Margin="{StaticResource StdMargin}"
                                   TextWrapping="Wrap" />
                        <Label Name="LblFunctionCodeTitle"
                               Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblFunctionCodeTitle}"
                               Grid.Row="4"
                               Style="{StaticResource LblTitleStyle}" />
                        <TextBox Name="TbFunctionCode"
                                 AcceptsReturn="True"
                                 AcceptsTab="True"
                                 Grid.Row="5"
                                 Text="{Binding Path=FunctionCode, Mode=OneWay}"
                                 VerticalContentAlignment="Top">
                            <TextBox.Style>
                                <Style TargetType="TextBox"
                                       BasedOn="{StaticResource TbBaseStyle}">
                                    <Setter Property="Grid.ColumnSpan"
                                            Value="3" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ElementName=ExpParameters, Path=IsExpanded}"
                                                     Value="True">
                                            <Setter Property="Grid.ColumnSpan"
                                                    Value="2" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBox.Style>
                        </TextBox>
                    </Grid>
                    <Grid Name="GridFunctionOps"
                          Grid.Column="2"
                          Grid.Row="2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <ScrollViewer Grid.ColumnSpan="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=ColumnDefinitions.Count}"
                                      MaxHeight="200"
                                      Style="{StaticResource SvBaseStyle}">
                            <ItemsControl Name="IcFunctionInfo"
                                          ItemsSource="{Binding Source={StaticResource CvsFunctionMessageQueue}}"
                                          Margin="0"
                                          Style="{StaticResource IcMessages}" />
                        </ScrollViewer>
                        <Button Name="BtnFunctionSave"
                                Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnFunctionSave}"
                                Grid.Row="1"
                                IsEnabled="{Binding ElementName=GridFunction, Path=DataContext.HasChanged, FallbackValue=False}"
                                Style="{StaticResource BtnBaseStyle}" />
                        <Button Name="BtnAddFunctionForExtraction"
                                Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnAddFunctionForExtraction}"
                                Grid.Column="1"
                                Grid.Row="1"
                                Style="{StaticResource BtnOpsStyle}" />
                        <Button Name="BtnFunctionRemove"
                                Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnFunctionRemove}"
                                Grid.Column="2"
                                Grid.Row="1"
                                Style="{StaticResource BtnOpsStyle}" />
                    </Grid>
                </Grid>
            </TabItem>
            <TabItem Name="TiToExtract"
                     Header="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTiToExtract}"
                     Tag="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTtTiToExtractIsDisabled}">
                <TabItem.Style>
                    <Style TargetType="TabItem"
                           BasedOn="{StaticResource TiDefaultStyle}">
                        <Setter Property="IsEnabled"
                                Value="True" />
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding ElementName=LvExtractList, Path=ItemsSource.Count}"
                                         Value="0">
                                <Setter Property="IsEnabled"
                                        Value="False" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </TabItem.Style>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="1*" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="1*" />
                    </Grid.RowDefinitions>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="1*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Label Name="LblExtractCommentTitle"
                               Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblExtractCommentTitle}"
                               Style="{StaticResource LblBaseStyle}" />
                        <Button Name="BtnInsertExistingCommentForExtraction"
                                Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnInsertExistingCommentForExtraction}"
                                Grid.Column="1"
                                Style="{StaticResource BtnBaseStyle}" />
                    </Grid>
                    <TextBox Name="TbExtractComment"
                             Grid.Row="1"
                             Style="{StaticResource TbBaseStyle}"
                             VerticalContentAlignment="Top" />
                    <Label Name="LblExtractListTitle"
                           Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblExtractListTitle}"
                           Grid.Row="2"
                           Style="{StaticResource LblBaseStyle}" />
                    <ListView Name="LvExtractList"
                              Grid.Row="3"
                              ItemsSource="{Binding Source={StaticResource CvsToExtract}}"
                              Style="{StaticResource LvBaseStyle}">
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="20" />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>
                                    <Path Fill="Black"
                                          Height="20"
                                          Margin="0,5,0,0"
                                          MaxHeight="20"
                                          Stroke="Black"
                                          StrokeThickness="1">
                                        <Path.RenderTransform>
                                            <ScaleTransform ScaleX="0.75"
                                                            ScaleY="0.715" />
                                        </Path.RenderTransform>
                                        <Path.Style>
                                            <Style TargetType="Path">
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding Path=Type}"
                                                                 Value="Function">
                                                        <Setter Property="Data"
                                                                Value="M15.6,5.29C14.5,5.19 13.53,6 13.43,7.11L13.18,10H16V12H13L12.56,17.07C12.37,19.27 10.43,20.9 8.23,20.7C6.92,20.59 5.82,19.86 5.17,18.83L6.67,17.33C6.91,18.07 7.57,18.64 8.4,18.71C9.5,18.81 10.47,18 10.57,16.89L11,12H8V10H11.17L11.44,6.93C11.63,4.73 13.57,3.1 15.77,3.3C17.08,3.41 18.18,4.14 18.83,5.17L17.33,6.67C17.09,5.93 16.43,5.36 15.6,5.29Z" />
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding Path=Type}"
                                                                 Value="Hotkey">
                                                        <Setter Property="Data"
                                                                Value="M9,20H8V11H3V20H2V2H3V10H8V2H9ZM19,20H18V18H17V16H16V15H15V14H14V13H13V11H12V20H11V2H12V10H13V9H14V8H15V7H16V5H17V2H18V5H17V7H16V8H15V9H14V12H15V13H16V15H17V16H18V18H19Z" />
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding Path=Type}"
                                                                 Value="Hotstring">
                                                        <Setter Property="Data"
                                                                Value="M10,17H9V11H3V17H2V4H3V10H9V4H10ZM18,17H14V16H13V14H14V16H17V15H18V11H16V10H14V9H13V6H14V5H15V4H18V5H19V7H18V5H15V6H14V9H17V10H18V11H19V16H18Z" />
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding Path=Type}"
                                                                 Value="Variable">
                                                        <Setter Property="Data"
                                                                Value="M20.41,3C21.8,5.71 22.35,8.84 22,12C21.8,15.16 20.7,18.29 18.83,21L17.3,20C18.91,17.57 19.85,14.8 20,12C20.34,9.2 19.89,6.43 18.7,4L20.41,3M5.17,3L6.7,4C5.09,6.43 4.15,9.2 4,12C3.66,14.8 4.12,17.57 5.3,20L3.61,21C2.21,18.29 1.65,15.17 2,12C2.2,8.84 3.3,5.71 5.17,3M12.08,10.68L14.4,7.45H16.93L13.15,12.45L15.35,17.37H13.09L11.71,14L9.28,17.33H6.76L10.66,12.21L8.53,7.45H10.8L12.08,10.68Z" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Path.Style>
                                    </Path>
                                    <Label Content="{Binding Path=Name}"
                                           Grid.Column="1" />
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                        <ListView.Resources>
                            <sys:Double x:Key="ImgSize">13</sys:Double>
                            <Style TargetType="TextBlock">
                                <Setter Property="Margin"
                                        Value="15,2,2,2" />
                                <Setter Property="VerticalAlignment"
                                        Value="Center" />
                            </Style>
                        </ListView.Resources>
                    </ListView>
                    <Grid Grid.Column="1"
                          Grid.Row="1"
                          Grid.RowSpan="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=RowDefinitions.Count}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Button Name="BtnRemoveFromExtractList"
                                Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnRemoveFromExtractList}"
                                HorizontalAlignment="Left">
                            <Button.Style>
                                <Style TargetType="Button"
                                       BasedOn="{StaticResource BtnBaseStyle}">
                                    <Setter Property="IsEnabled"
                                            Value="True" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ElementName=LvExtractList, Path=SelectedItems.Count}"
                                                     Value="0">
                                            <Setter Property="IsEnabled"
                                                    Value="False" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                        </Button>
                        <Button Name="BtnCancelExtraction"
                                Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnCancelExtraction}"
                                Grid.Row="1"
                                HorizontalAlignment="Left"
                                Style="{StaticResource BtnBaseStyle}" />
                        <TextBlock Name="TblScriptExtractionTargetTitle"
                                   FontSize="15"
                                   FontWeight="Bold"
                                   Grid.Row="2"
                                   Style="{StaticResource TblBaseStyle}"
                                   Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblScriptExtractionTargetTitle}" />
                        <TextBlock Name="TblScriptExtractionTarget"
                                   Grid.Row="3"
                                   Style="{StaticResource TblBaseStyle}" />
                        <TextBlock Name="TblBackupExtractionTargetTitle"
                                   FontSize="15"
                                   FontWeight="Bold"
                                   Grid.Row="4"
                                   Style="{StaticResource TblBaseStyle}"
                                   Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblBackupExtractionTargetTitle}" />
                        <TextBlock Name="TblBackupExtractionTarget"
                                   Grid.Row="5"
                                   Style="{StaticResource TblBaseStyle}" />
                        <ItemsControl Name="IcExtractionInfo"
                                      Grid.Row="6"
                                      ItemsSource="{Binding Source={StaticResource CvsExtractionMessageQueue}}"
                                      Style="{StaticResource IcMessages}" />
                    </Grid>
                </Grid>
            </TabItem>
            <TabItem Name="TiImport"
                     Header="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTiImport}"
                     Style="{StaticResource TiDefaultStyle}">
                <Grid Name="GridImport">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition />
                    </Grid.RowDefinitions>
                    <Grid Grid.ColumnSpan="3">
                        <Grid.Style>
                            <Style TargetType="Grid">
                                <Setter Property="Background"
                                        Value="Transparent" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=IsMouseOver}"
                                                 Value="True">
                                        <Setter Property="Background">
                                            <Setter.Value>
                                                <LinearGradientBrush StartPoint="0,0"
                                                                     EndPoint="0,1">
                                                    <GradientStop Color="Transparent"
                                                                  Offset="0.7" />
                                                    <GradientStop Color="Black"
                                                                  Offset="1.4" />
                                                </LinearGradientBrush>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Grid.Style>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Label Name="LblFileToImportTitle"
                               Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentLblFileToImportTitle}"
                               FontWeight="Bold"
                               Style="{StaticResource LblBaseStyle}" />
                        <TextBox Name="TbFilePathToImport"
                                 Grid.Column="1"
                                 Grid.ColumnSpan="2"
                                 Style="{StaticResource TbBaseStyle}"
                                 Text="{Binding Path=FileToImportPath}" />
                        <Button Name="BtnSelectFileToImport"
                                Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnSelectFileToImport}"
                                Grid.Row="1"
                                Style="{StaticResource BtnBaseStyle}" />
                        <Button Name="BtnReadFileToImport"
                                Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnReadFileToImport}"
                                Grid.Column="1"
                                Grid.Row="1"
                                IsEnabled="False"
                                Style="{StaticResource BtnBaseStyle}"
                                Width="{Binding ElementName=BtnSelectFileToImport, Path=ActualWidth}" />
                        <ItemsControl Name="IcImportInfo"
                                      Grid.Column="2"
                                      Grid.Row="1"
                                      Height="{Binding ElementName=BtnSelectFileToImport, Path=ActualHeight}"
                                      ItemsSource="{Binding Source={StaticResource CvsImportMessageQueue}}"
                                      Margin="0"
                                      MaxHeight="{Binding ElementName=BtnSelectFileToImport, Path=ActualHeight}"
                                      Style="{StaticResource IcMessages}" />
                    </Grid>
                    <Grid Grid.Column="1"
                          Grid.Row="1">
                        <Grid.Resources>
                            <sys:Double x:Key="Tr">0.5</sys:Double>
                            <Style TargetType="Border">
                                <Setter Property="BorderBrush"
                                        Value="LightGray" />
                                <Setter Property="BorderThickness"
                                        Value="1" />
                                <Setter Property="Panel.ZIndex"
                                        Value="0" />
                            </Style>
                            <Style TargetType="Grid"
                                   x:Key="GridSettings">
                                <Setter Property="Panel.ZIndex"
                                        Value="1" />
                            </Style>
                            <Style TargetType="ScrollViewer"
                                   x:Key="SvImportStyle"
                                   BasedOn="{StaticResource SvBaseStyle}">
                                <Setter Property="Grid.Row"
                                        Value="2" />
                                <Setter Property="Grid.RowSpan"
                                        Value="{Binding ElementName=GridImport, Path=RowDefinitions.Count}" />
                                <Setter Property="MaxHeight"
                                        Value="400" />
                                <Setter Property="Panel.ZIndex"
                                        Value="1" />
                                <Setter Property="VerticalAlignment"
                                        Value="Top" />
                            </Style>
                        </Grid.Resources>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="1*" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="1*" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="1*" />
                        </Grid.RowDefinitions>
                        <Grid Name="GridImpHotkeysTitle"
                              Style="{StaticResource GridSettings}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Name="TblHotkeyToImportTitle"
                                       Style="{StaticResource TblBaseStyle}"
                                       VerticalAlignment="Center">
                                            <Run FontSize="13"
                                                 FontWeight="Bold"
                                                 Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblHotkeyToImportTitle}" />
                                            <Run Text=" (" />
                                            <Run Text="{Binding ElementName=IcHotkeysToImport, Path=ItemsSource.Count, Mode=OneWay}" />
                                            <Run Text=")" />
                            </TextBlock>
                            <TextBlock Grid.Column="1">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock"
                                           BasedOn="{StaticResource TblBaseStyle}">
                                        <Setter Property="Text"
                                                Value="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentChbImpHotkeysSelectAll}" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ElementName=ChbImpHotkeysSelectAll, Path=IsChecked, BindsDirectlyToSource=True}"
                                                         Value="False">
                                                <Setter Property="Text"
                                                        Value="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentChbImpHotkeysSelectAllDeselected}" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                            <CheckBox Name="ChbImpHotkeysSelectAll"
                                      Grid.Column="2"
                                      Style="{StaticResource ChbBaseStyle}" />
                        </Grid>
                        <ScrollViewer  Name="SvImpHotkeys"
                                       Grid.Row="1"
                                       Style="{StaticResource SvImportStyle}">
                            <ItemsControl Name="IcHotkeysToImport"
                                          ItemsSource="{Binding Source={StaticResource CvsImportHotkeys}}"
                                          Style="{StaticResource IcImport}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Grid Style="{StaticResource GridImportItemStyle}"
                                              ToolTip="{Binding Path=Hotkey}">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="1*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <CheckBox />
                                            <TextBlock />
                                            <Grid Style="{StaticResource GridImportError}">
                                                <Ellipse />
                                                <Path />
                                            </Grid>
                                        </Grid>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                        <Border Grid.Column="1"
                                Grid.RowSpan="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=RowDefinitions.Count}" />
                        <Border Grid.Row="2"
                                Grid.ColumnSpan="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=ColumnDefinitions.Count}" />
                        <Border Grid.Row="5"
                                Grid.ColumnSpan="{Binding RelativeSource={RelativeSource AncestorType=Grid}, Path=ColumnDefinitions.Count}" />
                        <Grid Name="GridImpHotstringsTitle"
                              Grid.Column="2"
                              Style="{StaticResource GridSettings}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Name="TblHotstringToImportTitle"
                                       Style="{StaticResource TblBaseStyle}"
                                       VerticalAlignment="Center">
                                            <Run FontSize="13"
                                                 FontWeight="Bold"
                                                 Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblHotstringToImportTitle}" />
                                            <Run Text=" (" />
                                            <Run Text="{Binding ElementName=IcHotstringsToImport, Path=ItemsSource.Count, Mode=OneWay}" />
                                            <Run Text=")" />
                            </TextBlock>
                            <TextBlock Grid.Column="1">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock"
                                           BasedOn="{StaticResource TblBaseStyle}">
                                        <Setter Property="Text"
                                                Value="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentChbImpHotstringsSelectAll}" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ElementName=ChbImpHotstringsSelectAll, Path=IsChecked}"
                                                         Value="False">
                                                <Setter Property="Text"
                                                        Value="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentChbImpHotstringsSelectAllDeselected}" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                            <CheckBox Name="ChbImpHotstringsSelectAll"
                                      Grid.Column="2"
                                      Style="{StaticResource ChbBaseStyle}" />
                        </Grid>
                        <ScrollViewer  Name="SvImpHotstrings"
                                       Grid.Column="2"
                                       Grid.Row="1"
                                       Style="{StaticResource SvImportStyle}">
                            <ItemsControl Name="IcHotstringsToImport"
                                          ItemsSource="{Binding Source={StaticResource CvsImportHotstrings}}"
                                          Style="{StaticResource IcImport}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Grid Style="{StaticResource GridImportItemStyle}"
                                              ToolTip="{Binding Path=Value}">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="1*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <CheckBox />
                                            <TextBlock />
                                            <Grid Style="{StaticResource GridImportError}">
                                                <Ellipse />
                                                <Path />
                                            </Grid>
                                        </Grid>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                        <Grid Name="GridImpVariablesTitle"
                              Grid.Row="3"
                              Style="{StaticResource GridSettings}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Name="TblVariablesToImportTitle"
                                       Style="{StaticResource TblBaseStyle}"
                                       VerticalAlignment="Center">
                                            <Run FontSize="13"
                                                 FontWeight="Bold"
                                                 Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblVariablesToImportTitle}" />
                                            <Run Text=" (" />
                                            <Run Text="{Binding ElementName=IcVariablesToImport, Path=ItemsSource.Count, Mode=OneWay}" />
                                            <Run Text=")" />
                            </TextBlock>
                            <TextBlock Grid.Column="1">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock"
                                           BasedOn="{StaticResource TblBaseStyle}">
                                        <Setter Property="Text"
                                                Value="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentChbImpVariablesSelectAll}" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ElementName=ChbImpVariablesSelectAll, Path=IsChecked}"
                                                         Value="False">
                                                <Setter Property="Text"
                                                        Value="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentChbImpVariablesSelectAllDeselected}" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                            <CheckBox Name="ChbImpVariablesSelectAll"
                                      Grid.Column="2"
                                      Style="{StaticResource ChbBaseStyle}" />
                        </Grid>
                        <ScrollViewer Name="SvImpVariables"
                                      Grid.Row="4"
                                      Style="{StaticResource SvImportStyle}">
                            <ItemsControl Name="IcVariablesToImport"
                                          ItemsSource="{Binding Source={StaticResource CvsImportVariables}}"
                                          Style="{StaticResource IcImport}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Grid Style="{StaticResource GridImportItemStyle}"
                                              ToolTip="{Binding Path=Value}">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="1*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <CheckBox />
                                            <TextBlock />
                                            <Grid Style="{StaticResource GridImportError}">
                                                <Ellipse />
                                                <Path />
                                            </Grid>
                                        </Grid>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                        <Grid Name="GridImpFunctionsTitle"
                              Grid.Column="2"
                              Grid.Row="3"
                              Style="{StaticResource GridSettings}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Name="TblFunctionsToImportTitle"
                                       Style="{StaticResource TblBaseStyle}"
                                       VerticalAlignment="Center">
                                            <Run FontSize="13"
                                                 FontWeight="Bold"
                                                 Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblFunctionsToImportTitle}" />
                                            <Run Text=" (" />
                                            <Run Text="{Binding ElementName=IcFunctionsToImport, Path=ItemsSource.Count, Mode=OneWay}" />
                                            <Run Text=")" />
                            </TextBlock>
                            <TextBlock Grid.Column="1">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock"
                                           BasedOn="{StaticResource TblBaseStyle}">
                                        <Setter Property="Text"
                                                Value="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentChbImpFunctionsSelectAll}" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ElementName=ChbImpFunctionsSelectAll, Path=IsChecked}"
                                                         Value="False">
                                                <Setter Property="Text"
                                                        Value="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentChbImpFunctionsSelectAllDeselected}" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                            <CheckBox Name="ChbImpFunctionsSelectAll"
                                      Grid.Column="2"
                                      Style="{StaticResource ChbBaseStyle}" />
                        </Grid>
                        <ScrollViewer Name="SvImpFunctions"
                                      Grid.Column="2"
                                      Grid.Row="4"
                                      Style="{StaticResource SvImportStyle}">
                            <ItemsControl Name="IcFunctionsToImport"
                                          ItemsSource="{Binding Source={StaticResource CvsImportFunctions}}"
                                          Style="{StaticResource IcImport}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Grid Style="{StaticResource GridImportItemStyle}"
                                              ToolTip="{Binding Path=FunctionCode}">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="1*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <CheckBox />
                                            <TextBlock />
                                            <Grid Style="{StaticResource GridImportError}">
                                                <Ellipse />
                                                <Path />
                                            </Grid>
                                        </Grid>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                        <Grid Name="GridImpCommentTitle"
                              Background="White"
                              Panel.ZIndex="2">
                            <Grid.Style>
                                <Style TargetType="Grid"
                                       BasedOn="{StaticResource GridSettings}">
                                    <Setter Property="Grid.ColumnSpan"
                                            Value="1" />
                                    <Setter Property="Grid.Row"
                                            Value="6" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ElementName=TBtnExpandImpComment, Path=IsChecked}"
                                                     Value="True">
                                            <Setter Property="Grid.Row"
                                                    Value="0" />
                                            <Setter Property="Grid.ColumnSpan"
                                                    Value="3" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Grid.Style>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Name="TblCommentToImportTitle"
                                       FontSize="13"
                                       FontWeight="Bold"
                                       Style="{StaticResource TblBaseStyle}"
                                       Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblCommentToImportTitle}"
                                       VerticalAlignment="Center" />
                            <TextBlock Grid.Column="1"
                                       Style="{StaticResource TblBaseStyle}"
                                       Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentChbImpComment}" />
                            <CheckBox Name="ChbImpComment"
                                      Grid.Column="2"
                                      Style="{StaticResource ChbBaseStyle}" />
                        </Grid>
                        <Grid Name="GridImpComment"
                              Panel.ZIndex="2">
                            <Grid.Style>
                                <Style TargetType="Grid"
                                       BasedOn="{StaticResource GridSettings}">
                                    <Setter Property="Grid.ColumnSpan"
                                            Value="1" />
                                    <Setter Property="Grid.RowSpan"
                                            Value="1" />
                                    <Setter Property="Grid.Row"
                                            Value="7" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ElementName=TBtnExpandImpComment, Path=IsChecked}"
                                                     Value="True">
                                            <Setter Property="Grid.Row"
                                                    Value="1" />
                                            <Setter Property="Grid.ColumnSpan"
                                                    Value="3" />
                                            <Setter Property="Grid.RowSpan"
                                                    Value="8" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Grid.Style>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="1*" />
                            </Grid.RowDefinitions>
                            <TextBox Name="TbImpComment"
                                     BorderBrush="Red"
                                     Grid.ColumnSpan="2"
                                     Grid.RowSpan="2"
                                     Style="{StaticResource TbBaseStyle}"
                                     VerticalContentAlignment="Top" />
                            <ToggleButton Name="TBtnExpandImpComment"
                                          Grid.Column="1"
                                          Grid.Row="0"
                                          IsChecked="False"
                                          Padding="0">
                                <Path Data="M5.64,4.22H19.78V18.36L15.54,14.12L9.88,19.78L4.22,14.12L9.88,8.46L5.64,4.22M17.66,6.34H10.59L12.71,8.46L7.05,14.12L9.88,16.95L15.54,11.29L17.66,13.41V6.34H17.66Z"
                                      Fill="Black">
                                    <Path.Style>
                                        <Style TargetType="Path">
                                            <Setter Property="Margin"
                                                    Value="0" />
                                            <Setter Property="RenderTransform">
                                                <Setter.Value>
                                                    <TransformGroup>
                                                        <ScaleTransform ScaleX="1"
                                                                        ScaleY="1" />
                                                        <TranslateTransform X="-3"
                                                                            Y="-1" />
                                                    </TransformGroup>
                                                </Setter.Value>
                                            </Setter>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=ToggleButton}, Path=IsChecked}"
                                                             Value="True">
                                                    <Setter Property="RenderTransform">
                                                        <Setter.Value>
                                                            <TransformGroup>
                                                                <ScaleTransform ScaleX="-1"
                                                                                ScaleY="-1" />
                                                                <TranslateTransform X="22"
                                                                                    Y="21" />
                                                            </TransformGroup>
                                                        </Setter.Value>
                                                    </Setter>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Path.Style>
                                </Path>
                            </ToggleButton>
                        </Grid>
                        <Grid Name="GridImpSettingsTitle"
                              Grid.Column="2"
                              Grid.Row="6"
                              Style="{StaticResource GridSettings}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="1*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Name="TblSettingsToImportTitle"
                                       Style="{StaticResource TblBaseStyle}"
                                       VerticalAlignment="Center">
                                            <Run FontSize="13"
                                                 FontWeight="Bold"
                                                 Text="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTblSettingsToImportTitle}" />
                                            <Run Text=" (" />
                                            <Run Text="{Binding ElementName=IcSettingsToImport, Path=ItemsSource.Count, Mode=OneWay}" />
                                            <Run Text=")" />
                            </TextBlock>
                            <Grid Grid.Column="1"
                                  Style="{StaticResource GridInfoStyle}"
                                  ToolTip="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTtSettingsImpWarning}">
                                <Ellipse />
                                <Path />
                            </Grid>
                            <TextBlock Grid.Column="3">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock"
                                           BasedOn="{StaticResource TblBaseStyle}">
                                        <Setter Property="Text"
                                                Value="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentChbImpSettingsSelectAll}" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ElementName=ChbImpSettingsSelectAll, Path=IsChecked}"
                                                         Value="False">
                                                <Setter Property="Text"
                                                        Value="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentChbImpSettingsSelectAllDeselected}" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                            <CheckBox Name="ChbImpSettingsSelectAll"
                                      Grid.Column="4"
                                      Style="{StaticResource ChbBaseStyle}" />
                        </Grid>
                        <ScrollViewer Name="SvImpSettings"
                                      Grid.Column="2"
                                      Grid.Row="7"
                                      Style="{StaticResource SvImportStyle}">
                            <ItemsControl Name="IcSettingsToImport"
                                          ItemsSource="{Binding Source={StaticResource CvsImportSettings}}"
                                          Style="{StaticResource IcImport}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Grid Style="{StaticResource GridImportItemStyle}"
                                              ToolTip="{Binding Path=Value}">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="1*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <CheckBox />
                                            <TextBlock />
                                            <Grid Style="{StaticResource GridImportError}">
                                                <Ellipse />
                                                <Path />
                                            </Grid>
                                        </Grid>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                    </Grid>
                    <StackPanel Name="SpImpOpButtons"
                                Grid.Row="1"
                                IsEnabled="False">
                        <Button Name="BtnSelectAll"
                                Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnSelectAll}"
                                Style="{StaticResource BtnImpOps}" />
                        <Button Name="BtnDeselectAll"
                                Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnDeselectAll}"
                                Style="{StaticResource BtnImpOps}" />
                        <Button Name="BtnStartImport"
                                Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnStartImport}"
                                Style="{StaticResource BtnImpOps}" />
                        <Button Name="BtnAbortImport"
                                Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnAbortImport}"
                                Style="{StaticResource BtnImpOps}" />
                    </StackPanel>
                </Grid>
            </TabItem>
            <TabItem Name="TiSettings"
                     Header="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTiSettings}"
                     Style="{StaticResource TiDefaultStyle}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <ScrollViewer HorizontalScrollBarVisibility="Disabled"
                                  Margin="{StaticResource StdMargin}"
                                  VerticalScrollBarVisibility="Auto">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <GroupBox Name="GbSettingsFiles"
                                      Header="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentGbSettingsFiles}"
                                      Style="{StaticResource GbBaseStyle}"
                                      Tag="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTtGbSettingsFilesInfo}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="1*" />
                                        <ColumnDefinition SharedSizeGroup="SettingButton"
                                                          Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="1*" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <ItemsControl Name="IcSettingsFiles"
                                                  Grid.ColumnSpan="2"
                                                  ItemsSource="{Binding Source={StaticResource CvsSettingsFiles}}"
                                                  Style="{StaticResource IcSettings}" />
                                    <Button Name="BtnWriteToOtherLocation"
                                            Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnWriteToOtherLocation}"
                                            Grid.Column="1"
                                            Grid.Row="1"
                                            Style="{StaticResource BtnBaseStyle}"
                                            Width="{Binding ElementName=IcSettingsFiles, Path=ItemContainerGenerator.Items}" />
                                </Grid>
                            </GroupBox>
                            <GroupBox Name="GbSettingsScriptOperations"
                                      Grid.Row="1"
                                      Header="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentGbSettingsScriptOperations}"
                                      Style="{StaticResource GbBaseStyle}"
                                      Tag="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTtGbSettingsScriptOperationsInfo}">
                                <ItemsControl Name="IcSettingsScriptOperations"
                                              ItemsSource="{Binding Source={StaticResource CvsSettingsOperations}}"
                                              Style="{StaticResource IcSettings}" />
                            </GroupBox>
                            <GroupBox Name="GbSettingsScriptSettings"
                                      Grid.Row="2"
                                      Header="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentGbSettingsScriptSettings}"
                                      Style="{StaticResource GbBaseStyle}"
                                      Tag="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTtGbSettingsScriptSettingsInfo}">
                                <ItemsControl Name="IcSettingsScriptSettings"
                                              ItemsSource="{Binding Source={StaticResource CvsSettingsSettings}}"
                                              Style="{StaticResource IcSettings}" />
                            </GroupBox>
                        </Grid>
                    </ScrollViewer>
                    <Grid Grid.Row="1">
                        <ItemsControl Name="IcSettingsInfo"
                                      ItemsSource="{Binding Source={StaticResource CvsSettingsMessageQueue}}"
                                      Style="{StaticResource IcMessages}" />
                    </Grid>
                </Grid>
            </TabItem>
        </TabControl>
        <Grid Grid.Row="3">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="1*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <ScrollViewer HorizontalScrollBarVisibility="Disabled"
                          Margin="0,5"
                          MaxHeight="65"
                          VerticalScrollBarVisibility="Auto">
                <ItemsControl Name="IcFileInfo"
                              ItemsSource="{Binding Source={StaticResource CvsFileInfoMessageQueue}}"
                              Margin="0"
                              Style="{StaticResource IcMessages}" />
            </ScrollViewer>
            <StackPanel Grid.Column="1"
                        HorizontalAlignment="Right"
                        Orientation="Horizontal">
                <Button Name="BtnSave"
                        Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnSave}"
                        ToolTip="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentTtBtnSave}">
                    <Button.Style>
                        <Style TargetType="Button"
                               BasedOn="{StaticResource BtnFileStyle}">
                            <Setter Property="Visibility"
                                    Value="Visible" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding ElementName=TcMain, Path=SelectedItem.Name}"
                                             Value="TiToExtract">
                                    <Setter Property="Visibility"
                                            Value="Collapsed" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>
                <StackPanel Orientation="Horizontal"
                            HorizontalAlignment="Left">
                    <StackPanel.Style>
                        <Style TargetType="StackPanel">
                            <Setter Property="Visibility"
                                    Value="Collapsed" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding ElementName=TcMain, Path=SelectedItem.Name}"
                                             Value="TiToExtract">
                                    <Setter Property="Visibility"
                                            Value="Visible" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </StackPanel.Style>
                    <Button Name="BtnExtractToScript"
                            Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnExtractToScript}"
                            Style="{StaticResource BtnFileStyle}" />
                    <Button Name="BtnExtractToBackup"
                            Content="{Binding ElementName=Window, Path=DataContext.MsgTable.ContentBtnExtractToBackup}"
                            Style="{StaticResource BtnFileStyle}" />
                </StackPanel>
            </StackPanel>
        </Grid>
    </Grid>
</Page>
